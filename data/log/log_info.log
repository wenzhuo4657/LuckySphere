25-06-11.17:08:19.646 [main            ] INFO  WelcomeLogoApplicationListener -  [DUBBO] 

 :: Dubbo (v3.2.5) : https://github.com/apache/dubbo
 :: Discuss group : dev@dubbo.apache.org
, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:19.728 [main            ] INFO  Application            - Starting Application using Java 1.8.0_141 on wenzhuo4657 with PID 43000 (C:\working\云code\code\big-market\big-market-app\target\classes started by 25370 in C:\working\云code\code\big-market)
25-06-11.17:08:19.729 [main            ] INFO  Application            - The following 1 profile is active: "dev"
25-06-11.17:08:19.732 [background-preinit] INFO  Version                - HV000001: Hibernate Validator 6.2.5.Final
25-06-11.17:08:21.509 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-06-11.17:08:21.510 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Elasticsearch repositories in DEFAULT mode.
25-06-11.17:08:21.609 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 94 ms. Found 4 Elasticsearch repository interfaces.
25-06-11.17:08:21.619 [main            ] INFO  FrameworkModel         -  [DUBBO] Dubbo Framework[1] is created, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:21.635 [main            ] INFO  GlobalResourcesRepository -  [DUBBO] Creating global shared handler ..., dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:21.756 [main            ] INFO  ApplicationModel       -  [DUBBO] Dubbo Application[1.0](unknown) is created, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:21.756 [main            ] INFO  ScopeModel             -  [DUBBO] Dubbo Module[1.0.0] is created, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:21.794 [main            ] INFO  AbstractConfigManager  -  [DUBBO] Config settings: {dubbo.config.mode=STRICT, dubbo.config.ignore-duplicated-interface=false}, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:21.795 [main            ] INFO  AbstractConfigManager  -  [DUBBO] Config settings: {dubbo.config.mode=STRICT, dubbo.config.ignore-duplicated-interface=false}, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:21.810 [main            ] INFO  SerializeSecurityManager -  [DUBBO] Serialize check serializable: true, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:21.811 [main            ] INFO  SerializeSecurityConfigurator -  [DUBBO] Read serialize allow list from jar:file:/C:/working/software/apache-maven-3.9.9-bin/maven-localRepository/org/apache/dubbo/dubbo/3.2.5/dubbo-3.2.5.jar!/security/serialize.allowlist, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:21.826 [main            ] INFO  SerializeSecurityConfigurator -  [DUBBO] Read serialize blocked list from jar:file:/C:/working/software/apache-maven-3.9.9-bin/maven-localRepository/org/apache/dubbo/dubbo/3.2.5/dubbo-3.2.5.jar!/security/serialize.blockedlist, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:21.959 [main            ] INFO  ApplicationModel       -  [DUBBO] Dubbo Application[1.1](unknown) is created, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:21.959 [main            ] INFO  ScopeModel             -  [DUBBO] Dubbo Module[1.1.0] is created, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:21.970 [main            ] INFO  AbstractConfigManager  -  [DUBBO] Config settings: {dubbo.config.mode=STRICT, dubbo.config.ignore-duplicated-interface=false}, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:21.970 [main            ] INFO  AbstractConfigManager  -  [DUBBO] Config settings: {dubbo.config.mode=STRICT, dubbo.config.ignore-duplicated-interface=false}, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:21.975 [main            ] INFO  SerializeSecurityConfigurator -  [DUBBO] Read serialize allow list from jar:file:/C:/working/software/apache-maven-3.9.9-bin/maven-localRepository/org/apache/dubbo/dubbo/3.2.5/dubbo-3.2.5.jar!/security/serialize.allowlist, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:21.976 [main            ] INFO  SerializeSecurityConfigurator -  [DUBBO] Read serialize blocked list from jar:file:/C:/working/software/apache-maven-3.9.9-bin/maven-localRepository/org/apache/dubbo/dubbo/3.2.5/dubbo-3.2.5.jar!/security/serialize.blockedlist, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:21.993 [main            ] INFO  DubboSpringInitializer -  [DUBBO] Use default application: Dubbo Application[1.1](unknown), dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:21.993 [main            ] INFO  ScopeModel             -  [DUBBO] Dubbo Module[1.1.1] is created, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:21.999 [main            ] INFO  AbstractConfigManager  -  [DUBBO] Config settings: {dubbo.config.mode=STRICT, dubbo.config.ignore-duplicated-interface=false}, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:22.003 [main            ] INFO  SerializeSecurityConfigurator -  [DUBBO] Read serialize allow list from jar:file:/C:/working/software/apache-maven-3.9.9-bin/maven-localRepository/org/apache/dubbo/dubbo/3.2.5/dubbo-3.2.5.jar!/security/serialize.allowlist, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:22.003 [main            ] INFO  SerializeSecurityConfigurator -  [DUBBO] Read serialize blocked list from jar:file:/C:/working/software/apache-maven-3.9.9-bin/maven-localRepository/org/apache/dubbo/dubbo/3.2.5/dubbo-3.2.5.jar!/security/serialize.blockedlist, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:22.005 [main            ] INFO  DubboSpringInitializer -  [DUBBO] Use default module model of target application: Dubbo Module[1.1.1], dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:22.007 [main            ] INFO  DubboSpringInitializer -  [DUBBO] Bind Dubbo Module[1.1.1] to spring container: org.springframework.beans.factory.support.DefaultListableBeanFactory@719bb3b4, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:22.560 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-06-11.17:08:22.562 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Reactive Elasticsearch repositories in DEFAULT mode.
25-06-11.17:08:22.630 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 67 ms. Found 0 Reactive Elasticsearch repository interfaces.
25-06-11.17:08:22.644 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-06-11.17:08:22.646 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-06-11.17:08:22.689 [main            ] INFO  RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface cn.wenzhuo4657.BigMarket.querys.repository.IRaffleActivityOrderRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
25-06-11.17:08:22.689 [main            ] INFO  RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface cn.wenzhuo4657.BigMarket.querys.repository.IUserAwardRecordRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
25-06-11.17:08:22.689 [main            ] INFO  RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface cn.wenzhuo4657.BigMarket.querys.repository.IUserBehaviorRebateOrderRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
25-06-11.17:08:22.689 [main            ] INFO  RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface cn.wenzhuo4657.BigMarket.querys.repository.IUserRaffleOrderRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
25-06-11.17:08:22.690 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 31 ms. Found 0 Redis repository interfaces.
25-06-11.17:08:22.934 [main            ] INFO  ServiceAnnotationPostProcessor -  [DUBBO] BeanNameGenerator bean can't be found in BeanFactory with name [org.springframework.context.annotation.internalConfigurationBeanNameGenerator], dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:22.935 [main            ] INFO  ServiceAnnotationPostProcessor -  [DUBBO] BeanNameGenerator will be a instance of org.springframework.context.annotation.AnnotationBeanNameGenerator , it maybe a potential problem on bean name generation., dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:22.962 [main            ] INFO  ServiceAnnotationPostProcessor -  [DUBBO] Found 2 classes annotated by Dubbo @Service under package [cn.wenzhuo4657.BigMarket]: [cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController, cn.wenzhuo4657.BigMarket.trigger.http.RaffleStrategyController], dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:22.976 [main            ] INFO  ServiceAnnotationPostProcessor -  [DUBBO] Register ServiceBean[ServiceBean:cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService:1.0:]: Root bean: class [org.apache.dubbo.config.spring.ServiceBean]; scope=; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=null; initMethodName=null; destroyMethodName=null, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:22.976 [main            ] INFO  ServiceAnnotationPostProcessor -  [DUBBO] Register ServiceBean[ServiceBean:cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService:1.0:]: Root bean: class [org.apache.dubbo.config.spring.ServiceBean]; scope=; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=null; initMethodName=null; destroyMethodName=null, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:22.978 [main            ] INFO  ServiceAnnotationPostProcessor -  [DUBBO] BeanNameGenerator bean can't be found in BeanFactory with name [org.springframework.context.annotation.internalConfigurationBeanNameGenerator], dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:22.978 [main            ] INFO  ServiceAnnotationPostProcessor -  [DUBBO] BeanNameGenerator will be a instance of org.springframework.context.annotation.AnnotationBeanNameGenerator , it maybe a potential problem on bean name generation., dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:22.978 [main            ] WARN  ServiceAnnotationPostProcessor -  [DUBBO] No class annotated by Dubbo @Service was found under package [cn.wenzhuo4657.trigger.api], ignore re-scanned classes: 0, dubbo version: 3.2.5, current host: 192.168.43.185, error code: 5-28. This may be caused by No annotations were found on the class, go to https://dubbo.apache.org/faq/5/28 to find instructions. 
25-06-11.17:08:23.005 [main            ] INFO  ConfigurationClassPostProcessor - Cannot enhance @Configuration bean definition 'org.apache.dubbo.spring.boot.autoconfigure.DubboRelaxedBinding2AutoConfiguration' since its singleton instance has been created too early. The typical cause is a non-static @Bean method with a BeanDefinitionRegistryPostProcessor return type: Consider declaring such methods as 'static'.
25-06-11.17:08:23.005 [main            ] INFO  ConfigurationClassPostProcessor - Cannot enhance @Configuration bean definition 'org.apache.dubbo.spring.boot.autoconfigure.DubboAutoConfiguration' since its singleton instance has been created too early. The typical cause is a non-static @Bean method with a BeanDefinitionRegistryPostProcessor return type: Consider declaring such methods as 'static'.
25-06-11.17:08:23.096 [main            ] INFO  GenericScope           - BeanFactory id=57601fd7-4292-31af-8175-9dba5a822234
25-06-11.17:08:24.070 [main            ] INFO  ReferenceAnnotationBeanPostProcessor -  [DUBBO] class org.apache.dubbo.config.spring.beans.factory.annotation.ReferenceAnnotationBeanPostProcessor was destroying!, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:24.155 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration' of type [org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
25-06-11.17:08:24.156 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
25-06-11.17:08:24.157 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'loadBalancerClientsDefaultsMappingsProvider' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration$$Lambda$702/389872385] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
25-06-11.17:08:24.157 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'defaultsBindHandlerAdvisor' of type [org.springframework.cloud.commons.config.DefaultsBindHandlerAdvisor] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
25-06-11.17:08:24.161 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
25-06-11.17:08:24.169 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
25-06-11.17:08:24.632 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$d591078d] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
25-06-11.17:08:24.831 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'zooKeeperClientConfig' of type [cn.wenzhuo4657.BigMarket.config.ZooKeeperClientConfig$$EnhancerBySpringCGLIB$$8e4fa6bd] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
25-06-11.17:08:24.838 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'zookeeper.sdk.config-cn.wenzhuo4657.BigMarket.config.ZookeeperClientConfigProperties' of type [cn.wenzhuo4657.BigMarket.config.ZookeeperClientConfigProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
25-06-11.17:08:24.901 [main            ] INFO  CuratorFrameworkImpl   - Starting
25-06-11.17:08:24.910 [main            ] INFO  ZooKeeper              - Client environment:zookeeper.version=3.6.0--b4c89dc7f6083829e18fae6e446907ae0b1f22d7, built on 02/25/2020 14:38 GMT
25-06-11.17:08:24.910 [main            ] INFO  ZooKeeper              - Client environment:host.name=wenzhuo4657
25-06-11.17:08:24.910 [main            ] INFO  ZooKeeper              - Client environment:java.version=1.8.0_141
25-06-11.17:08:24.910 [main            ] INFO  ZooKeeper              - Client environment:java.vendor=Oracle Corporation
25-06-11.17:08:24.911 [main            ] INFO  ZooKeeper              - Client environment:java.home=C:\Program Files\Java\jdk1.8.0_141\jre
25-06-11.17:08:24.911 [main            ] INFO  ZooKeeper              - Client environment:java.class.path=C:\Users\25370\AppData\Local\Temp\classpath1424915366.jar;C:\Users\25370\AppData\Local\JetBrains\IntelliJIdea2023.3\captureAgent\debugger-agent.jar
25-06-11.17:08:24.911 [main            ] INFO  ZooKeeper              - Client environment:java.library.path=C:\Program Files\Java\jdk1.8.0_141\bin;C:\WINDOWS\Sun\Java\bin;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\WINDOWS\System32\WindowsPowerShell\v1.0\;C:\WINDOWS\System32\OpenSSH\;C:\Program Files\dotnet\;C:\working\software\Git\cmd;c:\working\software\cursor\resources\app\bin;C:\working\software\Gpg4win\..\GnuPG\bin;C:\Users\25370\.jdks\ms-17.0.15\bin;C:\working\software\nvm;C:\Program Files\nodejs;C:\Users\25370\Desktop\hugo-blog;C:\Users\25370\AppData\Local\Microsoft\WindowsApps;C:\working\software\idea\IntelliJ IDEA 2023.3.8\bin;;C:\working\software\cursor\resources\app\bin;C:\working\software\apache-maven-3.9.9-bin\apache-maven-3.9.9\bin;C:\working\software\nvm;C:\Program Files\nodejs;.
25-06-11.17:08:24.911 [main            ] INFO  ZooKeeper              - Client environment:java.io.tmpdir=C:\Users\25370\AppData\Local\Temp\
25-06-11.17:08:24.911 [main            ] INFO  ZooKeeper              - Client environment:java.compiler=<NA>
25-06-11.17:08:24.911 [main            ] INFO  ZooKeeper              - Client environment:os.name=Windows 10
25-06-11.17:08:24.911 [main            ] INFO  ZooKeeper              - Client environment:os.arch=amd64
25-06-11.17:08:24.911 [main            ] INFO  ZooKeeper              - Client environment:os.version=10.0
25-06-11.17:08:24.911 [main            ] INFO  ZooKeeper              - Client environment:user.name=25370
25-06-11.17:08:24.911 [main            ] INFO  ZooKeeper              - Client environment:user.home=C:\Users\25370
25-06-11.17:08:24.911 [main            ] INFO  ZooKeeper              - Client environment:user.dir=C:\working\云code\code\big-market
25-06-11.17:08:24.911 [main            ] INFO  ZooKeeper              - Client environment:os.memory.free=332MB
25-06-11.17:08:24.911 [main            ] INFO  ZooKeeper              - Client environment:os.memory.max=3609MB
25-06-11.17:08:24.911 [main            ] INFO  ZooKeeper              - Client environment:os.memory.total=441MB
25-06-11.17:08:24.915 [main            ] INFO  ZooKeeper              - Initiating client connection, connectString=117.72.36.124:2181 sessionTimeout=30000 watcher=org.apache.curator.ConnectionState@7698a3d9
25-06-11.17:08:24.918 [main            ] INFO  X509Util               - Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation
25-06-11.17:08:24.932 [main            ] INFO  ClientCnxnSocket       - jute.maxbuffer value is 1048575 Bytes
25-06-11.17:08:24.939 [main            ] INFO  ClientCnxn             - zookeeper.request.timeout value is 0. feature enabled=false
25-06-11.17:08:24.949 [main            ] INFO  CuratorFrameworkImpl   - Default schema
25-06-11.17:08:24.953 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'zookeeperClient' of type [org.apache.curator.framework.imps.CuratorFrameworkImpl] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
25-06-11.17:08:38.695 [main-SendThread(117.72.36.124:2181)] INFO  ClientCnxn             - Opening socket connection to server 117.72.36.124/117.72.36.124:2181.
25-06-11.17:08:38.695 [main-SendThread(117.72.36.124:2181)] INFO  ClientCnxn             - SASL config status: Will not attempt to authenticate using SASL (unknown error)
25-06-11.17:08:38.733 [main-SendThread(117.72.36.124:2181)] INFO  ClientCnxn             - Socket connection established, initiating session, client: /192.168.43.185:56567, server: 117.72.36.124/117.72.36.124:2181
25-06-11.17:08:38.817 [main-SendThread(117.72.36.124:2181)] INFO  ClientCnxn             - Session establishment complete on server 117.72.36.124/117.72.36.124:2181, session id = 0x10000004c34000c, negotiated timeout = 30000
25-06-11.17:08:38.825 [main-EventThread] INFO  ConnectionStateManager - State change: CONNECTED
25-06-11.17:08:39.024 [main            ] INFO  Compatibility          - Using org.apache.zookeeper.server.quorum.MultipleAddresses
25-06-11.17:08:39.026 [main-EventThread] INFO  EnsembleTracker        - New config event received: {}
25-06-11.17:08:39.026 [main-EventThread] INFO  EnsembleTracker        - New config event received: {}
25-06-11.17:08:39.136 [Curator-SafeNotifyService-0] INFO  DCCValueBeanFactory    - DCC监听生效，/big-market-dcc/config节点发生变化，
25-06-11.17:08:39.214 [Curator-SafeNotifyService-0] INFO  DCCValueBeanFactory    - DCC监听生效，/big-market-dcc/config/rateLimiterSwitch节点发生变化，
25-06-11.17:08:39.214 [Curator-SafeNotifyService-0] INFO  DCCValueBeanFactory    - DCC监听生效，/big-market-dcc/config/degradeSwitch节点发生变化，
25-06-11.17:08:39.320 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
25-06-11.17:08:39.436 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
25-06-11.17:08:39.448 [main            ] INFO  StandardService        - Starting service [Tomcat]
25-06-11.17:08:39.450 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
25-06-11.17:08:39.596 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
25-06-11.17:08:39.596 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 19607 ms
25-06-11.17:08:40.165 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-06-11.17:08:41.260 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-06-11.17:08:41.269 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
25-06-11.17:08:41.705 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
25-06-11.17:08:41.705 [main            ] INFO  HikariDataSource       - HikariPool-3 - Starting...
25-06-11.17:08:42.093 [main            ] INFO  HikariDataSource       - HikariPool-3 - Start completed.
25-06-11.17:08:44.220 [main            ] INFO  DubboConfigBeanInitializer -  [DUBBO] loading dubbo config beans ..., dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:44.223 [main            ] INFO  DubboConfigBeanInitializer -  [DUBBO] dubbo config beans are loaded., dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:44.279 [main            ] INFO  DefaultApplicationDeployer -  [DUBBO] No value is configured in the registry, the DynamicConfigurationFactory extension[name : nacos] supports as the config center, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:44.279 [main            ] INFO  DefaultApplicationDeployer -  [DUBBO] The registry[<dubbo:registry id="nacos-registry" address="nacos://117.72.36.124:8848" protocol="nacos" port="8848" />] will be used as the config center, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:44.285 [main            ] INFO  DefaultApplicationDeployer -  [DUBBO] use registry as config-center: <dubbo:config-center highestPriority="false" id="config-center-nacos-117.72.36.124-8848" address="nacos://117.72.36.124:8848" protocol="nacos" port="8848" parameters="{client=null}" />, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:44.359 [main            ] INFO  ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
25-06-11.17:08:44.359 [main            ] INFO  ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
25-06-11.17:08:46.959 [main            ] INFO  ConfigurationUtils     -  [DUBBO] Config center was specified, but no config item found., dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:46.959 [main            ] INFO  ConfigurationUtils     -  [DUBBO] Config center was specified, but no config item found., dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:46.986 [main            ] INFO  ConfigManager          -  [DUBBO] The current configurations or effective configurations are as follows:, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:46.987 [main            ] INFO  ConfigManager          -  [DUBBO] <dubbo:application enableFileCache="true" executorManagementMode="isolation" version="1.0" parameters="{}" name="big-market" qosEnable="true" protocol="dubbo" />, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:46.987 [main            ] INFO  ConfigManager          -  [DUBBO] <dubbo:protocol preferSerialization="fastjson2,hessian2" port="-1" name="dubbo" />, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:46.987 [main            ] INFO  ConfigManager          -  [DUBBO] <dubbo:registry id="nacos-registry" address="nacos://117.72.36.124:8848" protocol="nacos" port="8848" />, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:46.987 [main            ] INFO  ConfigManager          -  [DUBBO] <dubbo:ssl />, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:47.008 [main            ] INFO  DefaultModuleDeployer  -  [DUBBO] Dubbo Module[1.1.0] has been initialized!, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:47.010 [main            ] INFO  DefaultModuleDeployer  -  [DUBBO] Dubbo Module[1.1.1] has been initialized!, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:47.134 [main            ] INFO  DefaultApplicationDeployer -  [DUBBO] No value is configured in the registry, the MetadataReportFactory extension[name : nacos] supports as the metadata center, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:47.134 [main            ] INFO  DefaultApplicationDeployer -  [DUBBO] The registry[<dubbo:registry id="nacos-registry" address="nacos://117.72.36.124:8848" protocol="nacos" port="8848" />] will be used as the metadata center, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:47.137 [main            ] INFO  DefaultApplicationDeployer -  [DUBBO] use registry as metadata-center: <dubbo:metadata-report id="nacos-registry" address="nacos://117.72.36.124:8848" protocol="nacos" port="8848" parameters="{client=null}" />, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:47.157 [main            ] INFO  ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
25-06-11.17:08:47.157 [main            ] INFO  ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
25-06-11.17:08:47.438 [main            ] INFO  DefaultApplicationDeployer -  [DUBBO] Dubbo Application[1.1](big-market) has been initialized!, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:08:47.514 [main            ] INFO  DCCValueBeanFactory    - DCC 节点监听 设置配置 /big-market-dcc/config/rateLimiterSwitch rateLimiterSwitch close
25-06-11.17:08:48.423 [I/O dispatcher 1] WARN  RestClient             - request [GET http://154.64.245.158:9200/] returned 1 warnings: [299 Elasticsearch-7.17.14-774e3bfa4d52e2834e4d9d8d669d77e4e5c1017f "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
25-06-11.17:08:48.544 [main            ] WARN  RestClient             - request [HEAD http://154.64.245.158:9200/big_market.user_behavior_rebate_order] returned 1 warnings: [299 Elasticsearch-7.17.14-774e3bfa4d52e2834e4d9d8d669d77e4e5c1017f "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
25-06-11.17:08:49.132 [main            ] WARN  RestClient             - request [PUT http://154.64.245.158:9200/big_market.user_behavior_rebate_order?master_timeout=30s&timeout=30s] returned 1 warnings: [299 Elasticsearch-7.17.14-774e3bfa4d52e2834e4d9d8d669d77e4e5c1017f "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
25-06-11.17:08:49.297 [main            ] WARN  RestClient             - request [HEAD http://154.64.245.158:9200/big_market.raffle_activity_order] returned 1 warnings: [299 Elasticsearch-7.17.14-774e3bfa4d52e2834e4d9d8d669d77e4e5c1017f "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
25-06-11.17:08:49.615 [main            ] WARN  RestClient             - request [PUT http://154.64.245.158:9200/big_market.raffle_activity_order?master_timeout=30s&timeout=30s] returned 1 warnings: [299 Elasticsearch-7.17.14-774e3bfa4d52e2834e4d9d8d669d77e4e5c1017f "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
25-06-11.17:08:49.737 [main            ] WARN  RestClient             - request [HEAD http://154.64.245.158:9200/big_market.user_award_record] returned 1 warnings: [299 Elasticsearch-7.17.14-774e3bfa4d52e2834e4d9d8d669d77e4e5c1017f "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
25-06-11.17:08:50.098 [main            ] WARN  RestClient             - request [PUT http://154.64.245.158:9200/big_market.user_award_record?master_timeout=30s&timeout=30s] returned 1 warnings: [299 Elasticsearch-7.17.14-774e3bfa4d52e2834e4d9d8d669d77e4e5c1017f "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
25-06-11.17:08:50.197 [main            ] WARN  RestClient             - request [HEAD http://154.64.245.158:9200/big_market.user_raffle_order] returned 1 warnings: [299 Elasticsearch-7.17.14-774e3bfa4d52e2834e4d9d8d669d77e4e5c1017f "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
25-06-11.17:08:50.511 [main            ] WARN  RestClient             - request [PUT http://154.64.245.158:9200/big_market.user_raffle_order?master_timeout=30s&timeout=30s] returned 1 warnings: [299 Elasticsearch-7.17.14-774e3bfa4d52e2834e4d9d8d669d77e4e5c1017f "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
25-06-11.17:08:50.838 [main            ] INFO  Version                - Redisson 3.23.4
25-06-11.17:08:51.595 [redisson-netty-2-6] INFO  MasterPubSubConnectionPool - 1 connections initialized for 117.72.36.124/117.72.36.124:6379
25-06-11.17:08:52.274 [redisson-netty-2-23] INFO  MasterConnectionPool   - 10 connections initialized for 117.72.36.124/117.72.36.124:6379
25-06-11.17:08:55.835 [main            ] INFO  DCCValueBeanFactory    - DCC 节点监听 设置配置 /big-market-dcc/config/degradeSwitch degradeSwitch close
25-06-11.17:08:55.846 [main            ] INFO  ThreadPoolConfig       - CPU核数12,手动配置：20，最终选择：6
25-06-11.17:08:55.857 [main            ] INFO  XxlJobAutoConfig       - >>>>>>>>>>> xxl-job config init.
25-06-11.17:08:57.269 [main            ] INFO  StdSchedulerFactory    - Using default implementation for ThreadExecutor
25-06-11.17:08:57.281 [main            ] INFO  SchedulerSignalerImpl  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
25-06-11.17:08:57.281 [main            ] INFO  QuartzScheduler        - Quartz Scheduler v.2.3.2 created.
25-06-11.17:08:57.281 [main            ] INFO  RAMJobStore            - RAMJobStore initialized.
25-06-11.17:08:57.281 [main            ] INFO  QuartzScheduler        - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

25-06-11.17:08:57.281 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
25-06-11.17:08:57.281 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler version: 2.3.2
25-06-11.17:08:57.281 [main            ] INFO  QuartzScheduler        - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@2cf1c10e
25-06-11.17:08:58.853 [main            ] WARN  LoadBalancerCacheAutoConfiguration$LoadBalancerCaffeineWarnLogger - Spring Cloud LoadBalancer is currently working with the default cache. While this cache implementation is useful for development and tests, it's recommended to use Caffeine cache in production.You can switch to using Caffeine cache, by adding it and org.springframework.cache.caffeine.CaffeineCacheManager to the classpath.
25-06-11.17:08:58.857 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-06-11.17:08:58.983 [main            ] INFO  XxlJobExecutor         - >>>>>>>>>>> xxl-job register jobhandler success, name:SendMessageTaskJob_DB1, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@2a5129f3[class cn.wenzhuo4657.BigMarket.trigger.job.SendMessageTaskJob#exec_db01]
25-06-11.17:08:58.983 [main            ] INFO  XxlJobExecutor         - >>>>>>>>>>> xxl-job register jobhandler success, name:UpdateActivitySkuStockJob, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@7d72f5a9[class cn.wenzhuo4657.BigMarket.trigger.job.UpdateActivitySkuStockJob#exec]
25-06-11.17:08:58.983 [main            ] INFO  XxlJobExecutor         - >>>>>>>>>>> xxl-job register jobhandler success, name:updateAwardStockJob, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@127b9bed[class cn.wenzhuo4657.BigMarket.trigger.job.UpdateAwardStockJob#exec]
25-06-11.17:08:59.055 [Thread-110      ] INFO  EmbedServer            - >>>>>>>>>>> xxl-job remoting server start success, nettype = class com.xxl.job.core.server.EmbedServer, port = 9999
25-06-11.17:09:00.308 [main            ] INFO  DefaultRocketMQListenerContainer - running container: DefaultRocketMQListenerContainer{consumerGroup='big-market-app-Customer-send_award', namespace='', nameServer='117.72.36.124:9876', topic='send_award', consumeMode=CONCURRENTLY, selectorType=TAG, selectorExpression='*', messageModel=CLUSTERING', tlsEnable=false}
25-06-11.17:09:00.308 [main            ] INFO  ListenerContainerConfiguration - Register the listener to container, listenerBeanName:sendAwardCustomer, containerBeanName:org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer_1
25-06-11.17:09:01.526 [main            ] INFO  DefaultRocketMQListenerContainer - running container: DefaultRocketMQListenerContainer{consumerGroup='big-market-app-Customer-credit_adjust_success', namespace='', nameServer='117.72.36.124:9876', topic='credit_adjust_success', consumeMode=CONCURRENTLY, selectorType=TAG, selectorExpression='*', messageModel=CLUSTERING', tlsEnable=false}
25-06-11.17:09:01.526 [main            ] INFO  ListenerContainerConfiguration - Register the listener to container, listenerBeanName:creditAdjustSuccessCustomer, containerBeanName:org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer_2
25-06-11.17:09:02.747 [main            ] INFO  DefaultRocketMQListenerContainer - running container: DefaultRocketMQListenerContainer{consumerGroup='big-market-app-Customer-send_rebate', namespace='', nameServer='117.72.36.124:9876', topic='send_rebate', consumeMode=CONCURRENTLY, selectorType=TAG, selectorExpression='*', messageModel=CLUSTERING', tlsEnable=false}
25-06-11.17:09:02.748 [main            ] INFO  ListenerContainerConfiguration - Register the listener to container, listenerBeanName:rebateMessageCustomer, containerBeanName:org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer_3
25-06-11.17:09:03.930 [main            ] INFO  DefaultRocketMQListenerContainer - running container: DefaultRocketMQListenerContainer{consumerGroup='big-market-app-Customer-activity_sku_stock_zero', namespace='', nameServer='117.72.36.124:9876', topic='activity_sku_stock_zero', consumeMode=CONCURRENTLY, selectorType=TAG, selectorExpression='*', messageModel=CLUSTERING', tlsEnable=false}
25-06-11.17:09:03.931 [main            ] INFO  ListenerContainerConfiguration - Register the listener to container, listenerBeanName:activitySkuStockZeroCustomer, containerBeanName:org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer_4
25-06-11.17:09:04.002 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
25-06-11.17:09:04.021 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
25-06-11.17:09:05.367 [main            ] INFO  SchedulerFactoryBean   - Starting Quartz Scheduler now
25-06-11.17:09:05.367 [main            ] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED started.
25-06-11.17:09:05.369 [main            ] INFO  DefaultModuleDeployer  -  [DUBBO] Dubbo Module[1.1.1] is starting., dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:05.370 [main            ] INFO  DefaultApplicationDeployer -  [DUBBO] Dubbo Application[1.1](big-market) is starting., dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:06.400 [main            ] WARN  ServiceConfig          -  [DUBBO] Use random available port(20880) for protocol dubbo, dubbo version: 3.2.5, current host: 192.168.43.185, error code: 5-8. This may be caused by , go to https://dubbo.apache.org/faq/5/8 to find instructions. 
25-06-11.17:09:06.527 [main            ] INFO  Server                 -  [DUBBO] qos-server bind localhost:22222, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:06.529 [main            ] INFO  ServiceConfig          -  [DUBBO] Export dubbo service cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService to local registry url : injvm://127.0.0.1/cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService?anyhost=true&application=big-market&application.version=1.0&background=false&bind.ip=192.168.43.185&bind.port=20880&deprecated=false&dubbo=2.0.2&dynamic=true&executor-management-mode=isolation&exporter.listener=injvm&file-cache=true&generic=false&interface=cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService&ipv6=240e:404:2600:f356:cb2f:108d:e436:5c98&methods=queryRaffleAwardList,queryRaffleAwardListByToken,queryRaffleStrategyRuleWeight,randomRaffle,strategyArmory&pid=43000&prefer.serialization=fastjson2,hessian2&qos.enable=true&release=3.2.5&revision=1.0&side=provider&timestamp=1749632945452&version=1.0, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:06.530 [main            ] INFO  ServiceConfig          -  [DUBBO] Register dubbo service cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService url dubbo://192.168.43.185:20880/cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService?anyhost=true&application=big-market&application.version=1.0&background=false&bind.ip=192.168.43.185&bind.port=20880&deprecated=false&dubbo=2.0.2&dynamic=true&executor-management-mode=isolation&file-cache=true&generic=false&interface=cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService&ipv6=240e:404:2600:f356:cb2f:108d:e436:5c98&methods=queryRaffleAwardList,queryRaffleAwardListByToken,queryRaffleStrategyRuleWeight,randomRaffle,strategyArmory&pid=43000&prefer.serialization=fastjson2,hessian2&qos.enable=true&release=3.2.5&revision=1.0&service-name-mapping=true&side=provider&timestamp=1749632945452&version=1.0 to registry 117.72.36.124:8848, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:06.731 [main            ] INFO  AbstractServer         -  [DUBBO] Start NettyServer bind /0.0.0.0:20880, export /192.168.43.185:20880, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:06.790 [main            ] INFO  MetaCacheManager       -  [DUBBO] Successfully loaded meta cache from file .metadata.big-market.nacos.117.72.36.124:8848, entries 0, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:06.808 [main            ] INFO  ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
25-06-11.17:09:06.808 [main            ] INFO  ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
25-06-11.17:09:07.159 [main            ] INFO  NacosNamingServiceWrapper -  [DUBBO] Nacos batch register enable: false, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:07.173 [main            ] INFO  MappingCacheManager    -  [DUBBO] Successfully loaded mapping cache from file .mapping.big-market, entries 0, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:07.192 [main            ] INFO  MigrationRuleListener  -  [DUBBO] Listening for migration rules on dataId big-market.migration, group DUBBO_SERVICEDISCOVERY_MIGRATION, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:07.240 [main            ] INFO  ServiceConfig          -  [DUBBO] Register dubbo service cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService url dubbo://192.168.43.185:20880/cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService?anyhost=true&application=big-market&application.version=1.0&background=false&bind.ip=192.168.43.185&bind.port=20880&deprecated=false&dubbo=2.0.2&dynamic=true&executor-management-mode=isolation&file-cache=true&generic=false&interface=cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService&ipv6=240e:404:2600:f356:cb2f:108d:e436:5c98&methods=queryRaffleAwardList,queryRaffleAwardListByToken,queryRaffleStrategyRuleWeight,randomRaffle,strategyArmory&pid=43000&prefer.serialization=fastjson2,hessian2&qos.enable=true&release=3.2.5&revision=1.0&service-name-mapping=true&side=provider&timestamp=1749632945452&version=1.0 to registry 117.72.36.124:8848, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:07.288 [main            ] INFO  ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
25-06-11.17:09:07.288 [main            ] INFO  ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
25-06-11.17:09:07.558 [main            ] INFO  NacosNamingServiceWrapper -  [DUBBO] Nacos batch register enable: false, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:07.559 [main            ] INFO  NacosRegistry          -  [DUBBO] Subscribe: provider://192.168.43.185:20880/cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService?anyhost=true&application=big-market&application.version=1.0&background=false&bind.ip=192.168.43.185&bind.port=20880&category=configurators&check=false&deprecated=false&dubbo=2.0.2&dynamic=true&executor-management-mode=isolation&file-cache=true&generic=false&interface=cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService&ipv6=240e:404:2600:f356:cb2f:108d:e436:5c98&methods=queryRaffleAwardList,queryRaffleAwardListByToken,queryRaffleStrategyRuleWeight,randomRaffle,strategyArmory&pid=43000&prefer.serialization=fastjson2,hessian2&qos.enable=true&release=3.2.5&revision=1.0&service-name-mapping=true&side=provider&timestamp=1749632945452&version=1.0, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:07.652 [main            ] WARN  NacosRegistry          -  [DUBBO] Received empty url address list and empty protection is disabled, will clear current available addresses, dubbo version: 3.2.5, current host: 192.168.43.185, error code: 1-37. This may be caused by , go to https://dubbo.apache.org/faq/1/37 to find instructions. 
25-06-11.17:09:07.653 [main            ] INFO  NacosRegistry          -  [DUBBO] Notify urls for subscribe url provider://192.168.43.185:20880/cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService?anyhost=true&application=big-market&application.version=1.0&background=false&bind.ip=192.168.43.185&bind.port=20880&category=configurators&check=false&deprecated=false&dubbo=2.0.2&dynamic=true&executor-management-mode=isolation&file-cache=true&generic=false&interface=cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService&ipv6=240e:404:2600:f356:cb2f:108d:e436:5c98&methods=queryRaffleAwardList,queryRaffleAwardListByToken,queryRaffleStrategyRuleWeight,randomRaffle,strategyArmory&pid=43000&prefer.serialization=fastjson2,hessian2&qos.enable=true&release=3.2.5&revision=1.0&service-name-mapping=true&side=provider&timestamp=1749632945452&version=1.0, url size: 1, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:07.715 [main            ] WARN  NacosRegistry          -  [DUBBO] Received empty url address list and empty protection is disabled, will clear current available addresses, dubbo version: 3.2.5, current host: 192.168.43.185, error code: 1-37. This may be caused by , go to https://dubbo.apache.org/faq/1/37 to find instructions. 
25-06-11.17:09:07.716 [main            ] INFO  NacosRegistry          -  [DUBBO] Notify urls for subscribe url provider://192.168.43.185:20880/cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService?anyhost=true&application=big-market&application.version=1.0&background=false&bind.ip=192.168.43.185&bind.port=20880&category=configurators&check=false&deprecated=false&dubbo=2.0.2&dynamic=true&executor-management-mode=isolation&file-cache=true&generic=false&interface=cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService&ipv6=240e:404:2600:f356:cb2f:108d:e436:5c98&methods=queryRaffleAwardList,queryRaffleAwardListByToken,queryRaffleStrategyRuleWeight,randomRaffle,strategyArmory&pid=43000&prefer.serialization=fastjson2,hessian2&qos.enable=true&release=3.2.5&revision=1.0&service-name-mapping=true&side=provider&timestamp=1749632945452&version=1.0, url size: 1, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:07.751 [main            ] INFO  ServiceConfig          -  [DUBBO] Try to register interface application mapping for service cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService:1.0, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:07.767 [DubboSaveMetadataReport-thread-1] INFO  NacosMetadataReport    -  [DUBBO] store provider metadata. Identifier : org.apache.dubbo.metadata.report.identifier.MetadataIdentifier@5fe912f9; definition: FullServiceDefinition{parameters={side=provider, application=big-market, anyhost=true, version=1.0, pid=43000, dubbo=2.0.2, release=3.2.5, interface=cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService, executor-management-mode=isolation, file-cache=true, application.version=1.0, methods=queryRaffleAwardList,queryRaffleAwardListByToken,queryRaffleStrategyRuleWeight,randomRaffle,strategyArmory, deprecated=false, service-name-mapping=true, qos.enable=true, generic=false, bind.port=20880, revision=1.0, bind.ip=192.168.43.185, prefer.serialization=fastjson2,hessian2, background=false, ipv6=240e:404:2600:f356:cb2f:108d:e436:5c98, dynamic=true, timestamp=1749632945452}} ServiceDefinition [canonicalName=cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService, codeSource=file:/C:/working/云code/code/big-market/big-market-api/target/classes/, methods=[MethodDefinition [name=queryRaffleAwardListByToken, parameterTypes=[java.lang.String, cn.wenzhuo4657.BigMarket.tigger.api.dto.RaffleAwardListRequestDTO], returnType=cn.wenzhuo4657.BigMarket.tigger.api.reponse.Response], MethodDefinition [name=queryRaffleStrategyRuleWeight, parameterTypes=[cn.wenzhuo4657.BigMarket.tigger.api.dto.RaffleStrategyRuleWeightRequestDTO], returnType=cn.wenzhuo4657.BigMarket.tigger.api.reponse.Response], MethodDefinition [name=queryRaffleAwardList, parameterTypes=[cn.wenzhuo4657.BigMarket.tigger.api.dto.RaffleAwardListRequestDTO], returnType=cn.wenzhuo4657.BigMarket.tigger.api.reponse.Response], MethodDefinition [name=strategyArmory, parameterTypes=[java.lang.Long], returnType=cn.wenzhuo4657.BigMarket.tigger.api.reponse.Response], MethodDefinition [name=randomRaffle, parameterTypes=[cn.wenzhuo4657.BigMarket.tigger.api.dto.RaffleStrategyRequestDTO], returnType=cn.wenzhuo4657.BigMarket.tigger.api.reponse.Response]]], dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:07.885 [main            ] INFO  ServiceConfig          -  [DUBBO] Successfully registered interface application mapping for service cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService:1.0, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:07.951 [main            ] INFO  ServiceConfig          -  [DUBBO] Export dubbo service cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService to local registry url : injvm://127.0.0.1/cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService?anyhost=true&application=big-market&application.version=1.0&background=false&bind.ip=192.168.43.185&bind.port=20880&deprecated=false&dubbo=2.0.2&dynamic=true&executor-management-mode=isolation&exporter.listener=injvm&file-cache=true&generic=false&interface=cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService&ipv6=240e:404:2600:f356:cb2f:108d:e436:5c98&methods=armory,calendarSignRebate,calendarSignRebateByToken,creditPayExchangeSku,draw,isCalendarSignRebate,isCalendarSignRebateByToken,querySkuProductListByActivityId,queryUserActivityAccount,queryUserCreditAccount,queryUserCreditAccountByToken&pid=43000&prefer.serialization=fastjson2,hessian2&qos.enable=true&release=3.2.5&revision=1.0&side=provider&timestamp=1749632947916&version=1.0, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:07.952 [main            ] INFO  ServiceConfig          -  [DUBBO] Register dubbo service cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService url dubbo://192.168.43.185:20880/cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService?anyhost=true&application=big-market&application.version=1.0&background=false&bind.ip=192.168.43.185&bind.port=20880&deprecated=false&dubbo=2.0.2&dynamic=true&executor-management-mode=isolation&file-cache=true&generic=false&interface=cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService&ipv6=240e:404:2600:f356:cb2f:108d:e436:5c98&methods=armory,calendarSignRebate,calendarSignRebateByToken,creditPayExchangeSku,draw,isCalendarSignRebate,isCalendarSignRebateByToken,querySkuProductListByActivityId,queryUserActivityAccount,queryUserCreditAccount,queryUserCreditAccountByToken&pid=43000&prefer.serialization=fastjson2,hessian2&qos.enable=true&release=3.2.5&revision=1.0&service-name-mapping=true&side=provider&timestamp=1749632947916&version=1.0 to registry 117.72.36.124:8848, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.003 [main            ] INFO  ServiceConfig          -  [DUBBO] Register dubbo service cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService url dubbo://192.168.43.185:20880/cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService?anyhost=true&application=big-market&application.version=1.0&background=false&bind.ip=192.168.43.185&bind.port=20880&deprecated=false&dubbo=2.0.2&dynamic=true&executor-management-mode=isolation&file-cache=true&generic=false&interface=cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService&ipv6=240e:404:2600:f356:cb2f:108d:e436:5c98&methods=armory,calendarSignRebate,calendarSignRebateByToken,creditPayExchangeSku,draw,isCalendarSignRebate,isCalendarSignRebateByToken,querySkuProductListByActivityId,queryUserActivityAccount,queryUserCreditAccount,queryUserCreditAccountByToken&pid=43000&prefer.serialization=fastjson2,hessian2&qos.enable=true&release=3.2.5&revision=1.0&service-name-mapping=true&side=provider&timestamp=1749632947916&version=1.0 to registry 117.72.36.124:8848, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.197 [main            ] INFO  NacosRegistry          -  [DUBBO] Subscribe: provider://192.168.43.185:20880/cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService?anyhost=true&application=big-market&application.version=1.0&background=false&bind.ip=192.168.43.185&bind.port=20880&category=configurators&check=false&deprecated=false&dubbo=2.0.2&dynamic=true&executor-management-mode=isolation&file-cache=true&generic=false&interface=cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService&ipv6=240e:404:2600:f356:cb2f:108d:e436:5c98&methods=armory,calendarSignRebate,calendarSignRebateByToken,creditPayExchangeSku,draw,isCalendarSignRebate,isCalendarSignRebateByToken,querySkuProductListByActivityId,queryUserActivityAccount,queryUserCreditAccount,queryUserCreditAccountByToken&pid=43000&prefer.serialization=fastjson2,hessian2&qos.enable=true&release=3.2.5&revision=1.0&service-name-mapping=true&side=provider&timestamp=1749632947916&version=1.0, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.238 [main            ] WARN  NacosRegistry          -  [DUBBO] Received empty url address list and empty protection is disabled, will clear current available addresses, dubbo version: 3.2.5, current host: 192.168.43.185, error code: 1-37. This may be caused by , go to https://dubbo.apache.org/faq/1/37 to find instructions. 
25-06-11.17:09:08.238 [main            ] INFO  NacosRegistry          -  [DUBBO] Notify urls for subscribe url provider://192.168.43.185:20880/cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService?anyhost=true&application=big-market&application.version=1.0&background=false&bind.ip=192.168.43.185&bind.port=20880&category=configurators&check=false&deprecated=false&dubbo=2.0.2&dynamic=true&executor-management-mode=isolation&file-cache=true&generic=false&interface=cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService&ipv6=240e:404:2600:f356:cb2f:108d:e436:5c98&methods=armory,calendarSignRebate,calendarSignRebateByToken,creditPayExchangeSku,draw,isCalendarSignRebate,isCalendarSignRebateByToken,querySkuProductListByActivityId,queryUserActivityAccount,queryUserCreditAccount,queryUserCreditAccountByToken&pid=43000&prefer.serialization=fastjson2,hessian2&qos.enable=true&release=3.2.5&revision=1.0&service-name-mapping=true&side=provider&timestamp=1749632947916&version=1.0, url size: 1, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.285 [main            ] WARN  NacosRegistry          -  [DUBBO] Received empty url address list and empty protection is disabled, will clear current available addresses, dubbo version: 3.2.5, current host: 192.168.43.185, error code: 1-37. This may be caused by , go to https://dubbo.apache.org/faq/1/37 to find instructions. 
25-06-11.17:09:08.285 [main            ] INFO  NacosRegistry          -  [DUBBO] Notify urls for subscribe url provider://192.168.43.185:20880/cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService?anyhost=true&application=big-market&application.version=1.0&background=false&bind.ip=192.168.43.185&bind.port=20880&category=configurators&check=false&deprecated=false&dubbo=2.0.2&dynamic=true&executor-management-mode=isolation&file-cache=true&generic=false&interface=cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService&ipv6=240e:404:2600:f356:cb2f:108d:e436:5c98&methods=armory,calendarSignRebate,calendarSignRebateByToken,creditPayExchangeSku,draw,isCalendarSignRebate,isCalendarSignRebateByToken,querySkuProductListByActivityId,queryUserActivityAccount,queryUserCreditAccount,queryUserCreditAccountByToken&pid=43000&prefer.serialization=fastjson2,hessian2&qos.enable=true&release=3.2.5&revision=1.0&service-name-mapping=true&side=provider&timestamp=1749632947916&version=1.0, url size: 1, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.286 [main            ] INFO  ServiceConfig          -  [DUBBO] Try to register interface application mapping for service cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService:1.0, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.286 [DubboSaveMetadataReport-thread-1] INFO  NacosMetadataReport    -  [DUBBO] store provider metadata. Identifier : org.apache.dubbo.metadata.report.identifier.MetadataIdentifier@77cf4168; definition: FullServiceDefinition{parameters={side=provider, application=big-market, anyhost=true, version=1.0, pid=43000, dubbo=2.0.2, release=3.2.5, interface=cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService, executor-management-mode=isolation, file-cache=true, application.version=1.0, methods=armory,calendarSignRebate,calendarSignRebateByToken,creditPayExchangeSku,draw,isCalendarSignRebate,isCalendarSignRebateByToken,querySkuProductListByActivityId,queryUserActivityAccount,queryUserCreditAccount,queryUserCreditAccountByToken, deprecated=false, service-name-mapping=true, qos.enable=true, generic=false, bind.port=20880, revision=1.0, bind.ip=192.168.43.185, prefer.serialization=fastjson2,hessian2, background=false, ipv6=240e:404:2600:f356:cb2f:108d:e436:5c98, dynamic=true, timestamp=1749632947916}} ServiceDefinition [canonicalName=cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService, codeSource=file:/C:/working/云code/code/big-market/big-market-api/target/classes/, methods=[MethodDefinition [name=querySkuProductListByActivityId, parameterTypes=[java.lang.Long], returnType=cn.wenzhuo4657.BigMarket.tigger.api.reponse.Response], MethodDefinition [name=isCalendarSignRebate, parameterTypes=[java.lang.String], returnType=cn.wenzhuo4657.BigMarket.tigger.api.reponse.Response], MethodDefinition [name=queryUserActivityAccount, parameterTypes=[java.lang.String, cn.wenzhuo4657.BigMarket.tigger.api.dto.UserActivityAccountRequestDTO], returnType=cn.wenzhuo4657.BigMarket.tigger.api.reponse.Response], MethodDefinition [name=queryUserActivityAccount, parameterTypes=[cn.wenzhuo4657.BigMarket.tigger.api.dto.UserActivityAccountRequestDTO], returnType=cn.wenzhuo4657.BigMarket.tigger.api.reponse.Response], MethodDefinition [name=calendarSignRebate, parameterTypes=[java.lang.String], returnType=cn.wenzhuo4657.BigMarket.tigger.api.reponse.Response], MethodDefinition [name=creditPayExchangeSku, parameterTypes=[cn.wenzhuo4657.BigMarket.tigger.api.dto.SkuProductShopCartRequestDTO], returnType=cn.wenzhuo4657.BigMarket.tigger.api.reponse.Response], MethodDefinition [name=creditPayExchangeSku, parameterTypes=[java.lang.String, cn.wenzhuo4657.BigMarket.tigger.api.dto.SkuProductShopCartRequestDTO], returnType=cn.wenzhuo4657.BigMarket.tigger.api.reponse.Response], MethodDefinition [name=calendarSignRebateByToken, parameterTypes=[java.lang.String], returnType=cn.wenzhuo4657.BigMarket.tigger.api.reponse.Response], MethodDefinition [name=queryUserCreditAccountByToken, parameterTypes=[java.lang.String], returnType=cn.wenzhuo4657.BigMarket.tigger.api.reponse.Response], MethodDefinition [name=queryUserCreditAccount, parameterTypes=[java.lang.String], returnType=cn.wenzhuo4657.BigMarket.tigger.api.reponse.Response], MethodDefinition [name=isCalendarSignRebateByToken, parameterTypes=[java.lang.String], returnType=cn.wenzhuo4657.BigMarket.tigger.api.reponse.Response], MethodDefinition [name=draw, parameterTypes=[cn.wenzhuo4657.BigMarket.tigger.api.dto.ActivityDrawRequestDTO], returnType=cn.wenzhuo4657.BigMarket.tigger.api.reponse.Response], MethodDefinition [name=draw, parameterTypes=[java.lang.String, cn.wenzhuo4657.BigMarket.tigger.api.dto.ActivityDrawRequestDTO], returnType=cn.wenzhuo4657.BigMarket.tigger.api.reponse.Response], MethodDefinition [name=armory, parameterTypes=[java.lang.Long], returnType=cn.wenzhuo4657.BigMarket.tigger.api.reponse.Response]]], dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.330 [main            ] INFO  ServiceConfig          -  [DUBBO] Successfully registered interface application mapping for service cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService:1.0, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.330 [main            ] INFO  DefaultModuleDeployer  -  [DUBBO] Dubbo Module[1.1.0] is starting., dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.330 [main            ] INFO  DefaultModuleDeployer  -  [DUBBO] Dubbo Module[1.1.0] has started., dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.331 [main            ] INFO  DefaultModuleDeployer  -  [DUBBO] Dubbo Module[1.1.1] has started., dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.331 [main            ] INFO  DefaultMetricsServiceExporter -  [DUBBO] The MetricsConfig not exist, will not export metrics service., dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.336 [main            ] INFO  InternalServiceConfigBuilder -  [DUBBO] org.apache.dubbo.metadata.MetadataServiceService Port hasn't been set will use default protocol defined in protocols., dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.337 [main            ] INFO  InternalServiceConfigBuilder -  [DUBBO] Using dubbo protocol to export org.apache.dubbo.metadata.MetadataService service on port -1, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.426 [main            ] INFO  ServiceConfig          -  [DUBBO] Export dubbo service org.apache.dubbo.metadata.MetadataService to local registry url : injvm://127.0.0.1/org.apache.dubbo.metadata.MetadataService?anyhost=true&application=big-market&application.version=1.0&background=false&bind.ip=192.168.43.185&bind.port=20880&delay=0&deprecated=false&dubbo=2.0.2&dynamic=true&executor-management-mode=isolation&exporter.listener=injvm&file-cache=true&generic=false&getAndListenInstanceMetadata.1.callback=true&getAndListenInstanceMetadata.return=true&getAndListenInstanceMetadata.sent=true&group=big-market&interface=org.apache.dubbo.metadata.MetadataService&ipv6=240e:404:2600:f356:cb2f:108d:e436:5c98&methods=exportInstanceMetadata,getAndListenInstanceMetadata,getExportedServiceURLs,getExportedURLs,getInstanceMetadataChangedListenerMap,getMetadataInfo,getMetadataInfos,getMetadataURL,getServiceDefinition,getSubscribedURLs,isMetadataService,serviceName,toSortedStrings,version&pid=43000&prefer.serialization=fastjson2,hessian2&qos.enable=true&register=false&release=3.2.5&revision=3.2.5&service.filter=-default&side=provider&timestamp=1749632948408&version=1.0.0, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.427 [main            ] INFO  ServiceConfig          -  [DUBBO] Export dubbo service org.apache.dubbo.metadata.MetadataService to url dubbo://192.168.43.185:20880/org.apache.dubbo.metadata.MetadataService?anyhost=true&application=big-market&application.version=1.0&background=false&bind.ip=192.168.43.185&bind.port=20880&delay=0&deprecated=false&dubbo=2.0.2&dynamic=true&executor-management-mode=isolation&file-cache=true&generic=false&getAndListenInstanceMetadata.1.callback=true&getAndListenInstanceMetadata.return=true&getAndListenInstanceMetadata.sent=true&group=big-market&interface=org.apache.dubbo.metadata.MetadataService&ipv6=240e:404:2600:f356:cb2f:108d:e436:5c98&methods=exportInstanceMetadata,getAndListenInstanceMetadata,getExportedServiceURLs,getExportedURLs,getInstanceMetadataChangedListenerMap,getMetadataInfo,getMetadataInfos,getMetadataURL,getServiceDefinition,getSubscribedURLs,isMetadataService,serviceName,toSortedStrings,version&pid=43000&prefer.serialization=fastjson2,hessian2&qos.enable=true&register=false&release=3.2.5&revision=3.2.5&service-name-mapping=true&service.filter=-default&side=provider&timestamp=1749632948408&version=1.0.0, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.557 [main            ] INFO  MigrationRuleListener  -  [DUBBO] Listening for migration rules on dataId big-market.migration, group DUBBO_SERVICEDISCOVERY_MIGRATION, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.607 [main            ] INFO  ServiceConfig          -  [DUBBO] Export dubbo service org.apache.dubbo.metadata.MetadataService to url dubbo://192.168.43.185:20880/org.apache.dubbo.metadata.MetadataService?anyhost=true&application=big-market&application.version=1.0&background=false&bind.ip=192.168.43.185&bind.port=20880&delay=0&deprecated=false&dubbo=2.0.2&dynamic=true&executor-management-mode=isolation&file-cache=true&generic=false&getAndListenInstanceMetadata.1.callback=true&getAndListenInstanceMetadata.return=true&getAndListenInstanceMetadata.sent=true&group=big-market&interface=org.apache.dubbo.metadata.MetadataService&ipv6=240e:404:2600:f356:cb2f:108d:e436:5c98&methods=exportInstanceMetadata,getAndListenInstanceMetadata,getExportedServiceURLs,getExportedURLs,getInstanceMetadataChangedListenerMap,getMetadataInfo,getMetadataInfos,getMetadataURL,getServiceDefinition,getSubscribedURLs,isMetadataService,serviceName,toSortedStrings,version&pid=43000&prefer.serialization=fastjson2,hessian2&qos.enable=true&register=false&release=3.2.5&revision=3.2.5&service-name-mapping=true&service.filter=-default&side=provider&timestamp=1749632948408&version=1.0.0, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.727 [main            ] INFO  NacosRegistry          -  [DUBBO] Subscribe: provider://192.168.43.185:20880/org.apache.dubbo.metadata.MetadataService?anyhost=true&application=big-market&application.version=1.0&background=false&bind.ip=192.168.43.185&bind.port=20880&category=configurators&check=false&delay=0&deprecated=false&dubbo=2.0.2&dynamic=true&executor-management-mode=isolation&file-cache=true&generic=false&getAndListenInstanceMetadata.1.callback=true&getAndListenInstanceMetadata.return=true&getAndListenInstanceMetadata.sent=true&group=big-market&interface=org.apache.dubbo.metadata.MetadataService&ipv6=240e:404:2600:f356:cb2f:108d:e436:5c98&methods=exportInstanceMetadata,getAndListenInstanceMetadata,getExportedServiceURLs,getExportedURLs,getInstanceMetadataChangedListenerMap,getMetadataInfo,getMetadataInfos,getMetadataURL,getServiceDefinition,getSubscribedURLs,isMetadataService,serviceName,toSortedStrings,version&pid=43000&prefer.serialization=fastjson2,hessian2&qos.enable=true&register=false&release=3.2.5&revision=3.2.5&service-name-mapping=true&service.filter=-default&side=provider&timestamp=1749632948408&version=1.0.0, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.777 [main            ] WARN  NacosRegistry          -  [DUBBO] Received empty url address list and empty protection is disabled, will clear current available addresses, dubbo version: 3.2.5, current host: 192.168.43.185, error code: 1-37. This may be caused by , go to https://dubbo.apache.org/faq/1/37 to find instructions. 
25-06-11.17:09:08.778 [main            ] INFO  NacosRegistry          -  [DUBBO] Notify urls for subscribe url provider://192.168.43.185:20880/org.apache.dubbo.metadata.MetadataService?anyhost=true&application=big-market&application.version=1.0&background=false&bind.ip=192.168.43.185&bind.port=20880&category=configurators&check=false&delay=0&deprecated=false&dubbo=2.0.2&dynamic=true&executor-management-mode=isolation&file-cache=true&generic=false&getAndListenInstanceMetadata.1.callback=true&getAndListenInstanceMetadata.return=true&getAndListenInstanceMetadata.sent=true&group=big-market&interface=org.apache.dubbo.metadata.MetadataService&ipv6=240e:404:2600:f356:cb2f:108d:e436:5c98&methods=exportInstanceMetadata,getAndListenInstanceMetadata,getExportedServiceURLs,getExportedURLs,getInstanceMetadataChangedListenerMap,getMetadataInfo,getMetadataInfos,getMetadataURL,getServiceDefinition,getSubscribedURLs,isMetadataService,serviceName,toSortedStrings,version&pid=43000&prefer.serialization=fastjson2,hessian2&qos.enable=true&register=false&release=3.2.5&revision=3.2.5&service-name-mapping=true&service.filter=-default&side=provider&timestamp=1749632948408&version=1.0.0, url size: 1, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.778 [main            ] INFO  ServiceConfig          -  [DUBBO] Try to register interface application mapping for service big-market/org.apache.dubbo.metadata.MetadataService:1.0.0, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.778 [main            ] INFO  ServiceConfig          -  [DUBBO] Successfully registered interface application mapping for service big-market/org.apache.dubbo.metadata.MetadataService:1.0.0, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.778 [main            ] INFO  ConfigurableMetadataServiceExporter -  [DUBBO] The MetadataService exports urls : [dubbo://192.168.43.185:20880/org.apache.dubbo.metadata.MetadataService?anyhost=true&application=big-market&application.version=1.0&background=false&bind.ip=192.168.43.185&bind.port=20880&delay=0&deprecated=false&dubbo=2.0.2&dynamic=true&executor-management-mode=isolation&file-cache=true&generic=false&getAndListenInstanceMetadata.1.callback=true&getAndListenInstanceMetadata.return=true&getAndListenInstanceMetadata.sent=true&group=big-market&interface=org.apache.dubbo.metadata.MetadataService&ipv6=240e:404:2600:f356:cb2f:108d:e436:5c98&methods=exportInstanceMetadata,getAndListenInstanceMetadata,getExportedServiceURLs,getExportedURLs,getInstanceMetadataChangedListenerMap,getMetadataInfo,getMetadataInfos,getMetadataURL,getServiceDefinition,getSubscribedURLs,isMetadataService,serviceName,toSortedStrings,version&pid=43000&prefer.serialization=fastjson2,hessian2&qos.enable=true&register=false&release=3.2.5&revision=3.2.5&service-name-mapping=true&service.filter=-default&side=provider&timestamp=1749632948408&version=1.0.0], dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.792 [main            ] INFO  ServiceInstanceMetadataUtils -  [DUBBO] Start registering instance address to registry., dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.812 [main            ] INFO  DefaultApplicationDeployer -  [DUBBO] Dubbo Application[1.1](big-market) is ready., dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.822 [main            ] INFO  RegistryProtocol       -  [DUBBO] Registered dubbo service cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService:1.0 url dubbo://192.168.43.185:20880/cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService?application=big-market&application.version=1.0&deprecated=false&dubbo=2.0.2&dynamic=true&generic=false&interface=cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService&ipv6=240e:404:2600:f356:cb2f:108d:e436:5c98&methods=queryRaffleAwardList,queryRaffleAwardListByToken,queryRaffleStrategyRuleWeight,randomRaffle,strategyArmory&prefer.serialization=fastjson2,hessian2&release=3.2.5&revision=1.0&service-name-mapping=true&side=provider&timestamp=1749632945452&version=1.0 to registry service-discovery-registry://117.72.36.124:8848/org.apache.dubbo.registry.RegistryService?REGISTRY_CLUSTER=nacos-registry&application=big-market&application.version=1.0&dubbo=2.0.2&executor-management-mode=isolation&file-cache=true&pid=43000&qos.enable=true&register=false&registry=nacos&release=3.2.5&timestamp=1749632945395, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.822 [main            ] INFO  NacosRegistry          -  [DUBBO] Register: dubbo://192.168.43.185:20880/cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService?application=big-market&application.version=1.0&deprecated=false&dubbo=2.0.2&dynamic=true&generic=false&interface=cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService&ipv6=240e:404:2600:f356:cb2f:108d:e436:5c98&methods=queryRaffleAwardList,queryRaffleAwardListByToken,queryRaffleStrategyRuleWeight,randomRaffle,strategyArmory&prefer.serialization=fastjson2,hessian2&release=3.2.5&revision=1.0&service-name-mapping=true&side=provider&timestamp=1749632945452&version=1.0, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.870 [main            ] INFO  RegistryProtocol       -  [DUBBO] Registered dubbo service cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService:1.0 url dubbo://192.168.43.185:20880/cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService?application=big-market&application.version=1.0&deprecated=false&dubbo=2.0.2&dynamic=true&generic=false&interface=cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService&ipv6=240e:404:2600:f356:cb2f:108d:e436:5c98&methods=queryRaffleAwardList,queryRaffleAwardListByToken,queryRaffleStrategyRuleWeight,randomRaffle,strategyArmory&prefer.serialization=fastjson2,hessian2&release=3.2.5&revision=1.0&service-name-mapping=true&side=provider&timestamp=1749632945452&version=1.0 to registry nacos://117.72.36.124:8848/org.apache.dubbo.registry.RegistryService?REGISTRY_CLUSTER=nacos-registry&application=big-market&application.version=1.0&dubbo=2.0.2&executor-management-mode=isolation&file-cache=true&pid=43000&qos.enable=true&register=false&release=3.2.5&timestamp=1749632945395, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.870 [main            ] INFO  RegistryProtocol       -  [DUBBO] Registered dubbo service cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService:1.0 url dubbo://192.168.43.185:20880/cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService?application=big-market&application.version=1.0&deprecated=false&dubbo=2.0.2&dynamic=true&generic=false&interface=cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService&ipv6=240e:404:2600:f356:cb2f:108d:e436:5c98&methods=armory,calendarSignRebate,calendarSignRebateByToken,creditPayExchangeSku,draw,isCalendarSignRebate,isCalendarSignRebateByToken,querySkuProductListByActivityId,queryUserActivityAccount,queryUserCreditAccount,queryUserCreditAccountByToken&prefer.serialization=fastjson2,hessian2&release=3.2.5&revision=1.0&service-name-mapping=true&side=provider&timestamp=1749632947916&version=1.0 to registry service-discovery-registry://117.72.36.124:8848/org.apache.dubbo.registry.RegistryService?REGISTRY_CLUSTER=nacos-registry&application=big-market&application.version=1.0&dubbo=2.0.2&executor-management-mode=isolation&file-cache=true&pid=43000&qos.enable=true&register=false&registry=nacos&release=3.2.5&timestamp=1749632947915, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.870 [main            ] INFO  NacosRegistry          -  [DUBBO] Register: dubbo://192.168.43.185:20880/cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService?application=big-market&application.version=1.0&deprecated=false&dubbo=2.0.2&dynamic=true&generic=false&interface=cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService&ipv6=240e:404:2600:f356:cb2f:108d:e436:5c98&methods=armory,calendarSignRebate,calendarSignRebateByToken,creditPayExchangeSku,draw,isCalendarSignRebate,isCalendarSignRebateByToken,querySkuProductListByActivityId,queryUserActivityAccount,queryUserCreditAccount,queryUserCreditAccountByToken&prefer.serialization=fastjson2,hessian2&release=3.2.5&revision=1.0&service-name-mapping=true&side=provider&timestamp=1749632947916&version=1.0, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.913 [main            ] INFO  RegistryProtocol       -  [DUBBO] Registered dubbo service cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService:1.0 url dubbo://192.168.43.185:20880/cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService?application=big-market&application.version=1.0&deprecated=false&dubbo=2.0.2&dynamic=true&generic=false&interface=cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService&ipv6=240e:404:2600:f356:cb2f:108d:e436:5c98&methods=armory,calendarSignRebate,calendarSignRebateByToken,creditPayExchangeSku,draw,isCalendarSignRebate,isCalendarSignRebateByToken,querySkuProductListByActivityId,queryUserActivityAccount,queryUserCreditAccount,queryUserCreditAccountByToken&prefer.serialization=fastjson2,hessian2&release=3.2.5&revision=1.0&service-name-mapping=true&side=provider&timestamp=1749632947916&version=1.0 to registry nacos://117.72.36.124:8848/org.apache.dubbo.registry.RegistryService?REGISTRY_CLUSTER=nacos-registry&application=big-market&application.version=1.0&dubbo=2.0.2&executor-management-mode=isolation&file-cache=true&pid=43000&qos.enable=true&register=false&release=3.2.5&timestamp=1749632947915, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.917 [main            ] INFO  MetadataInfo           -  [DUBBO] metadata revision changed: null -> 7f5e0ea029c6bda58d38e7d6b776b2ad, app: big-market, services: 2, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:08.978 [main            ] INFO  Application            - Started Application in 51.692 seconds (JVM running for 53.187)
25-06-11.17:09:09.276 [Dubbo-framework-registry-notification-2-thread-1] WARN  NacosRegistry          -  [DUBBO] Received empty url address list and empty protection is disabled, will clear current available addresses, dubbo version: 3.2.5, current host: 192.168.43.185, error code: 1-37. This may be caused by , go to https://dubbo.apache.org/faq/1/37 to find instructions. 
25-06-11.17:09:09.276 [Dubbo-framework-registry-notification-2-thread-1] INFO  NacosRegistry          -  [DUBBO] Notify urls for subscribe url provider://192.168.43.185:20880/cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService?anyhost=true&application=big-market&application.version=1.0&background=false&bind.ip=192.168.43.185&bind.port=20880&category=configurators&check=false&deprecated=false&dubbo=2.0.2&dynamic=true&executor-management-mode=isolation&file-cache=true&generic=false&interface=cn.wenzhuo4657.BigMarket.tigger.api.IRaffleActivityService&ipv6=240e:404:2600:f356:cb2f:108d:e436:5c98&methods=armory,calendarSignRebate,calendarSignRebateByToken,creditPayExchangeSku,draw,isCalendarSignRebate,isCalendarSignRebateByToken,querySkuProductListByActivityId,queryUserActivityAccount,queryUserCreditAccount,queryUserCreditAccountByToken&pid=43000&prefer.serialization=fastjson2,hessian2&qos.enable=true&release=3.2.5&revision=1.0&service-name-mapping=true&side=provider&timestamp=1749632947916&version=1.0, url size: 1, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:09.385 [Dubbo-framework-registry-notification-0-thread-1] WARN  NacosRegistry          -  [DUBBO] Received empty url address list and empty protection is disabled, will clear current available addresses, dubbo version: 3.2.5, current host: 192.168.43.185, error code: 1-37. This may be caused by , go to https://dubbo.apache.org/faq/1/37 to find instructions. 
25-06-11.17:09:09.385 [Dubbo-framework-registry-notification-0-thread-1] INFO  NacosRegistry          -  [DUBBO] Notify urls for subscribe url provider://192.168.43.185:20880/cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService?anyhost=true&application=big-market&application.version=1.0&background=false&bind.ip=192.168.43.185&bind.port=20880&category=configurators&check=false&deprecated=false&dubbo=2.0.2&dynamic=true&executor-management-mode=isolation&file-cache=true&generic=false&interface=cn.wenzhuo4657.BigMarket.tigger.api.IRaffleStrategyService&ipv6=240e:404:2600:f356:cb2f:108d:e436:5c98&methods=queryRaffleAwardList,queryRaffleAwardListByToken,queryRaffleStrategyRuleWeight,randomRaffle,strategyArmory&pid=43000&prefer.serialization=fastjson2,hessian2&qos.enable=true&release=3.2.5&revision=1.0&service-name-mapping=true&side=provider&timestamp=1749632945452&version=1.0, url size: 1, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:09:09.395 [RMI TCP Connection(4)-10.14.230.76] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
25-06-11.17:09:09.395 [RMI TCP Connection(4)-10.14.230.76] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
25-06-11.17:09:09.398 [RMI TCP Connection(4)-10.14.230.76] INFO  DispatcherServlet      - Completed initialization in 3 ms
25-06-11.17:09:09.489 [RMI TCP Connection(3)-10.14.230.76] WARN  RestClient             - request [GET http://154.64.245.158:9200/_cluster/health/] returned 1 warnings: [299 Elasticsearch-7.17.14-774e3bfa4d52e2834e4d9d8d669d77e4e5c1017f "Elasticsearch built-in security features are not enabled. Without authentication, your cluster could be accessible to anyone. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/security-minimal-setup.html to enable security."]
25-06-11.17:10:06.648 [http-nio-8091-exec-1] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:07.135 [http-nio-8091-exec-3] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:07.724 [http-nio-8091-exec-5] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:08.326 [http-nio-8091-exec-7] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:08.926 [http-nio-8091-exec-14] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:09.525 [http-nio-8091-exec-11] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:10.125 [http-nio-8091-exec-8] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:10.725 [http-nio-8091-exec-6] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:11.324 [http-nio-8091-exec-24] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:11.927 [http-nio-8091-exec-19] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:12.524 [http-nio-8091-exec-21] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:13.126 [http-nio-8091-exec-23] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:13.738 [http-nio-8091-exec-25] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:14.329 [http-nio-8091-exec-33] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:14.936 [http-nio-8091-exec-29] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:15.535 [http-nio-8091-exec-31] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:16.138 [http-nio-8091-exec-27] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:16.731 [http-nio-8091-exec-35] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:17.332 [http-nio-8091-exec-37] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:17.935 [http-nio-8091-exec-39] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:18.525 [http-nio-8091-exec-41] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:19.132 [http-nio-8091-exec-43] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:19.733 [http-nio-8091-exec-45] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:20.337 [http-nio-8091-exec-47] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:20.925 [http-nio-8091-exec-49] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:21.533 [http-nio-8091-exec-1] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:22.136 [http-nio-8091-exec-3] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:22.728 [http-nio-8091-exec-5] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:23.331 [http-nio-8091-exec-7] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:23.936 [http-nio-8091-exec-14] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:24.529 [http-nio-8091-exec-11] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:25.126 [http-nio-8091-exec-8] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:25.724 [http-nio-8091-exec-6] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:26.324 [http-nio-8091-exec-24] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:26.925 [http-nio-8091-exec-19] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:27.531 [http-nio-8091-exec-21] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:28.138 [http-nio-8091-exec-23] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:28.728 [http-nio-8091-exec-25] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:29.326 [http-nio-8091-exec-33] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:29.924 [http-nio-8091-exec-29] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:30.524 [http-nio-8091-exec-31] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:31.125 [http-nio-8091-exec-27] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:31.724 [http-nio-8091-exec-35] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:32.325 [http-nio-8091-exec-37] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:32.925 [http-nio-8091-exec-39] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:33.524 [http-nio-8091-exec-41] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:34.138 [http-nio-8091-exec-43] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:34.724 [http-nio-8091-exec-45] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:35.324 [http-nio-8091-exec-47] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:35.924 [http-nio-8091-exec-49] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:36.525 [http-nio-8091-exec-1] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:37.125 [http-nio-8091-exec-3] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:37.724 [http-nio-8091-exec-5] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:38.323 [http-nio-8091-exec-7] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:38.924 [http-nio-8091-exec-14] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:39.524 [http-nio-8091-exec-11] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:40.136 [http-nio-8091-exec-8] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:40.724 [http-nio-8091-exec-6] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:41.324 [http-nio-8091-exec-24] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:41.923 [http-nio-8091-exec-19] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:42.523 [http-nio-8091-exec-21] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:43.125 [http-nio-8091-exec-23] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:43.725 [http-nio-8091-exec-25] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:44.323 [http-nio-8091-exec-33] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:44.924 [http-nio-8091-exec-29] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:45.524 [http-nio-8091-exec-31] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:46.124 [http-nio-8091-exec-27] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:46.722 [http-nio-8091-exec-35] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:47.324 [http-nio-8091-exec-37] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:47.925 [http-nio-8091-exec-39] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:48.525 [http-nio-8091-exec-41] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:49.124 [http-nio-8091-exec-43] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:49.723 [http-nio-8091-exec-45] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:50.325 [http-nio-8091-exec-47] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:50.924 [http-nio-8091-exec-49] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:51.523 [http-nio-8091-exec-1] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:52.124 [http-nio-8091-exec-3] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:52.724 [http-nio-8091-exec-5] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:53.325 [http-nio-8091-exec-7] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:53.925 [http-nio-8091-exec-14] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:54.523 [http-nio-8091-exec-11] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:55.124 [http-nio-8091-exec-8] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:55.724 [http-nio-8091-exec-6] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:56.338 [http-nio-8091-exec-24] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:56.924 [http-nio-8091-exec-19] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:57.526 [http-nio-8091-exec-21] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:58.125 [http-nio-8091-exec-23] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:58.723 [http-nio-8091-exec-25] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:59.324 [http-nio-8091-exec-33] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:10:59.923 [http-nio-8091-exec-29] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:11:00.524 [http-nio-8091-exec-31] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:11:01.129 [http-nio-8091-exec-27] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:11:01.737 [http-nio-8091-exec-35] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:11:02.325 [http-nio-8091-exec-37] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:11:02.924 [http-nio-8091-exec-39] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:11:03.524 [http-nio-8091-exec-41] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:11:04.124 [http-nio-8091-exec-43] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:11:04.724 [http-nio-8091-exec-45] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:11:05.323 [http-nio-8091-exec-47] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:11:05.924 [http-nio-8091-exec-49] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpMediaTypeNotSupportedException: Content type 'text/plain;charset=UTF-8' not supported]
25-06-11.17:12:25.862 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:26.419 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:27.004 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:27.075 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Logic SQL: select
            id, activity_id, activity_name, activity_desc, begin_date_time, end_date_time, strategy_id, state, create_time, update_time
        from raffle_activity
        where activity_id= ?
25-06-11.17:12:27.075 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Logic SQL: select
            id, activity_id, activity_name, activity_desc, begin_date_time, end_date_time, strategy_id, state, create_time, update_time
        from raffle_activity
        where activity_id= ?
25-06-11.17:12:27.075 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Logic SQL: select
            id, activity_id, activity_name, activity_desc, begin_date_time, end_date_time, strategy_id, state, create_time, update_time
        from raffle_activity
        where activity_id= ?
25-06-11.17:12:27.075 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:27.075 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:27.075 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:27.075 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select
            id, activity_id, activity_name, activity_desc, begin_date_time, end_date_time, strategy_id, state, create_time, update_time
        from raffle_activity
        where activity_id= ? ::: [100401]
25-06-11.17:12:27.075 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select
            id, activity_id, activity_name, activity_desc, begin_date_time, end_date_time, strategy_id, state, create_time, update_time
        from raffle_activity
        where activity_id= ? ::: [100401]
25-06-11.17:12:27.075 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select
            id, activity_id, activity_name, activity_desc, begin_date_time, end_date_time, strategy_id, state, create_time, update_time
        from raffle_activity
        where activity_id= ? ::: [100401]
25-06-11.17:12:27.394 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:27.394 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:27.394 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.394 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.394 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.394 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.394 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.394 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.394 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.394 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.472 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:27.472 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:27.472 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.472 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.472 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.472 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.472 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.472 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.472 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.472 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.548 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:27.550 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:27.550 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.550 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.550 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.550 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.550 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.550 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.550 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.550 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.605 [http-nio-8091-exec-4] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:27.654 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:27.654 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:27.654 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.654 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.654 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.654 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.654 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.654 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.654 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:27.654 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:28.048 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:28.114 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Logic SQL: select strategy_id,strategy_desc,rule_models
        from strategy
        where strategy_id = ?
25-06-11.17:12:28.114 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:28.115 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select strategy_id,strategy_desc,rule_models
        from strategy
        where strategy_id = ? ::: [100006]
25-06-11.17:12:28.205 [http-nio-8091-exec-5] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:28.243 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:28.243 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:28.243 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:28.243 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:28.243 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:28.243 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:28.243 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:28.244 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:28.244 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:28.244 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:28.296 [http-nio-8091-exec-2] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:28.333 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:28.333 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:28.333 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:28.411 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:28.412 [http-nio-8091-exec-3] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:28.412 [http-nio-8091-exec-2] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:28.414 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:28.414 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:28.414 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:28.458 [http-nio-8091-exec-2] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:28.480 [http-nio-8091-exec-3] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:28.520 [http-nio-8091-exec-3] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:28.735 [http-nio-8091-exec-4] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:28.735 [http-nio-8091-exec-4] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:28.736 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:28.736 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:28.736 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:28.804 [http-nio-8091-exec-13] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:28.821 [http-nio-8091-exec-4] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:28.824 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:28.824 [http-nio-8091-exec-1] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:28.824 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:28.824 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:28.824 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:28.840 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:28.842 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:28.842 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:28.842 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:28.842 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:28.842 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:28.842 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:28.842 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:28.842 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:28.842 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:28.869 [http-nio-8091-exec-4] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:28.900 [http-nio-8091-exec-1] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:28.940 [http-nio-8091-exec-1] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:29.171 [http-nio-8091-exec-13] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:29.171 [http-nio-8091-exec-13] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:29.173 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:29.173 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:29.173 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:29.181 [http-nio-8091-exec-5] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:29.181 [http-nio-8091-exec-5] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:29.183 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:29.183 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:29.183 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:29.259 [http-nio-8091-exec-13] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:29.302 [http-nio-8091-exec-13] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:29.307 [http-nio-8091-exec-5] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:29.381 [http-nio-8091-exec-5] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:29.415 [http-nio-8091-exec-8] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:29.462 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:29.462 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:29.462 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:29.462 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:29.462 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:29.462 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:29.462 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:29.462 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:29.462 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:29.462 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:29.788 [http-nio-8091-exec-8] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:29.788 [http-nio-8091-exec-8] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:29.789 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:29.789 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:29.789 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:29.900 [http-nio-8091-exec-8] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:29.941 [http-nio-8091-exec-8] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:30.088 [http-nio-8091-exec-6] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:30.139 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:30.140 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:30.140 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:30.140 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:30.140 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:30.140 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:30.140 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:30.140 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:30.140 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:30.140 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:30.492 [http-nio-8091-exec-6] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:30.492 [http-nio-8091-exec-6] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:30.493 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:30.493 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:30.493 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:30.600 [http-nio-8091-exec-6] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:30.604 [http-nio-8091-exec-16] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:30.641 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:30.641 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:30.641 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:30.641 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:30.641 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:30.641 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:30.641 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:30.641 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:30.641 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:30.641 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:30.644 [http-nio-8091-exec-6] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:30.972 [http-nio-8091-exec-16] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:30.972 [http-nio-8091-exec-16] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:30.972 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:30.972 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:30.972 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:31.057 [http-nio-8091-exec-16] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:31.119 [http-nio-8091-exec-16] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:31.207 [http-nio-8091-exec-19] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:31.321 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:31.321 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:31.321 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:31.321 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:31.321 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:31.321 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:31.321 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:31.321 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:31.321 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:31.321 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:31.653 [http-nio-8091-exec-19] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:31.653 [http-nio-8091-exec-19] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:31.654 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:31.654 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:31.654 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:31.788 [http-nio-8091-exec-19] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:31.803 [http-nio-8091-exec-20] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:31.823 [http-nio-8091-exec-19] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:31.841 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:31.841 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:31.841 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:31.841 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:31.841 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:31.841 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:31.841 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:31.841 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:31.841 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:31.841 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:32.185 [http-nio-8091-exec-20] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:32.185 [http-nio-8091-exec-20] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:32.186 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:32.186 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:32.186 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:32.269 [http-nio-8091-exec-20] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:32.301 [http-nio-8091-exec-20] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:32.404 [http-nio-8091-exec-23] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:32.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:32.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:32.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:32.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:32.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:32.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:32.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:32.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:32.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:32.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:32.831 [http-nio-8091-exec-23] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:32.831 [http-nio-8091-exec-23] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:32.832 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:32.832 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:32.832 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:32.959 [http-nio-8091-exec-23] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:33.002 [http-nio-8091-exec-17] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:33.002 [http-nio-8091-exec-23] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:33.040 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:33.040 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:33.040 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:33.040 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:33.040 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:33.041 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:33.041 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:33.041 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:33.041 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:33.041 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:33.392 [http-nio-8091-exec-17] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:33.392 [http-nio-8091-exec-17] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:33.393 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:33.393 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:33.393 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:33.541 [http-nio-8091-exec-17] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:33.580 [http-nio-8091-exec-17] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:33.604 [http-nio-8091-exec-33] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:33.640 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:33.640 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:33.640 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:33.640 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:33.640 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:33.640 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:33.640 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:33.640 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:33.640 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:33.641 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:33.968 [http-nio-8091-exec-33] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:33.969 [http-nio-8091-exec-33] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:33.969 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:33.969 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:33.969 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:34.077 [http-nio-8091-exec-33] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:34.120 [http-nio-8091-exec-33] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:34.216 [http-nio-8091-exec-29] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:34.261 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:34.261 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:34.261 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:34.261 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:34.261 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:34.261 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:34.261 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:34.261 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:34.261 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:34.261 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:34.631 [http-nio-8091-exec-29] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:34.631 [http-nio-8091-exec-29] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:34.633 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:34.633 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:34.633 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:34.771 [http-nio-8091-exec-29] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:34.802 [http-nio-8091-exec-29] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:34.818 [http-nio-8091-exec-31] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:34.862 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:34.862 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:34.862 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:34.862 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:34.862 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:34.862 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:34.862 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:34.862 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:34.862 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:34.862 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:35.266 [http-nio-8091-exec-31] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:35.266 [http-nio-8091-exec-31] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:35.267 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:35.267 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:35.267 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:35.382 [http-nio-8091-exec-31] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:35.402 [http-nio-8091-exec-32] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:35.422 [http-nio-8091-exec-31] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:35.442 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:35.443 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:35.443 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:35.443 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:35.443 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:35.443 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:35.443 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:35.443 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:35.443 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:35.443 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:35.773 [http-nio-8091-exec-32] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:35.773 [http-nio-8091-exec-32] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:35.774 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:35.774 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:35.774 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:36.004 [http-nio-8091-exec-34] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:36.049 [http-nio-8091-exec-32] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:36.049 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:36.049 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:36.049 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:36.049 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:36.049 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:36.050 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:36.050 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:36.050 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:36.050 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:36.050 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:36.083 [http-nio-8091-exec-32] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:36.431 [http-nio-8091-exec-34] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:36.431 [http-nio-8091-exec-34] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:36.432 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:36.432 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:36.432 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:36.539 [http-nio-8091-exec-34] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:36.582 [http-nio-8091-exec-34] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:36.604 [http-nio-8091-exec-37] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:36.639 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:36.639 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:36.639 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:36.639 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:36.639 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:36.639 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:36.639 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:36.639 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:36.639 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:36.639 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:37.070 [http-nio-8091-exec-37] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:37.070 [http-nio-8091-exec-37] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:37.070 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:37.070 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:37.070 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:37.178 [http-nio-8091-exec-37] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:37.208 [http-nio-8091-exec-38] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:37.223 [http-nio-8091-exec-37] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:37.260 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:37.260 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:37.260 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:37.260 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:37.260 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:37.260 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:37.260 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:37.260 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:37.260 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:37.260 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:37.620 [http-nio-8091-exec-38] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:37.620 [http-nio-8091-exec-38] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:37.620 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:37.621 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:37.621 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:37.758 [http-nio-8091-exec-38] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:37.805 [http-nio-8091-exec-38] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:37.806 [http-nio-8091-exec-40] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:37.841 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:37.841 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:37.841 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:37.841 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:37.841 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:37.841 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:37.841 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:37.841 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:37.841 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:37.841 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:38.170 [http-nio-8091-exec-40] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:38.170 [http-nio-8091-exec-40] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:38.170 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:38.170 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:38.170 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:38.249 [http-nio-8091-exec-40] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:38.285 [http-nio-8091-exec-40] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:38.407 [http-nio-8091-exec-43] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:38.438 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:38.438 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:38.438 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:38.438 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:38.438 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:38.438 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:38.438 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:38.438 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:38.439 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:38.439 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:38.775 [http-nio-8091-exec-43] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:38.775 [http-nio-8091-exec-43] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:38.776 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:38.776 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:38.776 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:38.911 [http-nio-8091-exec-43] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:38.965 [http-nio-8091-exec-43] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:39.011 [http-nio-8091-exec-45] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:39.040 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:39.041 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:39.041 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:39.041 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:39.041 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:39.041 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:39.041 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:39.041 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:39.041 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:39.041 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:39.371 [http-nio-8091-exec-45] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:39.371 [http-nio-8091-exec-45] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:39.371 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:39.371 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:39.371 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:39.480 [http-nio-8091-exec-45] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:39.532 [http-nio-8091-exec-45] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:39.615 [http-nio-8091-exec-47] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:39.659 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:39.660 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:39.660 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:39.660 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:39.660 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:39.660 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:39.660 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:39.660 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:39.660 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:39.660 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:39.993 [http-nio-8091-exec-47] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:39.993 [http-nio-8091-exec-47] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:39.993 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:39.993 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:39.993 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:40.121 [http-nio-8091-exec-47] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:40.165 [http-nio-8091-exec-47] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:40.205 [http-nio-8091-exec-49] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:40.251 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:40.251 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:40.251 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:40.251 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:40.251 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:40.251 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:40.251 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:40.251 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:40.251 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:40.251 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:40.572 [http-nio-8091-exec-49] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:40.572 [http-nio-8091-exec-49] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:40.572 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:40.572 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:40.572 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:40.674 [http-nio-8091-exec-49] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:40.704 [http-nio-8091-exec-49] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:40.810 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:40.850 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:40.850 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:40.850 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:40.850 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:40.850 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:40.850 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:40.850 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:40.850 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:40.850 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:40.850 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:41.181 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:41.181 [http-nio-8091-exec-2] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:41.182 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:41.182 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:41.182 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:41.301 [http-nio-8091-exec-2] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:41.353 [http-nio-8091-exec-2] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:41.410 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:41.449 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:41.449 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:41.449 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:41.449 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:41.449 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:41.449 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:41.449 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:41.449 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:41.449 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:41.449 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:41.769 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:41.769 [http-nio-8091-exec-3] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:41.770 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:41.770 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:41.770 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:41.900 [http-nio-8091-exec-3] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:41.956 [http-nio-8091-exec-3] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:42.013 [http-nio-8091-exec-4] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:42.055 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:42.055 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:42.055 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:42.055 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:42.055 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:42.055 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:42.055 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:42.055 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:42.055 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:42.055 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:42.499 [http-nio-8091-exec-4] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:42.499 [http-nio-8091-exec-4] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:42.500 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:42.500 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:42.500 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:42.616 [http-nio-8091-exec-14] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:42.620 [http-nio-8091-exec-4] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:42.660 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:42.660 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:42.660 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:42.660 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:42.660 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:42.660 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:42.660 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:42.660 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:42.660 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:42.660 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:42.672 [http-nio-8091-exec-4] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:43.090 [http-nio-8091-exec-14] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:43.090 [http-nio-8091-exec-14] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:43.090 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:43.090 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:43.090 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:43.203 [http-nio-8091-exec-15] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:43.208 [http-nio-8091-exec-14] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:43.241 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:43.241 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:43.241 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:43.241 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:43.241 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:43.241 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:43.241 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:43.241 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:43.241 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:43.241 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:43.244 [http-nio-8091-exec-14] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:43.602 [http-nio-8091-exec-15] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:43.602 [http-nio-8091-exec-15] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:43.603 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:43.603 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:43.603 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:43.680 [http-nio-8091-exec-15] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:43.724 [http-nio-8091-exec-15] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:43.806 [http-nio-8091-exec-5] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:43.842 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:43.842 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:43.842 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:43.842 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:43.842 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:43.842 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:43.842 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:43.842 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:43.842 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:43.842 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:44.271 [http-nio-8091-exec-5] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:44.271 [http-nio-8091-exec-5] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:44.272 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:44.272 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:44.272 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:44.393 [http-nio-8091-exec-5] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:44.410 [http-nio-8091-exec-12] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:44.426 [http-nio-8091-exec-5] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:44.440 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:44.440 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:44.440 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:44.440 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:44.440 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:44.440 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:44.440 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:44.440 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:44.440 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:44.440 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:44.945 [http-nio-8091-exec-12] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:44.947 [http-nio-8091-exec-12] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:44.947 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:44.947 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:44.947 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:45.011 [http-nio-8091-exec-9] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:45.040 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:45.040 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:45.040 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:45.040 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:45.040 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:45.040 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:45.040 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:45.040 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:45.040 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:45.040 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:45.070 [http-nio-8091-exec-12] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:45.113 [http-nio-8091-exec-12] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:45.428 [http-nio-8091-exec-9] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:45.428 [http-nio-8091-exec-9] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:45.428 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:45.428 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:45.428 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:45.511 [http-nio-8091-exec-9] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:45.575 [http-nio-8091-exec-9] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:45.613 [http-nio-8091-exec-16] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:45.665 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:45.665 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:45.665 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:45.665 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:45.665 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:45.665 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:45.665 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:45.665 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:45.665 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:45.665 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:46.029 [http-nio-8091-exec-16] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:46.029 [http-nio-8091-exec-16] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:46.031 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:46.031 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:46.031 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:46.151 [http-nio-8091-exec-16] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:46.193 [http-nio-8091-exec-16] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:46.215 [http-nio-8091-exec-19] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:46.261 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:46.261 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:46.261 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:46.261 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:46.261 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:46.261 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:46.261 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:46.261 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:46.261 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:46.261 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:46.590 [http-nio-8091-exec-19] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:46.590 [http-nio-8091-exec-19] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:46.591 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:46.591 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:46.591 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:46.750 [http-nio-8091-exec-19] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:46.786 [http-nio-8091-exec-19] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:46.818 [http-nio-8091-exec-20] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:46.863 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:46.864 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:46.864 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:46.864 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:46.864 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:46.864 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:46.864 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:46.864 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:46.864 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:46.864 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:47.201 [http-nio-8091-exec-20] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:47.201 [http-nio-8091-exec-20] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:47.201 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:47.201 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:47.201 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:47.321 [http-nio-8091-exec-20] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:47.365 [http-nio-8091-exec-20] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:47.405 [http-nio-8091-exec-23] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:47.439 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:47.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:47.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:47.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:47.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:47.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:47.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:47.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:47.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:47.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:47.770 [http-nio-8091-exec-23] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:47.770 [http-nio-8091-exec-23] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:47.771 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:47.771 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:47.771 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:47.890 [http-nio-8091-exec-23] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:47.935 [http-nio-8091-exec-23] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:48.010 [http-nio-8091-exec-17] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:48.039 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:48.039 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:48.039 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:48.039 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:48.039 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:48.039 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:48.039 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:48.039 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:48.039 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:48.039 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:48.365 [http-nio-8091-exec-17] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:48.365 [http-nio-8091-exec-17] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:48.365 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:48.365 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:48.365 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:48.481 [http-nio-8091-exec-17] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:48.531 [http-nio-8091-exec-17] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:48.614 [http-nio-8091-exec-33] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:48.669 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:48.669 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:48.669 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:48.669 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:48.669 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:48.669 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:48.669 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:48.669 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:48.669 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:48.669 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:48.988 [http-nio-8091-exec-33] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:48.988 [http-nio-8091-exec-33] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:48.988 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:48.988 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:48.988 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:49.110 [http-nio-8091-exec-33] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:49.145 [http-nio-8091-exec-33] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:49.204 [http-nio-8091-exec-29] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:49.241 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:49.241 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:49.241 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:49.241 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:49.241 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:49.241 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:49.241 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:49.241 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:49.241 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:49.241 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:49.630 [http-nio-8091-exec-29] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:49.630 [http-nio-8091-exec-29] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:49.630 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:49.630 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:49.630 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:49.739 [http-nio-8091-exec-29] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:49.788 [http-nio-8091-exec-29] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:49.809 [http-nio-8091-exec-31] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:49.879 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:49.879 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:49.879 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:49.879 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:49.879 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:49.879 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:49.879 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:49.879 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:49.879 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:49.879 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:50.202 [http-nio-8091-exec-31] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:50.202 [http-nio-8091-exec-31] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:50.202 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:50.202 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:50.202 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:50.321 [http-nio-8091-exec-31] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:50.367 [http-nio-8091-exec-31] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:50.411 [http-nio-8091-exec-32] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:50.439 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:50.439 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:50.439 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:50.439 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:50.439 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:50.439 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:50.439 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:50.439 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:50.439 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:50.439 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:50.772 [http-nio-8091-exec-32] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:50.772 [http-nio-8091-exec-32] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:50.772 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:50.772 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:50.772 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:50.900 [http-nio-8091-exec-32] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:50.942 [http-nio-8091-exec-32] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:51.015 [http-nio-8091-exec-34] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:51.059 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:51.059 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:51.059 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:51.059 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:51.059 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:51.059 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:51.059 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:51.059 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:51.059 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:51.059 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:51.433 [http-nio-8091-exec-34] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:51.433 [http-nio-8091-exec-34] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:51.434 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:51.434 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:51.434 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:51.539 [http-nio-8091-exec-34] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:51.583 [http-nio-8091-exec-34] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:51.605 [http-nio-8091-exec-37] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:12:51.641 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:12:51.641 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:12:51.641 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:51.641 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:51.641 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:51.641 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:51.641 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:51.641 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:51.641 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:51.641 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:12:51.969 [http-nio-8091-exec-37] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:12:51.969 [http-nio-8091-exec-37] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:51.969 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:51.969 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:51.969 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:12:52.079 [http-nio-8091-exec-37] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:12:52.123 [http-nio-8091-exec-37] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
java.lang.NullPointerException: null
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository.getRateRange(StrategyRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$43dd791e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$f71fa8dd.getRateRange(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.armory.StrategyArmoryDispatch.getRandomAwardId(StrategyArmoryDispatch.java:80)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.DefaultLogicChain.logic(DefaultLogicChain.java:40)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.rule.chain.impl.BackListLogicChain.logic(BackListLogicChain.java:56)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:46)
	at cn.wenzhuo4657.BigMarket.domain.strategy.service.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:45)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:130)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
25-06-11.17:12:55.689 [http-nio-8091-exec-41] INFO  RaffleActivityController - 活动装配，数据预热，开始 activityId:100401
25-06-11.17:12:55.691 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Logic SQL: select sku, activity_count_id, stock_count, stock_count_surplus, product_amount
           from raffle_activity_sku
        where  activity_id=?
25-06-11.17:12:55.691 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:55.691 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select sku, activity_count_id, stock_count, stock_count_surplus, product_amount
           from raffle_activity_sku
        where  activity_id=? ::: [100401]
25-06-11.17:12:55.950 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Logic SQL: select
            id, activity_count_id, total_count, day_count, month_count, create_time, update_time
        from raffle_activity_count
        where activity_count_id = ?
25-06-11.17:12:55.951 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:55.951 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select
            id, activity_count_id, total_count, day_count, month_count, create_time, update_time
        from raffle_activity_count
        where activity_count_id = ? ::: [11101]
25-06-11.17:12:56.101 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Logic SQL: select  strategy_id
        from raffle_activity
        where activity_id=?
25-06-11.17:12:56.102 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:56.102 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  strategy_id
        from raffle_activity
        where activity_id=? ::: [100401]
25-06-11.17:12:56.265 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Logic SQL: select
             
        strategy_id, award_id,award_title, award_subtitle,award_count, award_count_surplus, award_rate,sort,rule_models
     
        from strategy_award
        where strategy_id = ?
25-06-11.17:12:56.265 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:56.265 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select
             
        strategy_id, award_id,award_title, award_subtitle,award_count, award_count_surplus, award_rate,sort,rule_models
     
        from strategy_award
        where strategy_id = ? ::: [100006]
25-06-11.17:12:57.185 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Logic SQL: select strategy_id,award_id,rule_model,rule_type,rule_value,rule_desc
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:12:57.185 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:12:57.185 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select strategy_id,award_id,rule_model,rule_type,rule_value,rule_desc
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_weight]
25-06-11.17:12:57.589 [http-nio-8091-exec-41] INFO  RaffleActivityController - 活动装配，数据预热，完成 activityId:100401
25-06-11.17:13:01.794 [http-nio-8091-exec-40] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:01.840 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:01.840 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:01.840 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:01.840 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:01.840 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:01.841 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:01.841 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:01.841 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:01.841 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:01.841 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:02.252 [http-nio-8091-exec-40] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:02.252 [http-nio-8091-exec-40] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:02.252 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:02.252 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:02.252 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:02.381 [http-nio-8091-exec-40] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:02.394 [http-nio-8091-exec-42] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:02.432 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:02.432 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:02.432 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:02.432 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:02.432 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:02.432 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:02.432 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:02.432 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:02.432 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:02.432 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:02.459 [http-nio-8091-exec-40] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 104
25-06-11.17:13:02.460 [http-nio-8091-exec-40] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 104 rule_default
25-06-11.17:13:02.463 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:02.463 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:02.463 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 104]
25-06-11.17:13:02.582 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Logic SQL: select  * from  rule_tree
        where tree_id=?
25-06-11.17:13:02.582 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:02.582 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  * from  rule_tree
        where tree_id=? ::: [tree_luck_award]
25-06-11.17:13:02.682 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Logic SQL: select *
        from rule_tree_node
        where
            tree_id=?
25-06-11.17:13:02.682 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:02.682 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select *
        from rule_tree_node
        where
            tree_id=? ::: [tree_luck_award]
25-06-11.17:13:02.762 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Logic SQL: select * from rule_tree_node_line
        where tree_id=?
25-06-11.17:13:02.762 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:02.762 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select * from rule_tree_node_line
        where tree_id=? ::: [tree_luck_award]
25-06-11.17:13:02.770 [http-nio-8091-exec-42] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:02.770 [http-nio-8091-exec-42] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:02.771 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:02.771 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:02.771 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:02.908 [http-nio-8091-exec-42] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:02.914 [http-nio-8091-exec-40] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:104
25-06-11.17:13:02.980 [http-nio-8091-exec-42] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 106
25-06-11.17:13:02.980 [http-nio-8091-exec-42] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 rule_default
25-06-11.17:13:02.981 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:02.981 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:02.981 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 106]
25-06-11.17:13:02.984 [http-nio-8091-exec-40] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:104
25-06-11.17:13:02.994 [http-nio-8091-exec-43] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:03.030 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:03.030 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:03.030 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:03.030 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:03.030 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:03.030 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:03.030 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:03.030 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:03.030 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:03.030 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:03.088 [http-nio-8091-exec-40] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:03.090 [http-nio-8091-exec-40] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 104 null
25-06-11.17:13:03.125 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Logic SQL: select   
        strategy_id, award_id,award_title, award_subtitle,award_count, award_count_surplus, award_rate,sort,rule_models
     
        from strategy_award
        where strategy_id = ? and award_id = ?
25-06-11.17:13:03.125 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:03.125 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select   
        strategy_id, award_id,award_title, award_subtitle,award_count, award_count_surplus, award_rate,sort,rule_models
     
        from strategy_award
        where strategy_id = ? and award_id = ? ::: [100006, 104]
25-06-11.17:13:03.135 [http-nio-8091-exec-42] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:03.200 [http-nio-8091-exec-42] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:03.255 [http-nio-8091-exec-42] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:03.256 [http-nio-8091-exec-42] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 null
25-06-11.17:13:03.291 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - Logic SQL: select   
        strategy_id, award_id,award_title, award_subtitle,award_count, award_count_surplus, award_rate,sort,rule_models
     
        from strategy_award
        where strategy_id = ? and award_id = ?
25-06-11.17:13:03.291 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:03.291 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select   
        strategy_id, award_id,award_title, award_subtitle,award_count, award_count_surplus, award_rate,sort,rule_models
     
        from strategy_award
        where strategy_id = ? and award_id = ? ::: [100006, 106]
25-06-11.17:13:03.382 [http-nio-8091-exec-43] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:03.382 [http-nio-8091-exec-43] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:03.383 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:03.383 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:03.383 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:03.403 [http-nio-8091-exec-40] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 104 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 120 common frames omitted
25-06-11.17:13:03.451 [http-nio-8091-exec-42] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 104 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 120 common frames omitted
25-06-11.17:13:03.460 [http-nio-8091-exec-43] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:03.552 [http-nio-8091-exec-43] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 103
25-06-11.17:13:03.553 [http-nio-8091-exec-43] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 103 rule_default
25-06-11.17:13:03.553 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:03.553 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:03.553 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 103]
25-06-11.17:13:03.592 [http-nio-8091-exec-46] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:03.620 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:03.620 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:03.620 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:03.620 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:03.620 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:03.620 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:03.620 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:03.620 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:03.620 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:03.620 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:03.658 [http-nio-8091-exec-43] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:103
25-06-11.17:13:03.740 [http-nio-8091-exec-43] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:103
25-06-11.17:13:03.778 [http-nio-8091-exec-43] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:03.778 [http-nio-8091-exec-43] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 103 null
25-06-11.17:13:03.825 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Logic SQL: select   
        strategy_id, award_id,award_title, award_subtitle,award_count, award_count_surplus, award_rate,sort,rule_models
     
        from strategy_award
        where strategy_id = ? and award_id = ?
25-06-11.17:13:03.825 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:03.825 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select   
        strategy_id, award_id,award_title, award_subtitle,award_count, award_count_surplus, award_rate,sort,rule_models
     
        from strategy_award
        where strategy_id = ? and award_id = ? ::: [100006, 103]
25-06-11.17:13:03.992 [http-nio-8091-exec-46] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:03.993 [http-nio-8091-exec-46] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:03.993 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:03.993 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:03.993 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:04.005 [http-nio-8091-exec-43] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 104 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 120 common frames omitted
25-06-11.17:13:04.060 [http-nio-8091-exec-46] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:04.137 [http-nio-8091-exec-46] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 106
25-06-11.17:13:04.137 [http-nio-8091-exec-46] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 rule_default
25-06-11.17:13:04.138 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:04.138 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:04.138 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 106]
25-06-11.17:13:04.194 [http-nio-8091-exec-48] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:04.226 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:04.226 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:04.226 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:04.226 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:04.226 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:04.226 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:04.226 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:04.226 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:04.226 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:04.226 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:04.259 [http-nio-8091-exec-46] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:04.339 [http-nio-8091-exec-46] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:04.392 [http-nio-8091-exec-46] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:04.392 [http-nio-8091-exec-46] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 null
25-06-11.17:13:04.453 [http-nio-8091-exec-46] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 104 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 120 common frames omitted
25-06-11.17:13:04.586 [http-nio-8091-exec-48] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:04.586 [http-nio-8091-exec-48] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:04.586 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:04.586 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:04.587 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:04.671 [http-nio-8091-exec-48] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:04.741 [http-nio-8091-exec-48] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 106
25-06-11.17:13:04.741 [http-nio-8091-exec-48] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 rule_default
25-06-11.17:13:04.742 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:04.742 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:04.742 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 106]
25-06-11.17:13:04.792 [http-nio-8091-exec-50] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:04.831 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:04.831 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:04.831 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:04.831 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:04.832 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:04.832 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:04.832 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:04.832 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:04.832 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:04.832 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:04.835 [http-nio-8091-exec-48] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:04.918 [http-nio-8091-exec-48] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:04.969 [http-nio-8091-exec-48] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:04.969 [http-nio-8091-exec-48] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 null
25-06-11.17:13:05.019 [http-nio-8091-exec-48] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 104 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 120 common frames omitted
25-06-11.17:13:05.223 [http-nio-8091-exec-50] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:05.223 [http-nio-8091-exec-50] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:05.223 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:05.223 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:05.224 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:05.310 [http-nio-8091-exec-50] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:05.388 [http-nio-8091-exec-50] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 102
25-06-11.17:13:05.388 [http-nio-8091-exec-50] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 102 rule_default
25-06-11.17:13:05.389 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:05.389 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:05.389 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 102]
25-06-11.17:13:05.392 [http-nio-8091-exec-10] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:05.421 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:05.421 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:05.421 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:05.421 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:05.421 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:05.421 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:05.421 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:05.421 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:05.421 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:05.421 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:05.501 [http-nio-8091-exec-50] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:05.588 [http-nio-8091-exec-50] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:05.621 [http-nio-8091-exec-50] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:05.622 [http-nio-8091-exec-50] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 102 null
25-06-11.17:13:05.659 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - Logic SQL: select   
        strategy_id, award_id,award_title, award_subtitle,award_count, award_count_surplus, award_rate,sort,rule_models
     
        from strategy_award
        where strategy_id = ? and award_id = ?
25-06-11.17:13:05.659 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:05.660 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select   
        strategy_id, award_id,award_title, award_subtitle,award_count, award_count_surplus, award_rate,sort,rule_models
     
        from strategy_award
        where strategy_id = ? and award_id = ? ::: [100006, 102]
25-06-11.17:13:05.752 [http-nio-8091-exec-10] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:05.752 [http-nio-8091-exec-10] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:05.752 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:05.752 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:05.752 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:05.795 [http-nio-8091-exec-50] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 104 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 120 common frames omitted
25-06-11.17:13:05.841 [http-nio-8091-exec-10] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:05.920 [http-nio-8091-exec-10] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 102
25-06-11.17:13:05.920 [http-nio-8091-exec-10] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 102 rule_default
25-06-11.17:13:05.920 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:05.922 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:05.922 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 102]
25-06-11.17:13:05.992 [http-nio-8091-exec-7] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:06.040 [http-nio-8091-exec-10] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:06.040 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:06.040 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:06.042 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:06.042 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:06.042 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:06.042 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:06.042 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:06.042 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:06.042 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:06.042 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:06.125 [http-nio-8091-exec-10] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:06.169 [http-nio-8091-exec-10] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:06.169 [http-nio-8091-exec-10] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 102 null
25-06-11.17:13:06.223 [http-nio-8091-exec-10] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 104 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 120 common frames omitted
25-06-11.17:13:06.361 [http-nio-8091-exec-7] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:06.361 [http-nio-8091-exec-7] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:06.361 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:06.361 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:06.361 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:06.439 [http-nio-8091-exec-7] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:06.519 [http-nio-8091-exec-7] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 107
25-06-11.17:13:06.519 [http-nio-8091-exec-7] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 107 rule_default
25-06-11.17:13:06.520 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:06.520 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:06.520 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 107]
25-06-11.17:13:06.594 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:06.639 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Logic SQL: select  * from  rule_tree
        where tree_id=?
25-06-11.17:13:06.639 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:06.639 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:06.639 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  * from  rule_tree
        where tree_id=? ::: [tree_lock_1]
25-06-11.17:13:06.639 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:06.639 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:06.639 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:06.639 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:06.639 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:06.639 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:06.639 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:06.639 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:06.639 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:06.700 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Logic SQL: select *
        from rule_tree_node
        where
            tree_id=?
25-06-11.17:13:06.700 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:06.700 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select *
        from rule_tree_node
        where
            tree_id=? ::: [tree_lock_1]
25-06-11.17:13:06.781 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Logic SQL: select * from rule_tree_node_line
        where tree_id=?
25-06-11.17:13:06.781 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:06.781 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select * from rule_tree_node_line
        where tree_id=? ::: [tree_lock_1]
25-06-11.17:13:06.888 [http-nio-8091-exec-7] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:107
25-06-11.17:13:06.890 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Logic SQL: select  user_id, activity_id, total_count, total_count_surplus, day_count,
                day_count_surplus, month_count, month_count_surplus
        from raffle_activity_account
        where user_id = ?
25-06-11.17:13:06.890 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:06.890 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select  user_id, activity_id, total_count, total_count_surplus, day_count,
                day_count_surplus, month_count, month_count_surplus
        from raffle_activity_account
        where user_id = ? ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s]
25-06-11.17:13:06.890 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select  user_id, activity_id, total_count, total_count_surplus, day_count,
                day_count_surplus, month_count, month_count_surplus
        from raffle_activity_account
        where user_id = ? ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s]
25-06-11.17:13:07.002 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:07.002 [http-nio-8091-exec-1] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:07.003 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:07.003 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:07.003 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:07.079 [http-nio-8091-exec-7] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_lock code:0000
25-06-11.17:13:07.079 [http-nio-8091-exec-1] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:07.079 [http-nio-8091-exec-7] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:107
25-06-11.17:13:07.158 [http-nio-8091-exec-7] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:107
25-06-11.17:13:07.168 [http-nio-8091-exec-1] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 108
25-06-11.17:13:07.168 [http-nio-8091-exec-1] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 108 rule_default
25-06-11.17:13:07.169 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:07.169 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:07.169 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 108]
25-06-11.17:13:07.193 [http-nio-8091-exec-14] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:07.208 [http-nio-8091-exec-7] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_stock code:0000
25-06-11.17:13:07.208 [http-nio-8091-exec-7] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 107 null
25-06-11.17:13:07.240 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Logic SQL: select   
        strategy_id, award_id,award_title, award_subtitle,award_count, award_count_surplus, award_rate,sort,rule_models
     
        from strategy_award
        where strategy_id = ? and award_id = ?
25-06-11.17:13:07.240 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:07.240 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select   
        strategy_id, award_id,award_title, award_subtitle,award_count, award_count_surplus, award_rate,sort,rule_models
     
        from strategy_award
        where strategy_id = ? and award_id = ? ::: [100006, 107]
25-06-11.17:13:07.240 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:07.241 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:07.241 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:07.241 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:07.241 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:07.241 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:07.241 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:07.241 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:07.241 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:07.241 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:07.279 [http-nio-8091-exec-1] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:108
25-06-11.17:13:07.359 [http-nio-8091-exec-1] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:108
25-06-11.17:13:07.377 [http-nio-8091-exec-7] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 104 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 120 common frames omitted
25-06-11.17:13:07.408 [http-nio-8091-exec-1] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:07.408 [http-nio-8091-exec-1] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 108 null
25-06-11.17:13:07.439 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Logic SQL: select   
        strategy_id, award_id,award_title, award_subtitle,award_count, award_count_surplus, award_rate,sort,rule_models
     
        from strategy_award
        where strategy_id = ? and award_id = ?
25-06-11.17:13:07.439 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:07.439 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select   
        strategy_id, award_id,award_title, award_subtitle,award_count, award_count_surplus, award_rate,sort,rule_models
     
        from strategy_award
        where strategy_id = ? and award_id = ? ::: [100006, 108]
25-06-11.17:13:07.561 [http-nio-8091-exec-14] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:07.561 [http-nio-8091-exec-14] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:07.562 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:07.562 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:07.562 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:07.581 [http-nio-8091-exec-1] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 104 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 120 common frames omitted
25-06-11.17:13:07.648 [http-nio-8091-exec-14] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:07.727 [http-nio-8091-exec-14] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 108
25-06-11.17:13:07.727 [http-nio-8091-exec-14] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 108 rule_default
25-06-11.17:13:07.729 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:07.729 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:07.729 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 108]
25-06-11.17:13:07.793 [http-nio-8091-exec-11] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:07.820 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:07.820 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:07.820 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:07.820 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:07.820 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:07.820 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:07.820 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:07.820 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:07.820 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:07.820 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:07.841 [http-nio-8091-exec-14] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:108
25-06-11.17:13:07.907 [http-nio-8091-exec-14] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:108
25-06-11.17:13:07.950 [http-nio-8091-exec-14] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:07.950 [http-nio-8091-exec-14] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 108 null
25-06-11.17:13:07.993 [http-nio-8091-exec-14] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 104 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 120 common frames omitted
25-06-11.17:13:08.149 [http-nio-8091-exec-11] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:08.149 [http-nio-8091-exec-11] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:08.150 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:08.150 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:08.150 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:08.229 [http-nio-8091-exec-11] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:08.308 [http-nio-8091-exec-11] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 101
25-06-11.17:13:08.308 [http-nio-8091-exec-11] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 101 rule_default
25-06-11.17:13:08.309 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:08.309 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:08.309 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 101]
25-06-11.17:13:08.393 [http-nio-8091-exec-8] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:08.429 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:08.429 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:08.429 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:08.429 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:08.429 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:08.429 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:08.429 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:08.429 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:08.429 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:08.429 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:08.459 [http-nio-8091-exec-11] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:101
25-06-11.17:13:08.541 [http-nio-8091-exec-11] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:101
25-06-11.17:13:08.587 [http-nio-8091-exec-11] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:08.587 [http-nio-8091-exec-11] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 101 null
25-06-11.17:13:08.622 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - Logic SQL: select   
        strategy_id, award_id,award_title, award_subtitle,award_count, award_count_surplus, award_rate,sort,rule_models
     
        from strategy_award
        where strategy_id = ? and award_id = ?
25-06-11.17:13:08.622 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:08.622 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select   
        strategy_id, award_id,award_title, award_subtitle,award_count, award_count_surplus, award_rate,sort,rule_models
     
        from strategy_award
        where strategy_id = ? and award_id = ? ::: [100006, 101]
25-06-11.17:13:08.751 [http-nio-8091-exec-8] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:08.751 [http-nio-8091-exec-8] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:08.752 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:08.752 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:08.752 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:08.762 [http-nio-8091-exec-11] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 104 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 120 common frames omitted
25-06-11.17:13:08.850 [http-nio-8091-exec-8] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:08.927 [http-nio-8091-exec-8] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 107
25-06-11.17:13:08.928 [http-nio-8091-exec-8] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 107 rule_default
25-06-11.17:13:08.928 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:08.928 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:08.928 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 107]
25-06-11.17:13:08.994 [http-nio-8091-exec-6] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:09.040 [http-nio-8091-exec-8] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:107
25-06-11.17:13:09.041 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Logic SQL: select  user_id, activity_id, total_count, total_count_surplus, day_count,
                day_count_surplus, month_count, month_count_surplus
        from raffle_activity_account
        where user_id = ?
25-06-11.17:13:09.041 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:09.041 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:09.041 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select  user_id, activity_id, total_count, total_count_surplus, day_count,
                day_count_surplus, month_count, month_count_surplus
        from raffle_activity_account
        where user_id = ? ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s]
25-06-11.17:13:09.041 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select  user_id, activity_id, total_count, total_count_surplus, day_count,
                day_count_surplus, month_count, month_count_surplus
        from raffle_activity_account
        where user_id = ? ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s]
25-06-11.17:13:09.041 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:09.041 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:09.041 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:09.041 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:09.041 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:09.041 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:09.041 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:09.041 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:09.041 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:09.202 [http-nio-8091-exec-8] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_lock code:0000
25-06-11.17:13:09.202 [http-nio-8091-exec-8] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:107
25-06-11.17:13:09.279 [http-nio-8091-exec-8] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:107
25-06-11.17:13:09.335 [http-nio-8091-exec-8] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_stock code:0000
25-06-11.17:13:09.335 [http-nio-8091-exec-8] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 107 null
25-06-11.17:13:09.384 [http-nio-8091-exec-8] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 104 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 120 common frames omitted
25-06-11.17:13:09.404 [http-nio-8091-exec-6] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:09.404 [http-nio-8091-exec-6] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:09.405 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:09.405 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:09.405 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:09.489 [http-nio-8091-exec-6] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:09.560 [http-nio-8091-exec-6] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 103
25-06-11.17:13:09.560 [http-nio-8091-exec-6] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 103 rule_default
25-06-11.17:13:09.560 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:09.560 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:09.560 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 103]
25-06-11.17:13:09.592 [http-nio-8091-exec-24] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:09.641 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:09.642 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:09.642 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:09.642 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:09.642 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:09.642 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:09.642 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:09.642 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:09.642 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:09.642 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:09.693 [http-nio-8091-exec-6] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:103
25-06-11.17:13:09.765 [http-nio-8091-exec-6] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:103
25-06-11.17:13:09.813 [http-nio-8091-exec-6] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:09.813 [http-nio-8091-exec-6] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 103 null
25-06-11.17:13:09.853 [http-nio-8091-exec-6] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 104 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 120 common frames omitted
25-06-11.17:13:09.972 [http-nio-8091-exec-24] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:09.972 [http-nio-8091-exec-24] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:09.973 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:09.973 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:09.973 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:10.071 [http-nio-8091-exec-24] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:10.143 [http-nio-8091-exec-24] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 104
25-06-11.17:13:10.143 [http-nio-8091-exec-24] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 104 rule_default
25-06-11.17:13:10.144 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:10.144 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:10.144 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 104]
25-06-11.17:13:10.195 [http-nio-8091-exec-18] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:10.223 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:10.223 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:10.223 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:10.223 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:10.223 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:10.223 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:10.223 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:10.224 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:10.224 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:10.224 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:10.266 [http-nio-8091-exec-24] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:104
25-06-11.17:13:10.361 [http-nio-8091-exec-24] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:104
25-06-11.17:13:10.413 [http-nio-8091-exec-24] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:10.413 [http-nio-8091-exec-24] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 104 null
25-06-11.17:13:10.451 [http-nio-8091-exec-24] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 104 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 120 common frames omitted
25-06-11.17:13:10.567 [http-nio-8091-exec-18] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:10.567 [http-nio-8091-exec-18] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:10.567 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:10.567 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:10.567 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:10.651 [http-nio-8091-exec-18] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:10.719 [http-nio-8091-exec-18] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 106
25-06-11.17:13:10.719 [http-nio-8091-exec-18] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 rule_default
25-06-11.17:13:10.721 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:10.721 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:10.721 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 106]
25-06-11.17:13:10.799 [http-nio-8091-exec-21] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:10.842 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:10.842 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:10.842 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:10.842 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:10.842 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:10.842 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:10.842 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:10.842 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:10.842 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:10.842 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:10.857 [http-nio-8091-exec-18] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:10.949 [http-nio-8091-exec-18] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:10.991 [http-nio-8091-exec-18] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:10.991 [http-nio-8091-exec-18] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 null
25-06-11.17:13:11.052 [http-nio-8091-exec-18] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 104 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 120 common frames omitted
25-06-11.17:13:11.174 [http-nio-8091-exec-21] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:11.174 [http-nio-8091-exec-21] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:11.175 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:11.175 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:11.175 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:11.269 [http-nio-8091-exec-21] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:11.343 [http-nio-8091-exec-21] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 101
25-06-11.17:13:11.343 [http-nio-8091-exec-21] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 101 rule_default
25-06-11.17:13:11.344 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:11.344 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:11.344 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 101]
25-06-11.17:13:11.402 [http-nio-8091-exec-22] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:11.441 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:11.441 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:11.441 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:11.441 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:11.441 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:11.441 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:11.441 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:11.441 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:11.441 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:11.441 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:11.462 [http-nio-8091-exec-21] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:101
25-06-11.17:13:11.541 [http-nio-8091-exec-21] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:101
25-06-11.17:13:11.595 [http-nio-8091-exec-21] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:11.595 [http-nio-8091-exec-21] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 101 null
25-06-11.17:13:11.656 [http-nio-8091-exec-21] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 104 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 120 common frames omitted
25-06-11.17:13:11.766 [http-nio-8091-exec-22] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:11.767 [http-nio-8091-exec-22] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:11.767 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:11.767 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:11.767 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:11.855 [http-nio-8091-exec-22] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:11.922 [http-nio-8091-exec-22] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 101
25-06-11.17:13:11.922 [http-nio-8091-exec-22] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 101 rule_default
25-06-11.17:13:11.923 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:11.923 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:11.923 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 101]
25-06-11.17:13:12.007 [http-nio-8091-exec-25] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:12.041 [http-nio-8091-exec-22] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:101
25-06-11.17:13:12.053 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:12.053 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:12.053 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:12.053 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:12.053 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:12.053 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:12.053 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:12.053 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:12.053 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:12.053 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:12.131 [http-nio-8091-exec-22] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:101
25-06-11.17:13:12.172 [http-nio-8091-exec-22] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:12.172 [http-nio-8091-exec-22] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 101 null
25-06-11.17:13:12.224 [http-nio-8091-exec-22] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:12.374 [http-nio-8091-exec-25] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:12.374 [http-nio-8091-exec-25] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:12.375 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:12.375 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:12.375 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:12.443 [http-nio-8091-exec-25] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:12.531 [http-nio-8091-exec-25] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 102
25-06-11.17:13:12.531 [http-nio-8091-exec-25] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 102 rule_default
25-06-11.17:13:12.532 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:12.532 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:12.532 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 102]
25-06-11.17:13:12.599 [http-nio-8091-exec-26] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:12.643 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:12.643 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:12.643 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:12.643 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:12.643 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:12.643 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:12.643 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:12.643 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:12.643 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:12.643 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:12.653 [http-nio-8091-exec-25] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:12.723 [http-nio-8091-exec-25] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:12.771 [http-nio-8091-exec-25] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:12.771 [http-nio-8091-exec-25] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 102 null
25-06-11.17:13:12.815 [http-nio-8091-exec-25] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:13.007 [http-nio-8091-exec-26] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:13.007 [http-nio-8091-exec-26] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:13.007 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:13.007 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:13.007 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:13.081 [http-nio-8091-exec-26] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:13.170 [http-nio-8091-exec-26] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 104
25-06-11.17:13:13.170 [http-nio-8091-exec-26] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 104 rule_default
25-06-11.17:13:13.171 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:13.171 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:13.171 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 104]
25-06-11.17:13:13.204 [http-nio-8091-exec-28] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:13.241 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:13.241 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:13.241 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:13.241 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:13.241 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:13.241 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:13.241 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:13.241 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:13.241 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:13.241 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:13.293 [http-nio-8091-exec-26] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:104
25-06-11.17:13:13.358 [http-nio-8091-exec-26] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:104
25-06-11.17:13:13.410 [http-nio-8091-exec-26] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:13.410 [http-nio-8091-exec-26] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 104 null
25-06-11.17:13:13.456 [http-nio-8091-exec-26] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:13.566 [http-nio-8091-exec-28] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:13.566 [http-nio-8091-exec-28] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:13.567 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:13.567 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:13.567 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:13.655 [http-nio-8091-exec-28] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:13.750 [http-nio-8091-exec-28] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 104
25-06-11.17:13:13.750 [http-nio-8091-exec-28] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 104 rule_default
25-06-11.17:13:13.751 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:13.751 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:13.751 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 104]
25-06-11.17:13:13.806 [http-nio-8091-exec-36] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:13.841 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:13.841 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:13.841 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:13.841 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:13.841 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:13.841 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:13.841 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:13.841 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:13.841 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:13.841 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:13.880 [http-nio-8091-exec-28] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:104
25-06-11.17:13:13.962 [http-nio-8091-exec-28] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:104
25-06-11.17:13:14.008 [http-nio-8091-exec-28] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:14.008 [http-nio-8091-exec-28] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 104 null
25-06-11.17:13:14.061 [http-nio-8091-exec-28] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:14.171 [http-nio-8091-exec-36] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:14.171 [http-nio-8091-exec-36] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:14.172 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:14.172 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:14.172 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:14.261 [http-nio-8091-exec-36] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:14.340 [http-nio-8091-exec-36] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 106
25-06-11.17:13:14.340 [http-nio-8091-exec-36] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 rule_default
25-06-11.17:13:14.341 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:14.341 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:14.341 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 106]
25-06-11.17:13:14.397 [http-nio-8091-exec-27] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:14.441 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:14.441 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:14.441 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:14.441 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:14.441 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:14.441 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:14.441 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:14.441 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:14.441 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:14.441 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:14.462 [http-nio-8091-exec-36] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:14.547 [http-nio-8091-exec-36] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:14.590 [http-nio-8091-exec-36] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:14.590 [http-nio-8091-exec-36] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 null
25-06-11.17:13:14.631 [http-nio-8091-exec-36] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:14.767 [http-nio-8091-exec-27] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:14.767 [http-nio-8091-exec-27] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:14.767 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:14.768 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:14.768 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:14.848 [http-nio-8091-exec-27] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:14.931 [http-nio-8091-exec-27] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 103
25-06-11.17:13:14.931 [http-nio-8091-exec-27] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 103 rule_default
25-06-11.17:13:14.931 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:14.931 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:14.931 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 103]
25-06-11.17:13:14.994 [http-nio-8091-exec-35] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:15.040 [http-nio-8091-exec-27] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:103
25-06-11.17:13:15.041 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:15.041 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:15.041 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:15.041 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:15.041 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:15.041 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:15.041 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:15.041 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:15.041 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:15.041 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:15.118 [http-nio-8091-exec-27] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:103
25-06-11.17:13:15.167 [http-nio-8091-exec-27] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:15.167 [http-nio-8091-exec-27] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 103 null
25-06-11.17:13:15.216 [http-nio-8091-exec-27] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:15.343 [http-nio-8091-exec-35] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:15.343 [http-nio-8091-exec-35] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:15.343 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:15.343 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:15.343 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:15.471 [http-nio-8091-exec-35] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:15.549 [http-nio-8091-exec-35] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 104
25-06-11.17:13:15.549 [http-nio-8091-exec-35] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 104 rule_default
25-06-11.17:13:15.550 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:15.550 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:15.550 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 104]
25-06-11.17:13:15.592 [http-nio-8091-exec-30] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:15.629 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:15.629 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:15.629 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:15.629 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:15.629 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:15.629 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:15.629 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:15.629 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:15.629 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:15.629 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:15.659 [http-nio-8091-exec-35] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:104
25-06-11.17:13:15.750 [http-nio-8091-exec-35] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:104
25-06-11.17:13:15.787 [http-nio-8091-exec-35] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:15.787 [http-nio-8091-exec-35] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 104 null
25-06-11.17:13:15.834 [http-nio-8091-exec-35] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:15.991 [http-nio-8091-exec-30] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:15.991 [http-nio-8091-exec-30] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:15.992 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:15.992 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:15.992 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:16.110 [http-nio-8091-exec-30] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:16.188 [http-nio-8091-exec-30] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 106
25-06-11.17:13:16.188 [http-nio-8091-exec-30] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 rule_default
25-06-11.17:13:16.189 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:16.189 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:16.189 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 106]
25-06-11.17:13:16.196 [http-nio-8091-exec-39] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:16.220 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:16.222 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:16.222 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:16.222 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:16.222 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:16.222 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:16.222 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:16.222 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:16.222 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:16.222 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:16.301 [http-nio-8091-exec-30] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:16.380 [http-nio-8091-exec-30] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:16.422 [http-nio-8091-exec-30] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:16.422 [http-nio-8091-exec-30] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 null
25-06-11.17:13:16.476 [http-nio-8091-exec-30] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:16.573 [http-nio-8091-exec-39] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:16.573 [http-nio-8091-exec-39] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:16.574 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:16.574 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:16.574 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:16.680 [http-nio-8091-exec-39] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:16.769 [http-nio-8091-exec-39] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 102
25-06-11.17:13:16.769 [http-nio-8091-exec-39] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 102 rule_default
25-06-11.17:13:16.769 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:16.769 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:16.769 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 102]
25-06-11.17:13:16.800 [http-nio-8091-exec-41] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:16.851 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:16.851 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:16.851 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:16.851 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:16.851 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:16.851 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:16.851 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:16.851 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:16.851 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:16.851 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:16.880 [http-nio-8091-exec-39] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:16.963 [http-nio-8091-exec-39] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:17.012 [http-nio-8091-exec-39] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:17.012 [http-nio-8091-exec-39] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 102 null
25-06-11.17:13:17.053 [http-nio-8091-exec-39] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:17.166 [http-nio-8091-exec-41] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:17.166 [http-nio-8091-exec-41] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:17.166 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:17.166 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:17.166 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:17.251 [http-nio-8091-exec-41] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:17.363 [http-nio-8091-exec-41] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 105
25-06-11.17:13:17.363 [http-nio-8091-exec-41] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 rule_default
25-06-11.17:13:17.363 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:17.363 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:17.363 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 105]
25-06-11.17:13:17.404 [http-nio-8091-exec-44] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:17.449 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:17.449 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:17.451 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:17.451 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:17.451 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:17.451 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:17.451 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:17.451 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:17.451 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:17.451 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:17.484 [http-nio-8091-exec-41] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:17.559 [http-nio-8091-exec-41] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:17.613 [http-nio-8091-exec-41] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:17.613 [http-nio-8091-exec-41] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 null
25-06-11.17:13:17.645 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Logic SQL: select   
        strategy_id, award_id,award_title, award_subtitle,award_count, award_count_surplus, award_rate,sort,rule_models
     
        from strategy_award
        where strategy_id = ? and award_id = ?
25-06-11.17:13:17.645 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:17.645 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select   
        strategy_id, award_id,award_title, award_subtitle,award_count, award_count_surplus, award_rate,sort,rule_models
     
        from strategy_award
        where strategy_id = ? and award_id = ? ::: [100006, 105]
25-06-11.17:13:17.783 [http-nio-8091-exec-44] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:17.783 [http-nio-8091-exec-44] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:17.784 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:17.784 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:17.784 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:17.803 [http-nio-8091-exec-41] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:17.870 [http-nio-8091-exec-44] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:17.939 [http-nio-8091-exec-44] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 107
25-06-11.17:13:17.939 [http-nio-8091-exec-44] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 107 rule_default
25-06-11.17:13:17.940 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:17.940 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:17.940 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 107]
25-06-11.17:13:18.004 [http-nio-8091-exec-45] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:18.037 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:18.037 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:18.037 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:18.037 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:18.037 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:18.037 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:18.037 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:18.037 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:18.037 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:18.037 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:18.124 [http-nio-8091-exec-44] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:107
25-06-11.17:13:18.124 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Logic SQL: select  user_id, activity_id, total_count, total_count_surplus, day_count,
                day_count_surplus, month_count, month_count_surplus
        from raffle_activity_account
        where user_id = ?
25-06-11.17:13:18.124 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:18.124 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select  user_id, activity_id, total_count, total_count_surplus, day_count,
                day_count_surplus, month_count, month_count_surplus
        from raffle_activity_account
        where user_id = ? ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s]
25-06-11.17:13:18.124 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select  user_id, activity_id, total_count, total_count_surplus, day_count,
                day_count_surplus, month_count, month_count_surplus
        from raffle_activity_account
        where user_id = ? ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s]
25-06-11.17:13:18.280 [http-nio-8091-exec-44] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_lock code:0000
25-06-11.17:13:18.280 [http-nio-8091-exec-44] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:107
25-06-11.17:13:18.360 [http-nio-8091-exec-44] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:107
25-06-11.17:13:18.409 [http-nio-8091-exec-44] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_stock code:0000
25-06-11.17:13:18.409 [http-nio-8091-exec-44] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 107 null
25-06-11.17:13:18.412 [http-nio-8091-exec-45] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:18.412 [http-nio-8091-exec-45] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:18.412 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:18.412 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:18.412 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:18.455 [http-nio-8091-exec-44] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:18.520 [http-nio-8091-exec-45] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:18.599 [http-nio-8091-exec-45] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 104
25-06-11.17:13:18.599 [http-nio-8091-exec-45] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 104 rule_default
25-06-11.17:13:18.601 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:18.601 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:18.601 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 104]
25-06-11.17:13:18.606 [http-nio-8091-exec-47] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:18.651 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:18.651 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:18.651 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:18.651 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:18.651 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:18.651 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:18.651 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:18.651 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:18.651 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:18.651 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:18.728 [http-nio-8091-exec-45] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:104
25-06-11.17:13:18.808 [http-nio-8091-exec-45] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:104
25-06-11.17:13:18.848 [http-nio-8091-exec-45] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:18.848 [http-nio-8091-exec-45] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 104 null
25-06-11.17:13:18.895 [http-nio-8091-exec-45] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:18.969 [http-nio-8091-exec-47] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:18.969 [http-nio-8091-exec-47] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:18.970 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:18.970 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:18.970 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:19.048 [http-nio-8091-exec-47] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:19.122 [http-nio-8091-exec-47] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 102
25-06-11.17:13:19.122 [http-nio-8091-exec-47] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 102 rule_default
25-06-11.17:13:19.122 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:19.122 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:19.122 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 102]
25-06-11.17:13:19.196 [http-nio-8091-exec-49] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:19.241 [http-nio-8091-exec-47] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:19.241 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:19.242 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:19.242 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:19.242 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:19.242 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:19.242 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:19.242 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:19.242 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:19.242 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:19.242 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:19.320 [http-nio-8091-exec-47] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:19.367 [http-nio-8091-exec-47] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:19.367 [http-nio-8091-exec-47] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 102 null
25-06-11.17:13:19.414 [http-nio-8091-exec-47] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:19.572 [http-nio-8091-exec-49] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:19.572 [http-nio-8091-exec-49] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:19.573 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:19.573 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:19.573 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:19.660 [http-nio-8091-exec-49] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:19.747 [http-nio-8091-exec-49] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 102
25-06-11.17:13:19.747 [http-nio-8091-exec-49] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 102 rule_default
25-06-11.17:13:19.747 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:19.747 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:19.747 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 102]
25-06-11.17:13:19.797 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:19.841 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:19.841 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:19.841 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:19.841 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:19.841 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:19.841 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:19.841 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:19.841 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:19.841 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:19.841 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:19.867 [http-nio-8091-exec-49] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:19.961 [http-nio-8091-exec-49] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:20.009 [http-nio-8091-exec-49] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:20.009 [http-nio-8091-exec-49] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 102 null
25-06-11.17:13:20.051 [http-nio-8091-exec-49] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:20.166 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:20.166 [http-nio-8091-exec-2] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:20.166 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:20.166 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:20.166 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:20.241 [http-nio-8091-exec-2] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:20.317 [http-nio-8091-exec-2] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 104
25-06-11.17:13:20.317 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 104 rule_default
25-06-11.17:13:20.317 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:20.317 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:20.317 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 104]
25-06-11.17:13:20.401 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:20.440 [http-nio-8091-exec-2] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:104
25-06-11.17:13:20.441 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:20.441 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:20.441 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:20.441 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:20.441 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:20.441 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:20.441 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:20.441 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:20.441 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:20.441 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:20.519 [http-nio-8091-exec-2] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:104
25-06-11.17:13:20.569 [http-nio-8091-exec-2] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:20.569 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 104 null
25-06-11.17:13:20.613 [http-nio-8091-exec-2] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:20.771 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:20.771 [http-nio-8091-exec-3] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:20.772 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:20.772 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:20.772 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:20.840 [http-nio-8091-exec-3] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:20.929 [http-nio-8091-exec-3] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 105
25-06-11.17:13:20.929 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 rule_default
25-06-11.17:13:20.929 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:20.929 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:20.929 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 105]
25-06-11.17:13:21.008 [http-nio-8091-exec-4] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:21.039 [http-nio-8091-exec-3] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:21.039 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:21.039 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:21.039 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:21.039 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:21.040 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:21.040 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:21.040 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:21.040 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:21.040 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:21.040 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:21.120 [http-nio-8091-exec-3] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:21.172 [http-nio-8091-exec-3] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:21.172 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 null
25-06-11.17:13:21.213 [http-nio-8091-exec-3] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:21.410 [http-nio-8091-exec-4] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:21.410 [http-nio-8091-exec-4] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:21.411 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:21.411 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:21.411 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:21.481 [http-nio-8091-exec-4] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:21.559 [http-nio-8091-exec-4] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 105
25-06-11.17:13:21.559 [http-nio-8091-exec-4] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 rule_default
25-06-11.17:13:21.559 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:21.559 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:21.559 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 105]
25-06-11.17:13:21.594 [http-nio-8091-exec-13] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:21.621 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:21.621 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:21.621 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:21.621 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:21.621 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:21.621 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:21.621 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:21.621 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:21.621 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:21.621 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:21.687 [http-nio-8091-exec-4] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:21.760 [http-nio-8091-exec-4] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:21.808 [http-nio-8091-exec-4] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:21.808 [http-nio-8091-exec-4] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 null
25-06-11.17:13:21.854 [http-nio-8091-exec-4] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:21.970 [http-nio-8091-exec-13] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:21.970 [http-nio-8091-exec-13] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:21.970 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:21.970 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:21.970 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:22.042 [http-nio-8091-exec-13] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:22.136 [http-nio-8091-exec-13] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 105
25-06-11.17:13:22.136 [http-nio-8091-exec-13] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 rule_default
25-06-11.17:13:22.137 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:22.137 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:22.137 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 105]
25-06-11.17:13:22.197 [http-nio-8091-exec-15] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:22.237 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:22.237 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:22.237 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:22.237 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:22.237 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:22.237 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:22.237 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:22.237 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:22.237 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:22.237 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:22.260 [http-nio-8091-exec-13] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:22.329 [http-nio-8091-exec-13] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:22.369 [http-nio-8091-exec-13] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:22.369 [http-nio-8091-exec-13] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 null
25-06-11.17:13:22.414 [http-nio-8091-exec-13] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:22.581 [http-nio-8091-exec-15] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:22.581 [http-nio-8091-exec-15] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:22.582 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:22.582 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:22.582 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:22.669 [http-nio-8091-exec-15] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:22.739 [http-nio-8091-exec-15] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 102
25-06-11.17:13:22.739 [http-nio-8091-exec-15] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 102 rule_default
25-06-11.17:13:22.740 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:22.740 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:22.740 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 102]
25-06-11.17:13:22.797 [http-nio-8091-exec-5] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:22.840 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:22.840 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:22.840 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:22.840 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:22.840 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:22.840 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:22.840 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:22.840 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:22.840 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:22.840 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:22.860 [http-nio-8091-exec-15] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:22.942 [http-nio-8091-exec-15] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:22.984 [http-nio-8091-exec-15] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:22.984 [http-nio-8091-exec-15] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 102 null
25-06-11.17:13:23.034 [http-nio-8091-exec-15] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:23.251 [http-nio-8091-exec-5] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:23.251 [http-nio-8091-exec-5] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:23.252 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:23.252 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:23.252 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:23.362 [http-nio-8091-exec-5] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:23.395 [http-nio-8091-exec-12] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:23.441 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:23.441 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:23.441 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:23.441 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:23.441 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:23.441 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:23.441 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:23.441 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:23.441 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:23.441 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:23.449 [http-nio-8091-exec-5] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 106
25-06-11.17:13:23.449 [http-nio-8091-exec-5] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 rule_default
25-06-11.17:13:23.449 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:23.450 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:23.450 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 106]
25-06-11.17:13:23.569 [http-nio-8091-exec-5] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:23.641 [http-nio-8091-exec-5] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:23.679 [http-nio-8091-exec-5] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:23.679 [http-nio-8091-exec-5] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 null
25-06-11.17:13:23.740 [http-nio-8091-exec-5] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:23.851 [http-nio-8091-exec-12] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:23.851 [http-nio-8091-exec-12] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:23.853 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:23.853 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:23.853 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:23.960 [http-nio-8091-exec-12] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:24.000 [http-nio-8091-exec-9] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:24.040 [http-nio-8091-exec-12] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 108
25-06-11.17:13:24.040 [http-nio-8091-exec-12] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 108 rule_default
25-06-11.17:13:24.040 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:24.040 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:24.040 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 108]
25-06-11.17:13:24.053 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:24.053 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:24.053 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:24.053 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:24.053 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:24.053 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:24.053 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:24.053 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:24.053 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:24.053 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:24.179 [http-nio-8091-exec-12] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:108
25-06-11.17:13:24.252 [http-nio-8091-exec-12] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:108
25-06-11.17:13:24.310 [http-nio-8091-exec-12] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:24.310 [http-nio-8091-exec-12] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 108 null
25-06-11.17:13:24.358 [http-nio-8091-exec-12] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:24.451 [http-nio-8091-exec-9] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:24.451 [http-nio-8091-exec-9] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:24.452 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:24.452 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:24.452 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:24.546 [http-nio-8091-exec-9] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:24.604 [http-nio-8091-exec-16] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:24.624 [http-nio-8091-exec-9] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 103
25-06-11.17:13:24.624 [http-nio-8091-exec-9] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 103 rule_default
25-06-11.17:13:24.624 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:24.624 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:24.624 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 103]
25-06-11.17:13:24.639 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:24.639 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:24.639 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:24.639 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:24.639 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:24.639 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:24.639 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:24.639 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:24.639 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:24.639 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:24.741 [http-nio-8091-exec-9] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:103
25-06-11.17:13:24.819 [http-nio-8091-exec-9] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:103
25-06-11.17:13:24.872 [http-nio-8091-exec-9] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:24.872 [http-nio-8091-exec-9] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 103 null
25-06-11.17:13:24.912 [http-nio-8091-exec-9] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:24.991 [http-nio-8091-exec-16] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:24.991 [http-nio-8091-exec-16] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:24.992 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:24.992 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:24.992 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:25.077 [http-nio-8091-exec-16] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:25.141 [http-nio-8091-exec-16] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 103
25-06-11.17:13:25.141 [http-nio-8091-exec-16] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 103 rule_default
25-06-11.17:13:25.143 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:25.143 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:25.143 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 103]
25-06-11.17:13:25.208 [http-nio-8091-exec-19] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:25.253 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:25.253 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:25.253 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:25.253 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:25.253 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:25.253 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:25.253 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:25.253 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:25.253 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:25.253 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:25.263 [http-nio-8091-exec-16] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:103
25-06-11.17:13:25.344 [http-nio-8091-exec-16] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:103
25-06-11.17:13:25.389 [http-nio-8091-exec-16] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:25.389 [http-nio-8091-exec-16] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 103 null
25-06-11.17:13:25.437 [http-nio-8091-exec-16] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:25.592 [http-nio-8091-exec-19] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:25.592 [http-nio-8091-exec-19] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:25.593 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:25.593 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:25.593 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:25.710 [http-nio-8091-exec-19] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:25.780 [http-nio-8091-exec-19] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 106
25-06-11.17:13:25.780 [http-nio-8091-exec-19] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 rule_default
25-06-11.17:13:25.781 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:25.781 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:25.781 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 106]
25-06-11.17:13:25.797 [http-nio-8091-exec-20] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:25.872 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:25.872 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:25.872 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:25.872 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:25.872 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:25.872 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:25.872 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:25.872 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:25.872 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:25.872 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:25.984 [http-nio-8091-exec-19] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:26.072 [http-nio-8091-exec-19] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:26.132 [http-nio-8091-exec-19] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:26.132 [http-nio-8091-exec-19] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 null
25-06-11.17:13:26.192 [http-nio-8091-exec-19] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:26.259 [http-nio-8091-exec-20] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:26.259 [http-nio-8091-exec-20] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:26.260 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:26.260 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:26.260 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:26.385 [http-nio-8091-exec-20] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:26.404 [http-nio-8091-exec-23] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:26.443 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:26.443 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:26.443 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:26.443 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:26.443 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:26.443 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:26.443 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:26.443 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:26.443 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:26.443 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:26.465 [http-nio-8091-exec-20] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 101
25-06-11.17:13:26.466 [http-nio-8091-exec-20] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 101 rule_default
25-06-11.17:13:26.466 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:26.466 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:26.466 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 101]
25-06-11.17:13:26.595 [http-nio-8091-exec-20] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:101
25-06-11.17:13:26.670 [http-nio-8091-exec-20] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:101
25-06-11.17:13:26.719 [http-nio-8091-exec-20] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:26.719 [http-nio-8091-exec-20] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 101 null
25-06-11.17:13:26.774 [http-nio-8091-exec-20] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:26.806 [http-nio-8091-exec-23] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:26.806 [http-nio-8091-exec-23] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:26.807 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:26.807 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:26.807 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:26.900 [http-nio-8091-exec-23] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:26.994 [http-nio-8091-exec-17] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:27.024 [http-nio-8091-exec-23] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 104
25-06-11.17:13:27.024 [http-nio-8091-exec-23] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 104 rule_default
25-06-11.17:13:27.024 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:27.024 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:27.024 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 104]
25-06-11.17:13:27.030 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:27.030 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:27.030 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:27.030 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:27.030 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:27.030 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:27.030 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:27.030 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:27.030 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:27.030 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:27.142 [http-nio-8091-exec-23] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:104
25-06-11.17:13:27.221 [http-nio-8091-exec-23] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:104
25-06-11.17:13:27.265 [http-nio-8091-exec-23] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:27.265 [http-nio-8091-exec-23] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 104 null
25-06-11.17:13:27.312 [http-nio-8091-exec-23] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:27.353 [http-nio-8091-exec-17] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:27.353 [http-nio-8091-exec-17] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:27.354 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:27.354 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:27.354 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:27.431 [http-nio-8091-exec-17] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:27.533 [http-nio-8091-exec-17] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 102
25-06-11.17:13:27.533 [http-nio-8091-exec-17] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 102 rule_default
25-06-11.17:13:27.533 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:27.533 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:27.533 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 102]
25-06-11.17:13:27.594 [http-nio-8091-exec-33] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:27.620 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:27.620 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:27.620 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:27.620 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:27.620 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:27.620 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:27.620 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:27.620 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:27.620 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:27.620 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:27.639 [http-nio-8091-exec-17] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:27.725 [http-nio-8091-exec-17] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:27.771 [http-nio-8091-exec-17] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:27.771 [http-nio-8091-exec-17] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 102 null
25-06-11.17:13:27.812 [http-nio-8091-exec-17] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:27.966 [http-nio-8091-exec-33] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:27.966 [http-nio-8091-exec-33] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:27.967 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:27.967 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:27.967 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:28.049 [http-nio-8091-exec-33] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:28.121 [http-nio-8091-exec-33] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 102
25-06-11.17:13:28.121 [http-nio-8091-exec-33] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 102 rule_default
25-06-11.17:13:28.122 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:28.122 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:28.122 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 102]
25-06-11.17:13:28.196 [http-nio-8091-exec-29] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:28.244 [http-nio-8091-exec-33] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:28.245 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:28.245 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:28.245 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:28.245 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:28.245 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:28.245 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:28.245 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:28.245 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:28.245 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:28.245 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:28.321 [http-nio-8091-exec-33] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:28.361 [http-nio-8091-exec-33] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:28.361 [http-nio-8091-exec-33] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 102 null
25-06-11.17:13:28.426 [http-nio-8091-exec-33] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:28.570 [http-nio-8091-exec-29] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:28.570 [http-nio-8091-exec-29] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:28.570 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:28.570 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:28.570 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:28.651 [http-nio-8091-exec-29] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:28.742 [http-nio-8091-exec-29] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 104
25-06-11.17:13:28.742 [http-nio-8091-exec-29] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 104 rule_default
25-06-11.17:13:28.743 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:28.743 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:28.743 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 104]
25-06-11.17:13:28.799 [http-nio-8091-exec-31] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:28.840 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:28.840 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:28.840 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:28.840 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:28.840 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:28.840 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:28.840 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:28.840 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:28.840 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:28.840 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:28.850 [http-nio-8091-exec-29] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:104
25-06-11.17:13:28.924 [http-nio-8091-exec-29] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:104
25-06-11.17:13:28.970 [http-nio-8091-exec-29] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:28.970 [http-nio-8091-exec-29] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 104 null
25-06-11.17:13:29.016 [http-nio-8091-exec-29] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:29.203 [http-nio-8091-exec-31] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:29.203 [http-nio-8091-exec-31] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:29.203 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:29.203 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:29.203 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:29.281 [http-nio-8091-exec-31] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:29.364 [http-nio-8091-exec-31] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 105
25-06-11.17:13:29.364 [http-nio-8091-exec-31] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 rule_default
25-06-11.17:13:29.364 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:29.364 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:29.364 [http-nio-8091-exec-31] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 105]
25-06-11.17:13:29.401 [http-nio-8091-exec-32] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:29.450 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:29.450 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:29.450 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:29.450 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:29.450 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:29.450 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:29.450 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:29.450 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:29.450 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:29.450 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:29.479 [http-nio-8091-exec-31] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:29.560 [http-nio-8091-exec-31] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:29.608 [http-nio-8091-exec-31] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:29.608 [http-nio-8091-exec-31] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 null
25-06-11.17:13:29.652 [http-nio-8091-exec-31] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:29.767 [http-nio-8091-exec-32] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:29.767 [http-nio-8091-exec-32] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:29.767 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:29.767 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:29.767 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:29.850 [http-nio-8091-exec-32] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:29.942 [http-nio-8091-exec-32] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 106
25-06-11.17:13:29.942 [http-nio-8091-exec-32] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 rule_default
25-06-11.17:13:29.942 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:29.942 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:29.942 [http-nio-8091-exec-32] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 106]
25-06-11.17:13:30.004 [http-nio-8091-exec-34] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:30.038 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:30.038 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:30.038 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:30.038 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:30.038 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:30.038 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:30.038 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:30.038 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:30.038 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:30.038 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:30.061 [http-nio-8091-exec-32] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:30.156 [http-nio-8091-exec-32] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:30.209 [http-nio-8091-exec-32] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:30.209 [http-nio-8091-exec-32] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 null
25-06-11.17:13:30.254 [http-nio-8091-exec-32] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:30.374 [http-nio-8091-exec-34] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:30.374 [http-nio-8091-exec-34] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:30.375 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:30.375 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:30.375 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:30.470 [http-nio-8091-exec-34] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:30.552 [http-nio-8091-exec-34] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 101
25-06-11.17:13:30.553 [http-nio-8091-exec-34] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 101 rule_default
25-06-11.17:13:30.553 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:30.553 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:30.553 [http-nio-8091-exec-34] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 101]
25-06-11.17:13:30.604 [http-nio-8091-exec-37] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:30.650 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:30.650 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:30.650 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:30.650 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:30.650 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:30.650 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:30.650 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:30.650 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:30.650 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:30.650 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:30.681 [http-nio-8091-exec-34] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:101
25-06-11.17:13:30.762 [http-nio-8091-exec-34] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:101
25-06-11.17:13:30.822 [http-nio-8091-exec-34] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:30.822 [http-nio-8091-exec-34] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 101 null
25-06-11.17:13:30.877 [http-nio-8091-exec-34] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:30.991 [http-nio-8091-exec-37] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:30.991 [http-nio-8091-exec-37] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:30.992 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:30.992 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:30.992 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:31.070 [http-nio-8091-exec-37] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:31.151 [http-nio-8091-exec-37] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 105
25-06-11.17:13:31.151 [http-nio-8091-exec-37] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 rule_default
25-06-11.17:13:31.151 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:31.151 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:31.151 [http-nio-8091-exec-37] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 105]
25-06-11.17:13:31.196 [http-nio-8091-exec-38] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:31.233 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:31.233 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:31.233 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:31.233 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:31.233 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:31.233 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:31.233 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:31.233 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:31.233 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:31.233 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:31.260 [http-nio-8091-exec-37] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:31.342 [http-nio-8091-exec-37] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:31.391 [http-nio-8091-exec-37] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:31.391 [http-nio-8091-exec-37] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 null
25-06-11.17:13:31.475 [http-nio-8091-exec-37] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:31.583 [http-nio-8091-exec-38] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:31.583 [http-nio-8091-exec-38] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:31.584 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:31.584 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:31.584 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:31.671 [http-nio-8091-exec-38] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:31.748 [http-nio-8091-exec-38] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 105
25-06-11.17:13:31.748 [http-nio-8091-exec-38] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 rule_default
25-06-11.17:13:31.749 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:31.749 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:31.749 [http-nio-8091-exec-38] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 105]
25-06-11.17:13:31.794 [http-nio-8091-exec-40] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:31.833 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:31.833 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:31.833 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:31.833 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:31.833 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:31.833 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:31.833 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:31.833 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:31.833 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:31.833 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:31.862 [http-nio-8091-exec-38] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:31.946 [http-nio-8091-exec-38] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:31.992 [http-nio-8091-exec-38] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:31.992 [http-nio-8091-exec-38] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 null
25-06-11.17:13:32.056 [http-nio-8091-exec-38] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:32.166 [http-nio-8091-exec-40] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:32.166 [http-nio-8091-exec-40] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:32.166 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:32.166 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:32.166 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:32.250 [http-nio-8091-exec-40] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:32.340 [http-nio-8091-exec-40] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 102
25-06-11.17:13:32.340 [http-nio-8091-exec-40] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 102 rule_default
25-06-11.17:13:32.341 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:32.341 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:32.341 [http-nio-8091-exec-40] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 102]
25-06-11.17:13:32.407 [http-nio-8091-exec-42] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:32.442 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:32.442 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:32.443 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:32.443 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:32.443 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:32.443 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:32.443 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:32.443 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:32.443 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:32.443 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:32.463 [http-nio-8091-exec-40] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:32.538 [http-nio-8091-exec-40] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:32.594 [http-nio-8091-exec-40] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:32.595 [http-nio-8091-exec-40] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 102 null
25-06-11.17:13:32.643 [http-nio-8091-exec-40] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:32.812 [http-nio-8091-exec-42] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:32.812 [http-nio-8091-exec-42] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:32.812 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:32.812 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:32.812 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:32.943 [http-nio-8091-exec-42] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:33.005 [http-nio-8091-exec-43] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:33.029 [http-nio-8091-exec-42] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 101
25-06-11.17:13:33.029 [http-nio-8091-exec-42] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 101 rule_default
25-06-11.17:13:33.029 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:33.029 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:33.029 [http-nio-8091-exec-42] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 101]
25-06-11.17:13:33.041 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:33.041 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:33.041 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:33.041 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:33.041 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:33.041 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:33.041 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:33.041 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:33.041 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:33.041 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:33.146 [http-nio-8091-exec-42] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:101
25-06-11.17:13:33.220 [http-nio-8091-exec-42] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:101
25-06-11.17:13:33.266 [http-nio-8091-exec-42] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:33.266 [http-nio-8091-exec-42] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 101 null
25-06-11.17:13:33.317 [http-nio-8091-exec-42] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:33.363 [http-nio-8091-exec-43] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:33.363 [http-nio-8091-exec-43] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:33.364 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:33.364 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:33.364 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:33.539 [http-nio-8091-exec-43] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:33.607 [http-nio-8091-exec-46] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:33.629 [http-nio-8091-exec-43] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 105
25-06-11.17:13:33.629 [http-nio-8091-exec-43] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 rule_default
25-06-11.17:13:33.629 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:33.629 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:33.629 [http-nio-8091-exec-43] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 105]
25-06-11.17:13:33.650 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:33.650 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:33.650 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:33.650 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:33.650 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:33.650 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:33.650 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:33.650 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:33.650 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:33.650 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:33.736 [http-nio-8091-exec-43] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:33.813 [http-nio-8091-exec-43] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:33.849 [http-nio-8091-exec-43] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:33.849 [http-nio-8091-exec-43] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 null
25-06-11.17:13:33.896 [http-nio-8091-exec-43] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:33.962 [http-nio-8091-exec-46] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:33.962 [http-nio-8091-exec-46] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:33.963 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:33.963 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:33.963 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:34.043 [http-nio-8091-exec-46] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:34.128 [http-nio-8091-exec-46] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 107
25-06-11.17:13:34.128 [http-nio-8091-exec-46] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 107 rule_default
25-06-11.17:13:34.129 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:34.129 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:34.129 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 107]
25-06-11.17:13:34.194 [http-nio-8091-exec-48] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:34.224 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:34.224 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:34.224 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:34.224 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:34.224 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:34.224 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:34.224 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:34.224 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:34.224 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:34.224 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:34.247 [http-nio-8091-exec-46] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:107
25-06-11.17:13:34.248 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Logic SQL: select  user_id, activity_id, total_count, total_count_surplus, day_count,
                day_count_surplus, month_count, month_count_surplus
        from raffle_activity_account
        where user_id = ?
25-06-11.17:13:34.248 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:34.248 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select  user_id, activity_id, total_count, total_count_surplus, day_count,
                day_count_surplus, month_count, month_count_surplus
        from raffle_activity_account
        where user_id = ? ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s]
25-06-11.17:13:34.248 [http-nio-8091-exec-46] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select  user_id, activity_id, total_count, total_count_surplus, day_count,
                day_count_surplus, month_count, month_count_surplus
        from raffle_activity_account
        where user_id = ? ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s]
25-06-11.17:13:34.410 [http-nio-8091-exec-46] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_lock code:0000
25-06-11.17:13:34.411 [http-nio-8091-exec-46] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:107
25-06-11.17:13:34.483 [http-nio-8091-exec-46] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:107
25-06-11.17:13:34.525 [http-nio-8091-exec-46] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_stock code:0000
25-06-11.17:13:34.525 [http-nio-8091-exec-46] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 107 null
25-06-11.17:13:34.551 [http-nio-8091-exec-48] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:34.551 [http-nio-8091-exec-48] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:34.551 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:34.551 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:34.551 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:34.569 [http-nio-8091-exec-46] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:34.661 [http-nio-8091-exec-48] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:34.741 [http-nio-8091-exec-48] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 105
25-06-11.17:13:34.741 [http-nio-8091-exec-48] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 rule_default
25-06-11.17:13:34.742 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:34.742 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:34.742 [http-nio-8091-exec-48] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 105]
25-06-11.17:13:34.797 [http-nio-8091-exec-50] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:34.842 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:34.842 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:34.842 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:34.842 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:34.842 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:34.842 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:34.842 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:34.842 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:34.842 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:34.842 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:34.861 [http-nio-8091-exec-48] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:34.944 [http-nio-8091-exec-48] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:34.990 [http-nio-8091-exec-48] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:34.990 [http-nio-8091-exec-48] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 null
25-06-11.17:13:35.035 [http-nio-8091-exec-48] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:35.161 [http-nio-8091-exec-50] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:35.161 [http-nio-8091-exec-50] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:35.161 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:35.161 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:35.161 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:35.250 [http-nio-8091-exec-50] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:35.321 [http-nio-8091-exec-50] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 101
25-06-11.17:13:35.321 [http-nio-8091-exec-50] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 101 rule_default
25-06-11.17:13:35.322 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:35.322 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:35.322 [http-nio-8091-exec-50] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 101]
25-06-11.17:13:35.401 [http-nio-8091-exec-10] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:35.447 [http-nio-8091-exec-50] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:101
25-06-11.17:13:35.447 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:35.447 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:35.447 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:35.447 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:35.447 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:35.447 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:35.447 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:35.447 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:35.447 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:35.447 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:35.522 [http-nio-8091-exec-50] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:101
25-06-11.17:13:35.569 [http-nio-8091-exec-50] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:35.569 [http-nio-8091-exec-50] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 101 null
25-06-11.17:13:35.613 [http-nio-8091-exec-50] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:35.772 [http-nio-8091-exec-10] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:35.772 [http-nio-8091-exec-10] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:35.774 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:35.774 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:35.774 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:35.861 [http-nio-8091-exec-10] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:35.968 [http-nio-8091-exec-10] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 106
25-06-11.17:13:35.968 [http-nio-8091-exec-10] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 rule_default
25-06-11.17:13:35.969 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:35.969 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:35.969 [http-nio-8091-exec-10] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 106]
25-06-11.17:13:36.000 [http-nio-8091-exec-7] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:36.045 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:36.045 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:36.045 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:36.045 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:36.045 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:36.045 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:36.045 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:36.045 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:36.045 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:36.045 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:36.081 [http-nio-8091-exec-10] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:36.166 [http-nio-8091-exec-10] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:36.213 [http-nio-8091-exec-10] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:36.213 [http-nio-8091-exec-10] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 null
25-06-11.17:13:36.258 [http-nio-8091-exec-10] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:36.414 [http-nio-8091-exec-7] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:36.414 [http-nio-8091-exec-7] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:36.414 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:36.414 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:36.414 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:36.481 [http-nio-8091-exec-7] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:36.569 [http-nio-8091-exec-7] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 103
25-06-11.17:13:36.569 [http-nio-8091-exec-7] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 103 rule_default
25-06-11.17:13:36.570 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:36.570 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:36.570 [http-nio-8091-exec-7] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 103]
25-06-11.17:13:36.599 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:36.648 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:36.649 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:36.649 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:36.649 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:36.649 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:36.649 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:36.649 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:36.649 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:36.649 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:36.649 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:36.681 [http-nio-8091-exec-7] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:103
25-06-11.17:13:36.761 [http-nio-8091-exec-7] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:103
25-06-11.17:13:36.809 [http-nio-8091-exec-7] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:36.809 [http-nio-8091-exec-7] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 103 null
25-06-11.17:13:36.854 [http-nio-8091-exec-7] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:37.083 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:37.083 [http-nio-8091-exec-1] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:37.083 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:37.083 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:37.083 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:37.198 [http-nio-8091-exec-14] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:37.200 [http-nio-8091-exec-1] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:37.241 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:37.241 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:37.241 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:37.241 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:37.241 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:37.241 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:37.241 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:37.241 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:37.241 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:37.241 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:37.289 [http-nio-8091-exec-1] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 108
25-06-11.17:13:37.289 [http-nio-8091-exec-1] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 108 rule_default
25-06-11.17:13:37.291 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:37.291 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:37.291 [http-nio-8091-exec-1] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 108]
25-06-11.17:13:37.399 [http-nio-8091-exec-1] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:108
25-06-11.17:13:37.480 [http-nio-8091-exec-1] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:108
25-06-11.17:13:37.527 [http-nio-8091-exec-1] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:37.527 [http-nio-8091-exec-1] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 108 null
25-06-11.17:13:37.610 [http-nio-8091-exec-14] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:37.610 [http-nio-8091-exec-14] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:37.611 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:37.611 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:37.611 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:37.612 [http-nio-8091-exec-1] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:37.687 [http-nio-8091-exec-14] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:37.768 [http-nio-8091-exec-14] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 105
25-06-11.17:13:37.768 [http-nio-8091-exec-14] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 rule_default
25-06-11.17:13:37.769 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:37.769 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:37.769 [http-nio-8091-exec-14] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 105]
25-06-11.17:13:37.799 [http-nio-8091-exec-11] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:37.849 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:37.849 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:37.849 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:37.849 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:37.849 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:37.849 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:37.849 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:37.849 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:37.849 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:37.849 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:37.880 [http-nio-8091-exec-14] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:37.960 [http-nio-8091-exec-14] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:38.010 [http-nio-8091-exec-14] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:38.010 [http-nio-8091-exec-14] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 null
25-06-11.17:13:38.054 [http-nio-8091-exec-14] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:38.164 [http-nio-8091-exec-11] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:38.164 [http-nio-8091-exec-11] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:38.164 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:38.164 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:38.164 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:38.250 [http-nio-8091-exec-11] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:38.326 [http-nio-8091-exec-11] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 106
25-06-11.17:13:38.326 [http-nio-8091-exec-11] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 rule_default
25-06-11.17:13:38.327 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:38.327 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:38.327 [http-nio-8091-exec-11] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 106]
25-06-11.17:13:38.400 [http-nio-8091-exec-8] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:38.436 [http-nio-8091-exec-11] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:38.445 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:38.445 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:38.445 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:38.445 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:38.445 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:38.445 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:38.445 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:38.445 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:38.445 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:38.445 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:38.528 [http-nio-8091-exec-11] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:38.572 [http-nio-8091-exec-11] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:38.572 [http-nio-8091-exec-11] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 null
25-06-11.17:13:38.618 [http-nio-8091-exec-11] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:38.851 [http-nio-8091-exec-8] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:38.852 [http-nio-8091-exec-8] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:38.852 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:38.852 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:38.852 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:38.982 [http-nio-8091-exec-8] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:39.001 [http-nio-8091-exec-6] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:39.042 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:39.042 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:39.042 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:39.042 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:39.042 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:39.042 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:39.042 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:39.042 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:39.042 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:39.042 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:39.067 [http-nio-8091-exec-8] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 108
25-06-11.17:13:39.067 [http-nio-8091-exec-8] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 108 rule_default
25-06-11.17:13:39.069 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:39.069 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:39.069 [http-nio-8091-exec-8] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 108]
25-06-11.17:13:39.220 [http-nio-8091-exec-8] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:108
25-06-11.17:13:39.314 [http-nio-8091-exec-8] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:108
25-06-11.17:13:39.352 [http-nio-8091-exec-8] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:39.352 [http-nio-8091-exec-8] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 108 null
25-06-11.17:13:39.397 [http-nio-8091-exec-8] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:39.467 [http-nio-8091-exec-6] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:39.467 [http-nio-8091-exec-6] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:39.468 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:39.468 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:39.468 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:39.552 [http-nio-8091-exec-6] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:39.604 [http-nio-8091-exec-24] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:39.651 [http-nio-8091-exec-6] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 105
25-06-11.17:13:39.651 [http-nio-8091-exec-6] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 rule_default
25-06-11.17:13:39.651 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:39.651 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:39.651 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:39.651 [http-nio-8091-exec-6] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 105]
25-06-11.17:13:39.651 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:39.651 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:39.651 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:39.651 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:39.651 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:39.651 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:39.651 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:39.651 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:39.651 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:39.760 [http-nio-8091-exec-6] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:39.840 [http-nio-8091-exec-6] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:39.880 [http-nio-8091-exec-6] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:39.880 [http-nio-8091-exec-6] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 null
25-06-11.17:13:39.936 [http-nio-8091-exec-6] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:40.014 [http-nio-8091-exec-24] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:40.014 [http-nio-8091-exec-24] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:40.014 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:40.014 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:40.014 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:40.094 [http-nio-8091-exec-24] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:40.190 [http-nio-8091-exec-24] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 105
25-06-11.17:13:40.190 [http-nio-8091-exec-24] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 rule_default
25-06-11.17:13:40.191 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:40.191 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:40.191 [http-nio-8091-exec-24] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 105]
25-06-11.17:13:40.193 [http-nio-8091-exec-18] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:40.232 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:40.232 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:40.232 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:40.232 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:40.232 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:40.232 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:40.232 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:40.232 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:40.232 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:40.232 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:40.300 [http-nio-8091-exec-24] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:40.423 [http-nio-8091-exec-24] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:40.473 [http-nio-8091-exec-24] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:40.473 [http-nio-8091-exec-24] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 null
25-06-11.17:13:40.516 [http-nio-8091-exec-24] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:40.586 [http-nio-8091-exec-18] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:40.586 [http-nio-8091-exec-18] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:40.587 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:40.587 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:40.587 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:40.671 [http-nio-8091-exec-18] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:40.750 [http-nio-8091-exec-18] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 101
25-06-11.17:13:40.750 [http-nio-8091-exec-18] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 101 rule_default
25-06-11.17:13:40.751 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:40.751 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:40.751 [http-nio-8091-exec-18] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 101]
25-06-11.17:13:40.793 [http-nio-8091-exec-21] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:40.828 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:40.828 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:40.828 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:40.828 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:40.828 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:40.828 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:40.828 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:40.828 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:40.828 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:40.828 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:40.861 [http-nio-8091-exec-18] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:101
25-06-11.17:13:40.940 [http-nio-8091-exec-18] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:101
25-06-11.17:13:40.989 [http-nio-8091-exec-18] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:40.990 [http-nio-8091-exec-18] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 101 null
25-06-11.17:13:41.058 [http-nio-8091-exec-18] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:41.202 [http-nio-8091-exec-21] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:41.202 [http-nio-8091-exec-21] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:41.203 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:41.203 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:41.203 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:41.281 [http-nio-8091-exec-21] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:41.370 [http-nio-8091-exec-21] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 107
25-06-11.17:13:41.370 [http-nio-8091-exec-21] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 107 rule_default
25-06-11.17:13:41.372 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:41.372 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:41.372 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 107]
25-06-11.17:13:41.393 [http-nio-8091-exec-22] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:41.441 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:41.441 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:41.441 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:41.441 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:41.441 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:41.441 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:41.441 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:41.441 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:41.441 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:41.441 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:41.488 [http-nio-8091-exec-21] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:107
25-06-11.17:13:41.488 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Logic SQL: select  user_id, activity_id, total_count, total_count_surplus, day_count,
                day_count_surplus, month_count, month_count_surplus
        from raffle_activity_account
        where user_id = ?
25-06-11.17:13:41.488 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:41.488 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select  user_id, activity_id, total_count, total_count_surplus, day_count,
                day_count_surplus, month_count, month_count_surplus
        from raffle_activity_account
        where user_id = ? ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s]
25-06-11.17:13:41.488 [http-nio-8091-exec-21] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select  user_id, activity_id, total_count, total_count_surplus, day_count,
                day_count_surplus, month_count, month_count_surplus
        from raffle_activity_account
        where user_id = ? ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s]
25-06-11.17:13:41.644 [http-nio-8091-exec-21] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_lock code:0000
25-06-11.17:13:41.644 [http-nio-8091-exec-21] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:107
25-06-11.17:13:41.729 [http-nio-8091-exec-21] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:107
25-06-11.17:13:41.760 [http-nio-8091-exec-21] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_stock code:0000
25-06-11.17:13:41.760 [http-nio-8091-exec-21] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 107 null
25-06-11.17:13:41.781 [http-nio-8091-exec-22] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:41.782 [http-nio-8091-exec-22] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:41.782 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:41.782 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:41.782 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:41.814 [http-nio-8091-exec-21] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:41.871 [http-nio-8091-exec-22] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:41.939 [http-nio-8091-exec-22] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 104
25-06-11.17:13:41.939 [http-nio-8091-exec-22] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 104 rule_default
25-06-11.17:13:41.940 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:41.940 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:41.940 [http-nio-8091-exec-22] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 104]
25-06-11.17:13:41.997 [http-nio-8091-exec-25] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:42.041 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:42.041 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:42.041 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:42.041 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:42.041 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:42.041 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:42.041 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:42.041 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:42.041 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:42.041 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:42.061 [http-nio-8091-exec-22] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:104
25-06-11.17:13:42.139 [http-nio-8091-exec-22] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:104
25-06-11.17:13:42.186 [http-nio-8091-exec-22] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:42.186 [http-nio-8091-exec-22] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 104 null
25-06-11.17:13:42.238 [http-nio-8091-exec-22] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:42.421 [http-nio-8091-exec-25] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:42.421 [http-nio-8091-exec-25] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:42.423 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:42.423 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:42.423 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:42.501 [http-nio-8091-exec-25] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:42.584 [http-nio-8091-exec-25] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 103
25-06-11.17:13:42.584 [http-nio-8091-exec-25] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 103 rule_default
25-06-11.17:13:42.585 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:42.585 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:42.585 [http-nio-8091-exec-25] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 103]
25-06-11.17:13:42.597 [http-nio-8091-exec-26] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:42.643 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:42.643 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:42.643 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:42.643 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:42.643 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:42.643 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:42.643 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:42.643 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:42.643 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:42.643 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:42.701 [http-nio-8091-exec-25] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:103
25-06-11.17:13:42.772 [http-nio-8091-exec-25] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:103
25-06-11.17:13:42.811 [http-nio-8091-exec-25] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:42.812 [http-nio-8091-exec-25] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 103 null
25-06-11.17:13:42.855 [http-nio-8091-exec-25] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:42.995 [http-nio-8091-exec-26] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:42.995 [http-nio-8091-exec-26] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:42.995 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:42.995 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:42.995 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:43.063 [http-nio-8091-exec-26] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:43.144 [http-nio-8091-exec-26] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 103
25-06-11.17:13:43.144 [http-nio-8091-exec-26] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 103 rule_default
25-06-11.17:13:43.144 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:43.144 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:43.144 [http-nio-8091-exec-26] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 103]
25-06-11.17:13:43.203 [http-nio-8091-exec-28] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:43.240 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:43.240 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:43.240 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:43.240 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:43.240 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:43.240 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:43.240 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:43.240 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:43.240 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:43.240 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:43.261 [http-nio-8091-exec-26] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:103
25-06-11.17:13:43.345 [http-nio-8091-exec-26] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:103
25-06-11.17:13:43.391 [http-nio-8091-exec-26] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:43.391 [http-nio-8091-exec-26] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 103 null
25-06-11.17:13:43.434 [http-nio-8091-exec-26] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:43.541 [http-nio-8091-exec-28] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:43.541 [http-nio-8091-exec-28] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:43.543 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:43.543 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:43.543 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:43.662 [http-nio-8091-exec-28] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:43.749 [http-nio-8091-exec-28] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 106
25-06-11.17:13:43.749 [http-nio-8091-exec-28] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 rule_default
25-06-11.17:13:43.750 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:43.750 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:43.750 [http-nio-8091-exec-28] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 106]
25-06-11.17:13:43.802 [http-nio-8091-exec-36] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:43.851 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:43.851 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:43.851 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:43.851 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:43.851 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:43.851 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:43.851 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:43.851 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:43.851 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:43.851 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:43.858 [http-nio-8091-exec-28] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:43.931 [http-nio-8091-exec-28] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:43.968 [http-nio-8091-exec-28] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:43.968 [http-nio-8091-exec-28] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 null
25-06-11.17:13:44.016 [http-nio-8091-exec-28] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:44.171 [http-nio-8091-exec-36] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:44.171 [http-nio-8091-exec-36] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:44.172 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:44.172 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:44.172 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:44.241 [http-nio-8091-exec-36] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:44.329 [http-nio-8091-exec-36] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 106
25-06-11.17:13:44.329 [http-nio-8091-exec-36] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 rule_default
25-06-11.17:13:44.329 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:44.329 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:44.329 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 106]
25-06-11.17:13:44.394 [http-nio-8091-exec-27] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:44.440 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:44.440 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:44.440 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:44.440 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:44.440 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:44.440 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:44.440 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:44.440 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:44.440 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:44.440 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:44.441 [http-nio-8091-exec-36] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:44.520 [http-nio-8091-exec-36] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:44.571 [http-nio-8091-exec-36] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:44.571 [http-nio-8091-exec-36] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 null
25-06-11.17:13:44.613 [http-nio-8091-exec-36] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:44.765 [http-nio-8091-exec-27] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:44.765 [http-nio-8091-exec-27] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:44.767 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:44.767 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:44.767 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:44.836 [http-nio-8091-exec-27] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:44.919 [http-nio-8091-exec-27] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 108
25-06-11.17:13:44.919 [http-nio-8091-exec-27] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 108 rule_default
25-06-11.17:13:44.920 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:44.920 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:44.920 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 108]
25-06-11.17:13:45.001 [http-nio-8091-exec-35] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:45.040 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:45.040 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:45.040 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:45.040 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:45.040 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:45.040 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:45.040 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:45.040 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:45.040 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:45.040 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:45.041 [http-nio-8091-exec-27] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:108
25-06-11.17:13:45.121 [http-nio-8091-exec-27] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:108
25-06-11.17:13:45.168 [http-nio-8091-exec-27] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:45.168 [http-nio-8091-exec-27] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 108 null
25-06-11.17:13:45.214 [http-nio-8091-exec-27] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:45.373 [http-nio-8091-exec-35] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:45.373 [http-nio-8091-exec-35] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:45.373 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:45.373 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:45.373 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:45.450 [http-nio-8091-exec-35] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:45.529 [http-nio-8091-exec-35] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 108
25-06-11.17:13:45.529 [http-nio-8091-exec-35] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 108 rule_default
25-06-11.17:13:45.531 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:45.531 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:45.531 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 108]
25-06-11.17:13:45.604 [http-nio-8091-exec-30] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:45.649 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:45.649 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:45.649 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:45.649 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:45.649 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:45.649 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:45.649 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:45.649 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:45.649 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:45.649 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:45.652 [http-nio-8091-exec-35] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:108
25-06-11.17:13:45.720 [http-nio-8091-exec-35] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:108
25-06-11.17:13:45.769 [http-nio-8091-exec-35] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:45.769 [http-nio-8091-exec-35] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 108 null
25-06-11.17:13:45.817 [http-nio-8091-exec-35] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:45.973 [http-nio-8091-exec-30] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:45.973 [http-nio-8091-exec-30] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:45.973 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:45.973 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:45.973 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:46.042 [http-nio-8091-exec-30] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:46.128 [http-nio-8091-exec-30] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 102
25-06-11.17:13:46.128 [http-nio-8091-exec-30] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 102 rule_default
25-06-11.17:13:46.129 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:46.129 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:46.129 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 102]
25-06-11.17:13:46.206 [http-nio-8091-exec-39] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:46.239 [http-nio-8091-exec-30] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:46.289 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:46.289 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:46.289 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:46.289 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:46.289 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:46.289 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:46.289 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:46.289 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:46.289 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:46.289 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:46.320 [http-nio-8091-exec-30] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:46.370 [http-nio-8091-exec-30] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:46.370 [http-nio-8091-exec-30] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 102 null
25-06-11.17:13:46.415 [http-nio-8091-exec-30] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:46.641 [http-nio-8091-exec-39] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:46.641 [http-nio-8091-exec-39] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:46.641 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:46.641 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:46.641 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:46.761 [http-nio-8091-exec-39] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:46.795 [http-nio-8091-exec-41] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:46.822 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:46.822 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:46.822 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:46.822 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:46.822 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:46.822 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:46.822 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:46.822 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:46.822 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:46.822 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:46.850 [http-nio-8091-exec-39] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 102
25-06-11.17:13:46.850 [http-nio-8091-exec-39] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 102 rule_default
25-06-11.17:13:46.850 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:46.850 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:46.850 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 102]
25-06-11.17:13:46.960 [http-nio-8091-exec-39] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:47.041 [http-nio-8091-exec-39] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:47.083 [http-nio-8091-exec-39] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:47.083 [http-nio-8091-exec-39] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 102 null
25-06-11.17:13:47.139 [http-nio-8091-exec-41] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:47.139 [http-nio-8091-exec-41] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:47.140 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:47.140 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:47.140 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:47.143 [http-nio-8091-exec-39] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:47.221 [http-nio-8091-exec-41] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:47.301 [http-nio-8091-exec-41] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 105
25-06-11.17:13:47.301 [http-nio-8091-exec-41] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 rule_default
25-06-11.17:13:47.302 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:47.302 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:47.302 [http-nio-8091-exec-41] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 105]
25-06-11.17:13:47.397 [http-nio-8091-exec-44] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:47.461 [http-nio-8091-exec-41] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:47.473 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:47.473 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:47.473 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:47.473 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:47.473 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:47.473 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:47.473 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:47.473 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:47.473 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:47.473 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:47.547 [http-nio-8091-exec-41] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:47.587 [http-nio-8091-exec-41] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:47.587 [http-nio-8091-exec-41] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 null
25-06-11.17:13:47.635 [http-nio-8091-exec-41] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:47.868 [http-nio-8091-exec-44] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:47.868 [http-nio-8091-exec-44] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:47.868 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:47.868 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:47.868 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:47.980 [http-nio-8091-exec-44] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:48.002 [http-nio-8091-exec-45] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:48.039 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:48.039 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:48.039 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:48.039 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:48.039 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:48.039 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:48.039 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:48.039 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:48.039 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:48.039 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:48.080 [http-nio-8091-exec-44] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 102
25-06-11.17:13:48.080 [http-nio-8091-exec-44] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 102 rule_default
25-06-11.17:13:48.081 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:48.081 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:48.081 [http-nio-8091-exec-44] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 102]
25-06-11.17:13:48.200 [http-nio-8091-exec-44] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:48.286 [http-nio-8091-exec-44] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:48.331 [http-nio-8091-exec-44] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:48.331 [http-nio-8091-exec-44] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 102 null
25-06-11.17:13:48.376 [http-nio-8091-exec-44] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:48.453 [http-nio-8091-exec-45] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:48.453 [http-nio-8091-exec-45] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:48.453 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:48.453 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:48.453 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:48.520 [http-nio-8091-exec-45] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:48.597 [http-nio-8091-exec-47] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:48.600 [http-nio-8091-exec-45] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 107
25-06-11.17:13:48.600 [http-nio-8091-exec-45] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 107 rule_default
25-06-11.17:13:48.600 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:48.600 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:48.600 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 107]
25-06-11.17:13:48.637 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:48.637 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:48.637 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:48.637 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:48.637 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:48.637 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:48.637 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:48.637 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:48.638 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:48.638 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:48.751 [http-nio-8091-exec-45] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:107
25-06-11.17:13:48.751 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Logic SQL: select  user_id, activity_id, total_count, total_count_surplus, day_count,
                day_count_surplus, month_count, month_count_surplus
        from raffle_activity_account
        where user_id = ?
25-06-11.17:13:48.751 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:48.751 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select  user_id, activity_id, total_count, total_count_surplus, day_count,
                day_count_surplus, month_count, month_count_surplus
        from raffle_activity_account
        where user_id = ? ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s]
25-06-11.17:13:48.751 [http-nio-8091-exec-45] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select  user_id, activity_id, total_count, total_count_surplus, day_count,
                day_count_surplus, month_count, month_count_surplus
        from raffle_activity_account
        where user_id = ? ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s]
25-06-11.17:13:48.905 [http-nio-8091-exec-45] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_lock code:0000
25-06-11.17:13:48.905 [http-nio-8091-exec-45] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:107
25-06-11.17:13:48.980 [http-nio-8091-exec-45] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:107
25-06-11.17:13:48.993 [http-nio-8091-exec-47] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:48.993 [http-nio-8091-exec-47] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:48.993 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:48.993 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:48.993 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:49.034 [http-nio-8091-exec-45] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_stock code:0000
25-06-11.17:13:49.034 [http-nio-8091-exec-45] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 107 null
25-06-11.17:13:49.064 [http-nio-8091-exec-47] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:49.073 [http-nio-8091-exec-45] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:49.151 [http-nio-8091-exec-47] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 101
25-06-11.17:13:49.151 [http-nio-8091-exec-47] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 101 rule_default
25-06-11.17:13:49.151 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:49.151 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:49.151 [http-nio-8091-exec-47] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 101]
25-06-11.17:13:49.199 [http-nio-8091-exec-49] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:49.242 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:49.242 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:49.242 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:49.242 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:49.242 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:49.242 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:49.242 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:49.242 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:49.242 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:49.242 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:49.260 [http-nio-8091-exec-47] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:101
25-06-11.17:13:49.359 [http-nio-8091-exec-47] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:101
25-06-11.17:13:49.410 [http-nio-8091-exec-47] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:49.410 [http-nio-8091-exec-47] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 101 null
25-06-11.17:13:49.455 [http-nio-8091-exec-47] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:49.569 [http-nio-8091-exec-49] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:49.569 [http-nio-8091-exec-49] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:49.569 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:49.569 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:49.569 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:49.652 [http-nio-8091-exec-49] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:49.721 [http-nio-8091-exec-49] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 106
25-06-11.17:13:49.721 [http-nio-8091-exec-49] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 rule_default
25-06-11.17:13:49.722 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:49.722 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:49.722 [http-nio-8091-exec-49] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 106]
25-06-11.17:13:49.799 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:49.849 [http-nio-8091-exec-49] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:49.855 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:49.855 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:49.855 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:49.855 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:49.855 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:49.855 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:49.855 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:49.855 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:49.855 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:49.855 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:49.921 [http-nio-8091-exec-49] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:49.971 [http-nio-8091-exec-49] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:49.971 [http-nio-8091-exec-49] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 null
25-06-11.17:13:50.020 [http-nio-8091-exec-49] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:50.183 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:50.183 [http-nio-8091-exec-2] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:50.184 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:50.184 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:50.184 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:50.259 [http-nio-8091-exec-2] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:50.340 [http-nio-8091-exec-2] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 108
25-06-11.17:13:50.340 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 108 rule_default
25-06-11.17:13:50.341 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:50.341 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:50.341 [http-nio-8091-exec-2] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 108]
25-06-11.17:13:50.406 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:50.441 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:50.442 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:50.442 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:50.442 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:50.442 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:50.442 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:50.442 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:50.442 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:50.442 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:50.442 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:50.464 [http-nio-8091-exec-2] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:108
25-06-11.17:13:50.552 [http-nio-8091-exec-2] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:108
25-06-11.17:13:50.592 [http-nio-8091-exec-2] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:50.592 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 108 null
25-06-11.17:13:50.655 [http-nio-8091-exec-2] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:50.803 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:50.803 [http-nio-8091-exec-3] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:50.803 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:50.803 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:50.803 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:50.884 [http-nio-8091-exec-3] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:50.962 [http-nio-8091-exec-3] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 102
25-06-11.17:13:50.962 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 102 rule_default
25-06-11.17:13:50.963 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:50.963 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:50.963 [http-nio-8091-exec-3] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 102]
25-06-11.17:13:51.006 [http-nio-8091-exec-4] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:51.049 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:51.050 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:51.050 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:51.050 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:51.050 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:51.050 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:51.050 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:51.050 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:51.050 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:51.050 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:51.082 [http-nio-8091-exec-3] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:51.160 [http-nio-8091-exec-3] WARN  RuleStockLogicTreeNode - 规则过滤-库存扣减-告警，库存不足。userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:51.161 [http-nio-8091-exec-3] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-06-11.17:13:51.161 [http-nio-8091-exec-3] INFO  RuleLuckAwardLogicTreeNode - 规则过滤-兜底奖品 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102 ruleValue:101:1,100
25-06-11.17:13:51.200 [http-nio-8091-exec-3] INFO  RuleLuckAwardLogicTreeNode - 规则过滤-兜底奖品 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:101 awardRuleValue:1,100
25-06-11.17:13:51.200 [http-nio-8091-exec-3] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_luck_award code:0001
25-06-11.17:13:51.200 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 101 1,100
25-06-11.17:13:51.256 [http-nio-8091-exec-3] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:51.473 [http-nio-8091-exec-4] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:51.473 [http-nio-8091-exec-4] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:51.473 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:51.473 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:51.473 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:51.580 [http-nio-8091-exec-4] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:51.594 [http-nio-8091-exec-13] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:51.640 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:51.640 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:51.640 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:51.640 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:51.640 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:51.640 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:51.640 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:51.640 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:51.640 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:51.640 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:51.640 [http-nio-8091-exec-4] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 103
25-06-11.17:13:51.640 [http-nio-8091-exec-4] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 103 rule_default
25-06-11.17:13:51.640 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:51.640 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:51.640 [http-nio-8091-exec-4] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 103]
25-06-11.17:13:51.759 [http-nio-8091-exec-4] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:103
25-06-11.17:13:51.840 [http-nio-8091-exec-4] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:103
25-06-11.17:13:51.890 [http-nio-8091-exec-4] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:51.890 [http-nio-8091-exec-4] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 103 null
25-06-11.17:13:51.932 [http-nio-8091-exec-4] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:52.051 [http-nio-8091-exec-13] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:52.051 [http-nio-8091-exec-13] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:52.052 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:52.052 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:52.052 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:52.121 [http-nio-8091-exec-13] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:52.193 [http-nio-8091-exec-15] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:52.210 [http-nio-8091-exec-13] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 104
25-06-11.17:13:52.210 [http-nio-8091-exec-13] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 104 rule_default
25-06-11.17:13:52.211 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:52.211 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:52.211 [http-nio-8091-exec-13] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 104]
25-06-11.17:13:52.242 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:52.242 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:52.242 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:52.242 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:52.242 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:52.242 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:52.242 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:52.242 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:52.242 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:52.242 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:52.329 [http-nio-8091-exec-13] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:104
25-06-11.17:13:52.400 [http-nio-8091-exec-13] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:104
25-06-11.17:13:52.448 [http-nio-8091-exec-13] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:52.448 [http-nio-8091-exec-13] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 104 null
25-06-11.17:13:52.496 [http-nio-8091-exec-13] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:52.573 [http-nio-8091-exec-15] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:52.574 [http-nio-8091-exec-15] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:52.574 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:52.574 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:52.574 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:52.640 [http-nio-8091-exec-15] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:52.729 [http-nio-8091-exec-15] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 105
25-06-11.17:13:52.729 [http-nio-8091-exec-15] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 rule_default
25-06-11.17:13:52.730 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:52.730 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:52.730 [http-nio-8091-exec-15] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 105]
25-06-11.17:13:52.796 [http-nio-8091-exec-5] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:52.832 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:52.832 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:52.832 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:52.832 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:52.832 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:52.832 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:52.832 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:52.832 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:52.832 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:52.832 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:52.839 [http-nio-8091-exec-15] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:52.919 [http-nio-8091-exec-15] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:52.969 [http-nio-8091-exec-15] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:52.969 [http-nio-8091-exec-15] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 null
25-06-11.17:13:53.024 [http-nio-8091-exec-15] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:53.274 [http-nio-8091-exec-5] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:53.274 [http-nio-8091-exec-5] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:53.274 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:53.274 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:53.276 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:53.383 [http-nio-8091-exec-5] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:53.399 [http-nio-8091-exec-12] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:53.440 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:53.440 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:53.440 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:53.440 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:53.440 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:53.440 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:53.440 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:53.440 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:53.440 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:53.440 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:53.469 [http-nio-8091-exec-5] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 108
25-06-11.17:13:53.469 [http-nio-8091-exec-5] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 108 rule_default
25-06-11.17:13:53.469 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:53.469 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:53.469 [http-nio-8091-exec-5] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 108]
25-06-11.17:13:53.580 [http-nio-8091-exec-5] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:108
25-06-11.17:13:53.657 [http-nio-8091-exec-5] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:108
25-06-11.17:13:53.700 [http-nio-8091-exec-5] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:53.700 [http-nio-8091-exec-5] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 108 null
25-06-11.17:13:53.758 [http-nio-8091-exec-5] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:53.903 [http-nio-8091-exec-12] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:53.903 [http-nio-8091-exec-12] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:53.904 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:53.904 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:53.904 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:54.004 [http-nio-8091-exec-9] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:54.021 [http-nio-8091-exec-12] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:54.042 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:54.042 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:54.042 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:54.042 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:54.042 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:54.042 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:54.042 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:54.042 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:54.042 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:54.042 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:54.100 [http-nio-8091-exec-12] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 103
25-06-11.17:13:54.100 [http-nio-8091-exec-12] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 103 rule_default
25-06-11.17:13:54.100 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:54.100 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:54.100 [http-nio-8091-exec-12] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 103]
25-06-11.17:13:54.221 [http-nio-8091-exec-12] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:103
25-06-11.17:13:54.291 [http-nio-8091-exec-12] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:103
25-06-11.17:13:54.334 [http-nio-8091-exec-12] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:54.334 [http-nio-8091-exec-12] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 103 null
25-06-11.17:13:54.374 [http-nio-8091-exec-12] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:54.402 [http-nio-8091-exec-9] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:54.402 [http-nio-8091-exec-9] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:54.402 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:54.402 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:54.402 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:54.493 [http-nio-8091-exec-9] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:54.561 [http-nio-8091-exec-9] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 108
25-06-11.17:13:54.561 [http-nio-8091-exec-9] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 108 rule_default
25-06-11.17:13:54.561 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:54.561 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:54.561 [http-nio-8091-exec-9] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 108]
25-06-11.17:13:54.593 [http-nio-8091-exec-16] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:54.638 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:54.638 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:54.638 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:54.639 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:54.639 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:54.639 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:54.639 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:54.639 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:54.639 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:54.639 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:54.693 [http-nio-8091-exec-9] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:108
25-06-11.17:13:54.762 [http-nio-8091-exec-9] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:108
25-06-11.17:13:54.813 [http-nio-8091-exec-9] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:54.813 [http-nio-8091-exec-9] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 108 null
25-06-11.17:13:54.857 [http-nio-8091-exec-9] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:54.985 [http-nio-8091-exec-16] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:54.985 [http-nio-8091-exec-16] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:54.985 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:54.985 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:54.985 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:55.070 [http-nio-8091-exec-16] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:55.196 [http-nio-8091-exec-19] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:55.201 [http-nio-8091-exec-16] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 105
25-06-11.17:13:55.201 [http-nio-8091-exec-16] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 rule_default
25-06-11.17:13:55.202 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:55.202 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:55.202 [http-nio-8091-exec-16] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 105]
25-06-11.17:13:55.243 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:55.243 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:55.243 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:55.243 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:55.243 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:55.243 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:55.243 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:55.243 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:55.243 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:55.243 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:55.333 [http-nio-8091-exec-16] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:55.400 [http-nio-8091-exec-16] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:55.455 [http-nio-8091-exec-16] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:55.455 [http-nio-8091-exec-16] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 null
25-06-11.17:13:55.494 [http-nio-8091-exec-16] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:55.574 [http-nio-8091-exec-19] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:55.574 [http-nio-8091-exec-19] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:55.575 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:55.575 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:55.575 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:55.642 [http-nio-8091-exec-19] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:55.719 [http-nio-8091-exec-19] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 107
25-06-11.17:13:55.720 [http-nio-8091-exec-19] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 107 rule_default
25-06-11.17:13:55.720 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:55.720 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:55.720 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 107]
25-06-11.17:13:55.800 [http-nio-8091-exec-20] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:55.843 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:55.843 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:55.843 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:55.843 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:55.843 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:55.843 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:55.843 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:55.843 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:55.843 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:55.843 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:55.892 [http-nio-8091-exec-19] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:107
25-06-11.17:13:55.892 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Logic SQL: select  user_id, activity_id, total_count, total_count_surplus, day_count,
                day_count_surplus, month_count, month_count_surplus
        from raffle_activity_account
        where user_id = ?
25-06-11.17:13:55.892 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:55.892 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select  user_id, activity_id, total_count, total_count_surplus, day_count,
                day_count_surplus, month_count, month_count_surplus
        from raffle_activity_account
        where user_id = ? ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s]
25-06-11.17:13:55.892 [http-nio-8091-exec-19] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select  user_id, activity_id, total_count, total_count_surplus, day_count,
                day_count_surplus, month_count, month_count_surplus
        from raffle_activity_account
        where user_id = ? ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s]
25-06-11.17:13:56.045 [http-nio-8091-exec-19] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_lock code:0000
25-06-11.17:13:56.045 [http-nio-8091-exec-19] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:107
25-06-11.17:13:56.121 [http-nio-8091-exec-19] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:107
25-06-11.17:13:56.170 [http-nio-8091-exec-19] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_stock code:0000
25-06-11.17:13:56.170 [http-nio-8091-exec-19] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 107 null
25-06-11.17:13:56.173 [http-nio-8091-exec-20] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:56.173 [http-nio-8091-exec-20] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:56.173 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:56.173 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:56.173 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:56.214 [http-nio-8091-exec-19] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:56.251 [http-nio-8091-exec-20] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:56.317 [http-nio-8091-exec-20] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 108
25-06-11.17:13:56.317 [http-nio-8091-exec-20] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 108 rule_default
25-06-11.17:13:56.317 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:56.317 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:56.317 [http-nio-8091-exec-20] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 108]
25-06-11.17:13:56.402 [http-nio-8091-exec-23] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:56.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:56.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:56.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:56.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:56.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:56.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:56.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:56.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:56.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:56.440 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:56.491 [http-nio-8091-exec-20] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:108
25-06-11.17:13:56.561 [http-nio-8091-exec-20] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:108
25-06-11.17:13:56.619 [http-nio-8091-exec-20] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:56.619 [http-nio-8091-exec-20] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 108 null
25-06-11.17:13:56.672 [http-nio-8091-exec-20] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:56.783 [http-nio-8091-exec-23] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:56.783 [http-nio-8091-exec-23] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:56.784 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:56.784 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:56.784 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:56.871 [http-nio-8091-exec-23] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:56.941 [http-nio-8091-exec-23] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 101
25-06-11.17:13:56.941 [http-nio-8091-exec-23] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 101 rule_default
25-06-11.17:13:56.941 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:56.941 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:56.941 [http-nio-8091-exec-23] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 101]
25-06-11.17:13:57.005 [http-nio-8091-exec-17] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:57.051 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:57.051 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:57.051 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:57.051 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:57.051 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:57.051 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:57.051 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:57.051 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:57.051 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:57.051 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:57.081 [http-nio-8091-exec-23] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:101
25-06-11.17:13:57.164 [http-nio-8091-exec-23] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:101
25-06-11.17:13:57.210 [http-nio-8091-exec-23] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:57.210 [http-nio-8091-exec-23] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 101 null
25-06-11.17:13:57.255 [http-nio-8091-exec-23] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:57.403 [http-nio-8091-exec-17] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:57.403 [http-nio-8091-exec-17] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:57.403 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:57.403 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:57.403 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:57.491 [http-nio-8091-exec-17] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:57.581 [http-nio-8091-exec-17] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 105
25-06-11.17:13:57.581 [http-nio-8091-exec-17] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 rule_default
25-06-11.17:13:57.581 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:57.581 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:57.581 [http-nio-8091-exec-17] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 105]
25-06-11.17:13:57.594 [http-nio-8091-exec-33] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:57.631 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:57.631 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:57.631 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:57.631 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:57.631 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:57.631 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:57.631 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:57.631 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:57.631 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:57.631 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:57.741 [http-nio-8091-exec-17] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:57.821 [http-nio-8091-exec-17] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:13:57.865 [http-nio-8091-exec-17] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:57.865 [http-nio-8091-exec-17] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 null
25-06-11.17:13:57.914 [http-nio-8091-exec-17] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:58.024 [http-nio-8091-exec-33] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:58.024 [http-nio-8091-exec-33] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:58.024 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:58.024 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:58.024 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:58.102 [http-nio-8091-exec-33] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:58.190 [http-nio-8091-exec-33] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 102
25-06-11.17:13:58.190 [http-nio-8091-exec-33] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 102 rule_default
25-06-11.17:13:58.190 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:58.190 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:58.190 [http-nio-8091-exec-33] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 102]
25-06-11.17:13:58.194 [http-nio-8091-exec-29] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:58.232 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:58.232 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:58.232 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:58.232 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:58.232 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:58.232 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:58.232 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:58.232 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:58.232 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:58.232 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:58.341 [http-nio-8091-exec-33] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:58.421 [http-nio-8091-exec-33] WARN  RuleStockLogicTreeNode - 规则过滤-库存扣减-告警，库存不足。userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102
25-06-11.17:13:58.421 [http-nio-8091-exec-33] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
25-06-11.17:13:58.421 [http-nio-8091-exec-33] INFO  RuleLuckAwardLogicTreeNode - 规则过滤-兜底奖品 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:102 ruleValue:101:1,100
25-06-11.17:13:58.468 [http-nio-8091-exec-33] INFO  RuleLuckAwardLogicTreeNode - 规则过滤-兜底奖品 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:101 awardRuleValue:1,100
25-06-11.17:13:58.468 [http-nio-8091-exec-33] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_luck_award code:0001
25-06-11.17:13:58.468 [http-nio-8091-exec-33] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 101 1,100
25-06-11.17:13:58.513 [http-nio-8091-exec-33] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:58.591 [http-nio-8091-exec-29] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:58.591 [http-nio-8091-exec-29] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:58.591 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:58.591 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:58.591 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:58.671 [http-nio-8091-exec-29] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:58.740 [http-nio-8091-exec-29] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 101
25-06-11.17:13:58.740 [http-nio-8091-exec-29] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 101 rule_default
25-06-11.17:13:58.740 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:58.740 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:58.740 [http-nio-8091-exec-29] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 101]
25-06-11.17:13:58.802 [http-nio-8091-exec-36] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:58.852 [http-nio-8091-exec-29] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:101
25-06-11.17:13:58.852 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:58.852 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:58.852 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:58.852 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:58.852 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:58.852 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:58.852 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:58.852 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:58.852 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:58.852 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:58.920 [http-nio-8091-exec-29] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:101
25-06-11.17:13:58.969 [http-nio-8091-exec-29] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:58.969 [http-nio-8091-exec-29] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 101 null
25-06-11.17:13:59.018 [http-nio-8091-exec-29] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:59.171 [http-nio-8091-exec-36] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:59.171 [http-nio-8091-exec-36] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:59.172 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:59.172 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:59.172 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:59.251 [http-nio-8091-exec-36] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:59.324 [http-nio-8091-exec-36] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 106
25-06-11.17:13:59.324 [http-nio-8091-exec-36] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 rule_default
25-06-11.17:13:59.324 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:59.324 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:59.324 [http-nio-8091-exec-36] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 106]
25-06-11.17:13:59.392 [http-nio-8091-exec-27] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:13:59.422 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:13:59.422 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:13:59.422 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:59.422 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:59.422 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:59.422 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:59.422 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:59.422 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:59.422 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:59.422 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:13:59.441 [http-nio-8091-exec-36] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:59.526 [http-nio-8091-exec-36] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:106
25-06-11.17:13:59.569 [http-nio-8091-exec-36] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:13:59.569 [http-nio-8091-exec-36] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 106 null
25-06-11.17:13:59.617 [http-nio-8091-exec-36] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:13:59.763 [http-nio-8091-exec-27] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:13:59.763 [http-nio-8091-exec-27] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:59.764 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:13:59.764 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:59.764 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:13:59.842 [http-nio-8091-exec-27] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:13:59.929 [http-nio-8091-exec-27] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 103
25-06-11.17:13:59.929 [http-nio-8091-exec-27] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 103 rule_default
25-06-11.17:13:59.929 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:13:59.929 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:13:59.929 [http-nio-8091-exec-27] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 103]
25-06-11.17:13:59.992 [http-nio-8091-exec-35] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:14:00.035 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:14:00.035 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:14:00.035 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:14:00.035 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:14:00.035 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:14:00.035 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:14:00.035 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:14:00.035 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:14:00.035 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:14:00.035 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:14:00.048 [http-nio-8091-exec-27] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:103
25-06-11.17:14:00.149 [http-nio-8091-exec-27] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:103
25-06-11.17:14:00.189 [http-nio-8091-exec-27] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:14:00.189 [http-nio-8091-exec-27] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 103 null
25-06-11.17:14:00.252 [http-nio-8091-exec-27] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:14:00.403 [http-nio-8091-exec-35] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:14:00.403 [http-nio-8091-exec-35] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:14:00.403 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:14:00.403 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:14:00.403 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:14:00.481 [http-nio-8091-exec-35] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:14:00.563 [http-nio-8091-exec-35] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 108
25-06-11.17:14:00.563 [http-nio-8091-exec-35] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 108 rule_default
25-06-11.17:14:00.564 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:14:00.564 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:14:00.564 [http-nio-8091-exec-35] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 108]
25-06-11.17:14:00.592 [http-nio-8091-exec-30] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:14:00.622 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:14:00.622 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:14:00.622 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:14:00.622 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:14:00.622 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:14:00.622 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:14:00.622 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:14:00.622 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:14:00.622 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:14:00.622 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:14:00.670 [http-nio-8091-exec-35] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:108
25-06-11.17:14:00.741 [http-nio-8091-exec-35] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:108
25-06-11.17:14:00.806 [http-nio-8091-exec-35] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:14:00.806 [http-nio-8091-exec-35] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 108 null
25-06-11.17:14:00.853 [http-nio-8091-exec-35] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:14:00.962 [http-nio-8091-exec-30] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:14:00.962 [http-nio-8091-exec-30] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:14:00.962 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:14:00.962 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:14:00.962 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:14:01.040 [http-nio-8091-exec-30] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:14:01.123 [http-nio-8091-exec-30] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 105
25-06-11.17:14:01.123 [http-nio-8091-exec-30] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 rule_default
25-06-11.17:14:01.123 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:14:01.123 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:14:01.123 [http-nio-8091-exec-30] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 105]
25-06-11.17:14:01.193 [http-nio-8091-exec-39] INFO  RaffleActivityController - 活动抽奖 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
25-06-11.17:14:01.240 [http-nio-8091-exec-30] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:14:01.242 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Logic SQL: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update
25-06-11.17:14:01.242 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.predicate.LockSegment@fde5f1a], window=Optional.empty)
25-06-11.17:14:01.242 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:14:01.242 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:14:01.242 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:14:01.242 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db01 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:14:01.242 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_000
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:14:01.242 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_001
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:14:01.242 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_002
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:14:01.242 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db02 ::: select id,user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state
        from user_raffle_order_003
        where user_id = ? and activity_id = ? and order_state = 'create'
        for update ::: [ohGUf67Vme6-oFdR7b1Ml8mw34_s, 100401]
25-06-11.17:14:01.320 [http-nio-8091-exec-30] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:105
25-06-11.17:14:01.361 [http-nio-8091-exec-30] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:14:01.361 [http-nio-8091-exec-30] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 105 null
25-06-11.17:14:01.413 [http-nio-8091-exec-30] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:14:01.566 [http-nio-8091-exec-39] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401 orderId:344375639255
25-06-11.17:14:01.566 [http-nio-8091-exec-39] INFO  BackListLogicChain     - 抽奖责任链-黑名单开始 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:14:01.566 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Logic SQL: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=?
25-06-11.17:14:01.566 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:14:01.566 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select rule_value
        from strategy_rule
        where strategy_id = ? and rule_model=? ::: [100006, rule_blacklist]
25-06-11.17:14:01.650 [http-nio-8091-exec-39] INFO  BackListLogicChain     - 抽奖责任链-黑名单放行 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 ruleModel:rule_blacklist
25-06-11.17:14:01.722 [http-nio-8091-exec-39] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId: 100006 ruleModel: rule_default awardId: 101
25-06-11.17:14:01.722 [http-nio-8091-exec-39] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 101 rule_default
25-06-11.17:14:01.722 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Logic SQL: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=?
25-06-11.17:14:01.722 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(table=Optional.empty, limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
25-06-11.17:14:01.722 [http-nio-8091-exec-39] INFO  ShardingSphere-SQL     - Actual SQL: db00 ::: select  rule_models
        from strategy_award
        where strategy_id = ? and  award_id=? ::: [100006, 101]
25-06-11.17:14:01.841 [http-nio-8091-exec-39] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:101
25-06-11.17:14:01.930 [http-nio-8091-exec-39] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s strategyId:100006 awardId:101
25-06-11.17:14:01.970 [http-nio-8091-exec-39] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0000
25-06-11.17:14:01.970 [http-nio-8091-exec-39] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 ohGUf67Vme6-oFdR7b1Ml8mw34_s 100006 101 null
25-06-11.17:14:02.012 [http-nio-8091-exec-39] ERROR RaffleActivityController - 活动抽奖失败 userId:ohGUf67Vme6-oFdR7b1Ml8mw34_s activityId:100401
org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:440)
	at com.sun.proxy.$Proxy313.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:287)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:65)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:96)
	at com.sun.proxy.$Proxy321.updateUserRaffleOrderStateUsed(Unknown Source)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:90)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$7d273726.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$44dfe7f5.saveUserAwardRecord(<generated>)
	at cn.wenzhuo4657.BigMarket.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:55)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:151)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$FastClassBySpringCGLIB$$1b20b24c.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.wenzhuo4657.BigMarket.aop.RateLimiterAOP.doRouter(RateLimiterAOP.java:60)
	at sun.reflect.GeneratedMethodAccessor193.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.wenzhuo4657.BigMarket.trigger.http.RaffleActivityController$$EnhancerBySpringCGLIB$$84492539.draw(<generated>)
	at sun.reflect.GeneratedMethodAccessor192.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ibatis.executor.ExecutorException: Error preparing statement.  Cause: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:97)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.prepareStatement(MybatisSimpleExecutor.java:92)
	at com.baomidou.mybatisplus.core.executor.MybatisSimpleExecutor.doUpdate(MybatisSimpleExecutor.java:53)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at com.baomidou.mybatisplus.core.executor.MybatisCachingExecutor.update(MybatisCachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.GeneratedMethodAccessor225.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:426)
	... 93 common frames omitted
Caused by: com.google.common.util.concurrent.UncheckedExecutionException: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2087)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4019)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:4042)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:5024)
	at com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:5031)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserEngine.parse(SQLStatementParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.ShardingSphereSQLParserEngine.parse(ShardingSphereSQLParserEngine.java:58)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:180)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.<init>(ShardingSpherePreparedStatement.java:149)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.prepareStatement(ShardingSphereConnection.java:80)
	at sun.reflect.GeneratedMethodAccessor173.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy155.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:86)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	... 103 common frames omitted
Caused by: org.apache.shardingsphere.sql.parser.exception.SQLParsingException: You have an error in your SQL syntax
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.twoPhaseParse(SQLParserExecutor.java:65)
	at org.apache.shardingsphere.sql.parser.core.database.parser.SQLParserExecutor.parse(SQLParserExecutor.java:46)
	at org.apache.shardingsphere.sql.parser.api.SQLParserEngine.parse(SQLParserEngine.java:47)
	at org.apache.shardingsphere.infra.parser.sql.SQLStatementParserExecutor.parse(SQLStatementParserExecutor.java:48)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:41)
	at org.apache.shardingsphere.infra.parser.cache.SQLStatementCacheLoader.load(SQLStatementCacheLoader.java:30)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3576)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2318)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2191)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2081)
	... 119 common frames omitted
25-06-11.17:19:06.794 [Dubbo-framework-cache-refreshing-scheduler-thread-1] INFO  AbstractCacheManager$CacheRefreshTask -  [DUBBO] Dumping meta caches, latest entries 0, dubbo version: 3.2.5, current host: 192.168.43.185
25-06-11.17:19:07.182 [Dubbo-framework-cache-refreshing-scheduler-thread-1] INFO  AbstractCacheManager$CacheRefreshTask -  [DUBBO] Dumping mapping caches, latest entries 0, dubbo version: 3.2.5, current host: 192.168.43.185
